!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.vl={})}(this,function(e){"use strict";function t(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function n(e,t){return e(t={exports:{}},t.exports),t.exports}var r=function(e,t){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};var i=function(){return(i=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function a(e){var t="function"==typeof Symbol&&e[Symbol.iterator],n=0;return t?t.call(e):{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}}}function o(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,a=n.call(e),o=[];try{for(;(void 0===t||0<t--)&&!(r=a.next()).done;)o.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=a.return)&&n.call(a)}finally{if(i)throw i.error}}return o}function f(e){return this instanceof f?(this.v=e,this):new f(e)}var ae=Object.freeze({__extends:function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},get __assign(){return i},__rest:function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&(n[r[i]]=e[r[i]])}return n},__decorate:function(e,t,n,r){var i,a=arguments.length,o=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;0<=s;s--)(i=e[s])&&(o=(a<3?i(o):3<a?i(t,n,o):i(t,n))||o);return 3<a&&o&&Object.defineProperty(t,n,o),o},__param:function(n,r){return function(e,t){r(e,t,n)}},__metadata:function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__awaiter:function(a,o,s,l){return new(s||(s=Promise))(function(e,t){function n(e){try{i(l.next(e))}catch(e){t(e)}}function r(e){try{i(l.throw(e))}catch(e){t(e)}}function i(t){t.done?e(t.value):new s(function(e){e(t.value)}).then(n,r)}i((l=l.apply(a,o||[])).next())})},__generator:function(n,r){var i,a,o,e,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return e={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,a&&(o=2&t[0]?a.return:t[0]?a.throw||((o=a.return)&&o.call(a),0):a.next)&&!(o=o.call(a,t[1])).done)return o;switch(a=0,o&&(t=[2&t[0],o.value]),t[0]){case 0:case 1:o=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,a=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(o=0<(o=s.trys).length&&o[o.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!o||t[1]>o[0]&&t[1]<o[3])){s.label=t[1];break}if(6===t[0]&&s.label<o[1]){s.label=o[1],o=t;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(t);break}o[2]&&s.ops.pop(),s.trys.pop();continue}t=r.call(n,s)}catch(e){t=[6,e],a=0}finally{i=o=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},__exportStar:function(e,t){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])},__values:a,__read:o,__spread:function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(o(arguments[t]));return e},__await:f,__asyncGenerator:function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i,a=n.apply(e,t||[]),o=[];return i={},r("next"),r("throw"),r("return"),i[Symbol.asyncIterator]=function(){return this},i;function r(r){a[r]&&(i[r]=function(n){return new Promise(function(e,t){1<o.push([r,n,e,t])||s(r,n)})})}function s(e,t){try{(n=a[e](t)).value instanceof f?Promise.resolve(n.value.v).then(l,u):c(o[0][2],n)}catch(e){c(o[0][3],e)}var n}function l(e){s("next",e)}function u(e){s("throw",e)}function c(e,t){e(t),o.shift(),o.length&&s(o[0][0],o[0][1])}},__asyncDelegator:function(r){var e,i;return e={},t("next"),t("throw",function(e){throw e}),t("return"),e[Symbol.iterator]=function(){return this},e;function t(t,n){e[t]=r[t]?function(e){return(i=!i)?{value:f(r[t](e)),done:"return"===t}:n?n(e):e}:n}},__asyncValues:function(l){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,t=l[Symbol.asyncIterator];return t?t.call(l):(l=a(l),e={},n("next"),n("throw"),n("return"),e[Symbol.asyncIterator]=function(){return this},e);function n(s){e[s]=l[s]&&function(o){return new Promise(function(e,t){var n,r,i,a;o=l[s](o),n=e,r=t,i=o.done,a=o.value,Promise.resolve(a).then(function(e){n({value:e,done:i})},r)})}}},__makeTemplateObject:function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},__importStar:function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},__importDefault:function(e){return e&&e.__esModule?e:{default:e}}});function h(e,t,n){return e.fields=t||[],e.fname=n,e}function v(e){return null==e?null:e.fields}function g(e){throw Error(e)}function y(e){var t,n,r,i=[],a=null,o=0,s=e.length,l="";function u(){i.push(l+e.substring(t,n)),l="",t=n+1}for(e+="",t=n=0;n<s;++n)if("\\"===(r=e[n]))l+=e.substring(t,n),t=++n;else if(r===a)u(),a=null,o=-1;else{if(a)continue;t===o&&'"'===r?(t=n+1,a=r):t===o&&"'"===r?(t=n+1,a=r):"."!==r||o?"["===r?(t<n&&u(),o=t=n+1):"]"===r&&(o||g("Access path missing open bracket: "+e),0<o&&u(),o=0,t=n+1):t<n?u():t=n+1}return o&&g("Access path missing closing bracket: "+e),a&&g("Access path missing closing quote: "+e),t<n&&(n++,u()),i}var s=Array.isArray;function l(e){return e===Object(e)}function m(e){return"string"==typeof e}function _(e){return s(e)?"["+e.map(_)+"]":l(e)||m(e)?JSON.stringify(e).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):e}function u(e,t){var n=y(e),r="return _["+n.map(_).join("][")+"];";return h(Function("_",r),[e=1===n.length?n[0]:e],t||e)}var c=[],d=u("id"),p=h(function(e){return e},c,"identity"),S=h(function(){return 0},c,"zero"),b=h(function(){return 1},c,"one"),E=h(function(){return!0},c,"true"),N=h(function(){return!1},c,"false");function O(e,t,n){var r=[t].concat([].slice.call(n));console[e].apply(console,r)}function T(e){return e[e.length-1]}function x(e){return null==e||""===e?null:+e}function A(t){return function(e){return t*Math.exp(e)}}function C(t){return function(e){return Math.log(t*e)}}function D(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function k(e,t,n,r){var i=n(e[0]),a=n(T(e)),o=(a-i)*t;return[r(i-o),r(a-o)]}function P(e,t,n,r,i){var a=r(e[0]),o=r(T(e)),s=null!=t?r(t):(a+o)/2;return[i(s+(a-s)*n),i(s+(o-s)*n)]}function w(e){return null!=e?s(e)?e:[e]:[]}function F(e){return"function"==typeof e}var R={};function I(e){return"[object Date]"===Object.prototype.toString.call(e)}function L(e){return"number"==typeof e}function M(e,t){for(var n="";0<=--t;)n+=e;return n}function U(e){return L(e)?e:I(e)?e:Date.parse(e)}function j(e){for(var t={},n=0,r=e.length;n<r;++n)t[e[n]]=!0;return t}var z,B,H,G,oe=Object.freeze({accessor:h,accessorName:function(e){return null==e?null:e.fname},accessorFields:v,id:d,identity:p,zero:S,one:b,truthy:E,falsy:N,logger:function(e){var t=e||0;return{level:function(e){return arguments.length?(t=+e,this):t},error:function(){return 1<=t&&O("error","ERROR",arguments),this},warn:function(){return 2<=t&&O("warn","WARN",arguments),this},info:function(){return 3<=t&&O("log","INFO",arguments),this},debug:function(){return 4<=t&&O("log","DEBUG",arguments),this}}},None:0,Error:1,Warn:2,Info:3,Debug:4,panLinear:function(e,t){return k(e,t,x,p)},panLog:function(e,t){var n=Math.sign(e[0]);return k(e,t,C(n),A(n))},panPow:function(e,t,n){return k(e,t,D(n),D(1/n))},zoomLinear:function(e,t,n){return P(e,t,n,x,p)},zoomLog:function(e,t,n){var r=Math.sign(e[0]);return P(e,t,n,C(r),A(r))},zoomPow:function(e,t,n,r){return P(e,t,n,D(r),D(1/r))},array:w,compare:function(e,t){var n,r,i,a,o,s,l,u,c,f=[],d=(e=w(e)).map(function(e,t){return null==e?null:(f.push(t),F(e)?e:y(e).map(_).join("]["))}),p=f.length-1,g=w(t),m="var u,v;return ";if(p<0)return null;for(r=0;r<=p;++r)F(i=d[n=f[r]])?(a="(u=this."+(s="f"+n)+"(a))",o="(v=this."+s+"(b))",(l=l||{})[s]=i):(a="(u=a["+i+"])",o="(v=b["+i+"])"),s="((v=v instanceof Date?+v:v),(u=u instanceof Date?+u:u))","descending"!==g[n]?u=-(c=1):(c=-1,u=1),m+="("+a+"<"+o+"||u==null)&&v!=null?"+u+":(u>v||v==null)&&u!=null?"+c+":"+s+"!==u&&v===v?"+u+":v!==v&&u===u?"+c+(n<p?":":":0");return i=Function("a","b",m+";"),l&&(i=i.bind(l)),e=e.reduce(function(t,e){return F(e)?(v(e)||[]).forEach(function(e){t[e]=1}):null!=e&&(t[e+""]=1),t},{}),h(i,Object.keys(e))},constant:function(e){return F(e)?e:function(){return e}},debounce:function(t,e){var n,r;function i(){e(r),n=r=null}return function(e){r=e,n&&clearTimeout(n),n=setTimeout(i,t)}},error:g,extend:function(e){for(var t,n,r=1,i=arguments.length;r<i;++r)for(n in t=arguments[r])e[n]=t[n];return e},extentIndex:function(e,t){var n,r,i,a,o,s=-1,l=e.length;if(null==t){for(;++s<l;)if(null!=(r=e[s])&&r<=r){n=i=r;break}for(a=o=s;++s<l;)null!=(r=e[s])&&(r<n&&(n=r,a=s),i<r&&(i=r,o=s))}else{for(;++s<l;)if(null!=(r=t(e[s],s,e))&&r<=r){n=i=r;break}for(a=o=s;++s<l;)null!=(r=t(e[s],s,e))&&(r<n&&(n=r,a=s),i<r&&(i=r,o=s))}return[a,o]},fastmap:function(t){var i,a,o={};function n(e){return o.hasOwnProperty(e)&&o[e]!==R}return i={size:0,empty:0,object:o,has:n,get:function(e){return n(e)?o[e]:void 0},set:function(e,t){return n(e)||(++i.size,o[e]===R&&--i.empty),o[e]=t,this},delete:function(e){return n(e)&&(--i.size,++i.empty,o[e]=R),this},clear:function(){i.size=i.empty=0,i.object=o={}},test:function(e){return arguments.length?(a=e,i):a},clean:function(){var e,t,n={},r=0;for(e in o)(t=o[e])===R||a&&a(t)||(n[e]=t,++r);i.size=r,i.empty=0,i.object=o=n}},t&&Object.keys(t).forEach(function(e){i.set(e,t[e])}),i},field:u,inherits:function(e,t){var n=e.prototype=Object.create(t.prototype);return n.constructor=e,n},isArray:s,isBoolean:function(e){return"boolean"==typeof e},isDate:I,isFunction:F,isNumber:L,isObject:l,isRegExp:function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},isString:m,key:function(e,t){return e&&(e=t?w(e).map(function(e){return e.replace(/\\(.)/g,"$1")}):w(e)),h(e&&e.length?Function("_","return ''+"+e.map(function(e){return"_["+(t?_(e):y(e).map(_).join("]["))+"]"}).join("+'|'+")+";"):function(){return""},e,"key")},merge:function(e,t,n,r){var i=t.length,a=n.length;if(!a)return t;if(!i)return n;for(var o=r||new t.constructor(i+a),s=0,l=0,u=0;s<i&&l<a;++u)o[u]=0<e(t[s],n[l])?n[l++]:t[s++];for(;s<i;++s,++u)o[u]=t[s];for(;l<a;++l,++u)o[u]=n[l];return o},pad:function(e,t,n,r){var i=n||" ",a=e+"",o=t-a.length;return o<=0?a:"left"===r?M(i,o)+a:"center"===r?M(i,~~(o/2))+a+M(i,Math.ceil(o/2)):a+M(i,o)},peek:T,repeat:M,splitAccessPath:y,stringValue:_,toBoolean:function(e){return null==e||""===e?null:!(!e||"false"===e||"0"===e||!e)},toDate:function(e,t){return t=t||U,null==e||""===e?null:t(e)},toNumber:x,toString:function(e){return null==e||""===e?null:e+""},toSet:j,truncate:function(e,t,n,r){var i=null!=r?r:"…",a=e+"",o=a.length,s=Math.max(0,t-i.length);return o<=t?a:"left"===n?i+a.slice(o-s):"center"===n?a.slice(0,Math.ceil(s/2))+i+a.slice(o-~~(s/2)):a.slice(0,s)+i},visitArray:function(e,t,n){if(e){var r,i=0,a=e.length;if(t)for(;i<a;++i)(r=t(e[i]))&&n(r,i,e);else e.forEach(n)}}}),q={'"':'"',"\\":"\\","/":"/",b:"\b",f:"\f",n:"\n",r:"\r",t:"\t"},W=function(e){throw{name:"SyntaxError",message:e,at:z,text:H}},Y=function(e){return e&&e!==B&&W("Expected '"+e+"' instead of '"+B+"'"),B=H.charAt(z),z+=1,B},V=function(){var e,t="";for("-"===B&&Y(t="-");"0"<=B&&B<="9";)t+=B,Y();if("."===B)for(t+=".";Y()&&"0"<=B&&B<="9";)t+=B;if("e"===B||"E"===B)for(t+=B,Y(),"-"!==B&&"+"!==B||(t+=B,Y());"0"<=B&&B<="9";)t+=B,Y();if(e=+t,isFinite(e))return e;W("Bad number")},X=function(){var e,t,n,r="";if('"'===B)for(;Y();){if('"'===B)return Y(),r;if("\\"===B)if(Y(),"u"===B){for(t=n=0;t<4&&(e=parseInt(Y(),16),isFinite(e));t+=1)n=16*n+e;r+=String.fromCharCode(n)}else{if("string"!=typeof q[B])break;r+=q[B]}else r+=B}W("Bad string")},K=function(){for(;B&&B<=" ";)Y()};G=function(){switch(K(),B){case"{":return function(){var e,t={};if("{"===B){if(Y("{"),K(),"}"===B)return Y("}"),t;for(;B;){if(e=X(),K(),Y(":"),Object.hasOwnProperty.call(t,e)&&W('Duplicate key "'+e+'"'),t[e]=G(),K(),"}"===B)return Y("}"),t;Y(","),K()}}W("Bad object")}();case"[":return function(){var e=[];if("["===B){if(Y("["),K(),"]"===B)return Y("]"),e;for(;B;){if(e.push(G()),K(),"]"===B)return Y("]"),e;Y(","),K()}}W("Bad array")}();case'"':return X();case"-":return V();default:return"0"<=B&&B<="9"?V():function(){switch(B){case"t":return Y("t"),Y("r"),Y("u"),Y("e"),!0;case"f":return Y("f"),Y("a"),Y("l"),Y("s"),Y("e"),!1;case"n":return Y("n"),Y("u"),Y("l"),Y("l"),null}W("Unexpected '"+B+"'")}()}};var Q,J,Z,$=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,ee={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function te(e){return $.lastIndex=0,$.test(e)?'"'+e.replace($,function(e){var t=ee[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}var ne="undefined"!=typeof JSON?JSON:{parse:function(e,o){var t;return H=e,z=0,B=" ",t=G(),K(),B&&W("Syntax error"),"function"==typeof o?function e(t,n){var r,i,a=t[n];if(a&&"object"==typeof a)for(r in a)Object.prototype.hasOwnProperty.call(a,r)&&(void 0!==(i=e(a,r))?a[r]=i:delete a[r]);return o.call(t,n,a)}({"":t},""):t},stringify:function(e,t,n){var r;if(J=Q="","number"==typeof n)for(r=0;r<n;r+=1)J+=" ";else"string"==typeof n&&(J=n);if((Z=t)&&"function"!=typeof t&&("object"!=typeof t||"number"!=typeof t.length))throw new Error("JSON.stringify");return function e(t,n){var r,i,a,o,s,l=Q,u=n[t];switch(u&&"object"==typeof u&&"function"==typeof u.toJSON&&(u=u.toJSON(t)),"function"==typeof Z&&(u=Z.call(n,t,u)),typeof u){case"string":return te(u);case"number":return isFinite(u)?String(u):"null";case"boolean":case"null":return String(u);case"object":if(!u)return"null";if(Q+=J,s=[],"[object Array]"===Object.prototype.toString.apply(u)){for(o=u.length,r=0;r<o;r+=1)s[r]=e(r,u)||"null";return a=0===s.length?"[]":Q?"[\n"+Q+s.join(",\n"+Q)+"\n"+l+"]":"["+s.join(",")+"]",Q=l,a}if(Z&&"object"==typeof Z)for(o=Z.length,r=0;r<o;r+=1)"string"==typeof(i=Z[r])&&(a=e(i,u))&&s.push(te(i)+(Q?": ":":")+a);else for(i in u)Object.prototype.hasOwnProperty.call(u,i)&&(a=e(i,u))&&s.push(te(i)+(Q?": ":":")+a);return a=0===s.length?"{}":Q?"{\n"+Q+s.join(",\n"+Q)+"\n"+l+"}":"{"+s.join(",")+"}",Q=l,a}}("",{"":e})}},re=function(e,t){t||(t={}),"function"==typeof t&&(t={cmp:t});var p=t.space||"";"number"==typeof p&&(p=Array(p+1).join(" "));var a,g="boolean"==typeof t.cycles&&t.cycles,m=t.replacer||function(e,t){return t},h=t.cmp&&(a=t.cmp,function(i){return function(e,t){var n={key:e,value:i[e]},r={key:t,value:i[t]};return a(n,r)}}),v=[];return function e(t,n,r,i){var a=p?"\n"+new Array(i+1).join(p):"",o=p?": ":":";if(r&&r.toJSON&&"function"==typeof r.toJSON&&(r=r.toJSON()),void 0!==(r=m.call(t,n,r))){if("object"!=typeof r||null===r)return ne.stringify(r);if(ie(r)){for(var s=[],l=0;l<r.length;l++){var u=e(r,l,r[l],i+1)||ne.stringify(null);s.push(a+p+u)}return"["+s.join(",")+a+"]"}if(-1!==v.indexOf(r)){if(g)return ne.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON")}v.push(r);var c=se(r).sort(h&&h(r));for(s=[],l=0;l<c.length;l++){var f=e(r,n=c[l],r[n],i+1);if(f){var d=ne.stringify(n)+o+f;s.push(a+p+d)}}return v.splice(v.indexOf(r),1),"{"+s.join(",")+a+"}"}}({"":e},"",e,0)},ie=Array.isArray||function(e){return"[object Array]"==={}.toString.call(e)},se=Object.keys||function(e){var t=Object.prototype.hasOwnProperty||function(){return!0},n=[];for(var r in e)t.call(e,r)&&n.push(r);return n},le=n(function(e,t){function s(e){return!!e.or}function l(e){return!!e.and}function u(e){return!!e.not}Object.defineProperty(t,"__esModule",{value:!0}),t.isLogicalOr=s,t.isLogicalAnd=l,t.isLogicalNot=u,t.forEachLeaf=function e(t,n){if(u(t))e(t.not,n);else if(l(t))for(var r=0,i=t.and;r<i.length;r++)e(i[r],n);else if(s(t))for(var a=0,o=t.or;a<o.length;a++)e(o[a],n);else n(t)},t.normalizeLogicalOperand=function t(e,n){return u(e)?{not:t(e.not,n)}:l(e)?{and:e.and.map(function(e){return t(e,n)})}:s(e)?{or:e.or.map(function(e){return t(e,n)})}:n(e)}});t(le);le.isLogicalOr,le.isLogicalAnd,le.isLogicalNot,le.forEachLeaf,le.normalizeLogicalOperand;var ue=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=ae.__importDefault(re);function n(e,t){return-1<e.indexOf(t)}function r(e,t){return e.filter(function(e){return!n(t,e)})}function a(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=0,i=t;r<i.length;r++){e=o(e,i[r])}return e}function o(e,t){if("object"!=typeof t||null===t)return e;for(var n in t)t.hasOwnProperty(n)&&void 0!==t[n]&&("object"!=typeof t[n]||oe.isArray(t[n])||null===t[n]?e[n]=t[n]:"object"!=typeof e[n]||null===e[n]?e[n]=a(oe.isArray(t[n].constructor)?[]:{},t[n]):a(e[n],t[n]));return e}t.pick=function(e,t){for(var n={},r=0,i=t;r<i.length;r++){var a=i[r];e.hasOwnProperty(a)&&(n[a]=e[a])}return n},t.omit=function(e,t){for(var n=ae.__assign({},e),r=0,i=t;r<i.length;r++)delete n[i[r]];return n},t.stringify=i.default,t.hash=function(e){if(oe.isNumber(e))return e;var t=oe.isString(e)?e:i.default(e);if(t.length<100)return t;for(var n=0,r=0;r<t.length;r++)n=(n<<5)-n+t.charCodeAt(r),n&=n;return n},t.contains=n,t.without=r,t.union=function(e,t){return e.concat(r(t,e))},t.some=function(e,t){for(var n=0,r=0;r<e.length;r++)if(t(e[r],r,n++))return!0;return!1},t.every=function(e,t){for(var n=0,r=0;r<e.length;r++)if(!t(e[r],r,n++))return!1;return!0},t.flatten=function(e){return[].concat.apply([],e)},t.mergeDeep=a,t.unique=function(e,t){for(var n,r=[],i={},a=0,o=e;a<o.length;a++){var s=o[a];(n=t(s))in i||(i[n]=1,r.push(s))}return r},t.differ=function(e,t){for(var n in e)if(e.hasOwnProperty(n)&&t[n]&&e[n]&&t[n]!==e[n])return!0;return!1},t.hasIntersection=function(e,t){for(var n in e)if(n in t)return!0;return!1},t.isNumeric=function(e){return!isNaN(e)},t.differArray=function(e,t){if(e.length!==t.length)return!0;e.sort(),t.sort();for(var n=0;n<e.length;n++)if(t[n]!==e[n])return!0;return!1},t.keys=Object.keys,t.vals=function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(e[n]);return t},t.flagKeys=function(e){return t.keys(e)},t.duplicate=function(e){return JSON.parse(JSON.stringify(e))},t.isBoolean=function(e){return!0===e||!1===e},t.varName=function(e){var t=e.replace(/\W/g,"_");return(e.match(/^\d+/)?"_":"")+t},t.logicalExpr=function t(e,n){return le.isLogicalNot(e)?"!("+t(e.not,n)+")":le.isLogicalAnd(e)?"("+e.and.map(function(e){return t(e,n)}).join(") && (")+")":le.isLogicalOr(e)?"("+e.or.map(function(e){return t(e,n)}).join(") || (")+")":n(e)},t.deleteNestedProperty=function e(t,n){if(0===n.length)return!0;var r=n.shift();return e(t[r],n)&&delete t[r],0===Object.keys(t).length},t.titlecase=function(e){return e.charAt(0).toUpperCase()+e.substr(1)},t.accessPathWithDatum=function(e,t){void 0===t&&(t="datum");for(var n=oe.splitAccessPath(e),r=[],i=1;i<=n.length;i++){var a="["+n.slice(0,i).map(oe.stringValue).join("][")+"]";r.push(""+t+a)}return r.join(" && ")},t.flatAccessWithDatum=function(e,t){return void 0===t&&(t="datum"),t+"["+oe.stringValue(oe.splitAccessPath(e).join("."))+"]"},t.replacePathInField=function(e){return""+oe.splitAccessPath(e).map(function(e){return e.replace(".","\\.")}).join("\\.")},t.removePathFromField=function(e){return""+oe.splitAccessPath(e).join(".")},t.accessPathDepth=function(e){return e?oe.splitAccessPath(e).length:0},t.getFirstDefined=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=0,r=e;n<r.length;n++){var i=r[n];if(void 0!==i)return i}}});t(ue);ue.pick,ue.omit,ue.stringify,ue.hash,ue.contains,ue.without,ue.union,ue.some,ue.every,ue.flatten,ue.mergeDeep,ue.unique,ue.differ,ue.hasIntersection,ue.isNumeric,ue.differArray,ue.keys,ue.vals,ue.flagKeys,ue.duplicate,ue.isBoolean,ue.varName,ue.logicalExpr,ue.deleteNestedProperty,ue.titlecase,ue.accessPathWithDatum,ue.flatAccessWithDatum,ue.replacePathInField,ue.removePathFromField,ue.accessPathDepth,ue.getFirstDefined;var ce=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n={argmax:1,argmin:1,average:1,count:1,distinct:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1};t.AGGREGATE_OPS=ue.flagKeys(n),t.isAggregateOp=function(e){return!!n[e]},t.COUNTING_OPS=["count","valid","missing","distinct"],t.isCountingAggregateOp=function(e){return e&&ue.contains(t.COUNTING_OPS,e)},t.SUM_OPS=["count","sum","distinct","valid","missing"],t.SHARED_DOMAIN_OPS=["mean","average","median","q1","q3","min","max"],t.SHARED_DOMAIN_OP_INDEX=oe.toSet(t.SHARED_DOMAIN_OPS)});t(ce);ce.AGGREGATE_OPS,ce.isAggregateOp,ce.COUNTING_OPS,ce.isCountingAggregateOp,ce.SUM_OPS,ce.SHARED_DOMAIN_OPS,ce.SHARED_DOMAIN_OP_INDEX;var fe=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.AXIS_PARTS=["domain","grid","labels","ticks","title"],t.AXIS_PROPERTY_TYPE={grid:"grid",gridColor:"grid",gridDash:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"main",domain:"main",domainColor:"main",domainOpacity:"main",domainWidth:"main",format:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontWeight:"main",labelLimit:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",maxExtent:"main",minExtent:"main",offset:"main",position:"main",tickColor:"main",tickExtra:"main",tickOffset:"main",tickOpacity:"main",tickRound:"main",ticks:"main",tickSize:"main",title:"main",titleAlign:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontWeight:"main",titleLimit:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",tickWidth:"both",tickCount:"both",values:"both",scale:"both",zindex:"both"};var n={orient:1,bandPosition:1,domain:1,domainColor:1,domainOpacity:1,domainWidth:1,format:1,grid:1,gridColor:1,gridDash:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontWeight:1,labelLimit:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,maxExtent:1,minExtent:1,offset:1,position:1,tickColor:1,tickCount:1,tickExtra:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontWeight:1,titleLimit:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,values:1,zindex:1},r=ae.__assign({},n,{encoding:1,labelAngle:1,tickStep:1}),i=ae.__assign({gridScale:1,scale:1},n,{encode:1});t.isAxisProperty=function(e){return!!r[e]},t.VG_AXIS_PROPERTIES=ue.flagKeys(i),t.AXIS_PROPERTIES=ue.flagKeys(r)});t(fe);fe.AXIS_PARTS,fe.AXIS_PROPERTY_TYPE,fe.isAxisProperty,fe.VG_AXIS_PROPERTIES,fe.AXIS_PROPERTIES;var de=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n,r=oe.logger(oe.Warn),i=r,a=function(){function e(){this.warns=[],this.infos=[],this.debugs=[]}return e.prototype.level=function(){return this},e.prototype.warn=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return(e=this.warns).push.apply(e,t),this},e.prototype.info=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return(e=this.infos).push.apply(e,t),this},e.prototype.debug=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return(e=this.debugs).push.apply(e,t),this},e}();function o(){return i=r}t.LocalLogger=a,t.wrap=function(e){return function(){i=new a,e(i),o()}},t.set=function(e){return i=e},t.reset=o,t.warn=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];i.warn.apply(i,arguments)},t.info=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];i.info.apply(i,arguments)},t.debug=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];i.debug.apply(i,arguments)},(n=t.message||(t.message={})).INVALID_SPEC="Invalid spec",n.FIT_NON_SINGLE='Autosize "fit" only works for single views and layered views.',n.CANNOT_FIX_RANGE_STEP_WITH_FIT='Cannot use a fixed value of "rangeStep" when "autosize" is "fit".',n.cannotProjectOnChannelWithoutField=function(e){return'Cannot project a selection on encoding channel "'+e+'", which has no field.'},n.nearestNotSupportForContinuous=function(e){return'The "nearest" transform is not supported for '+e+" marks."},n.selectionNotSupported=function(e){return"Selection not supported for "+e+" yet"},n.selectionNotFound=function(e){return'Cannot find a selection named "'+e+'"'},n.SCALE_BINDINGS_CONTINUOUS="Scale bindings are currently only supported for scales with unbinned, continuous domains.",n.noSuchRepeatedValue=function(e){return'Unknown repeated value "'+e+'".'},n.CONCAT_CANNOT_SHARE_AXIS="Axes cannot be shared in concatenated views.",n.REPEAT_CANNOT_SHARE_AXIS="Axes cannot be shared in repeated views.",n.cannotSetTitleAnchor=function(e){return'Cannot set title "anchor" for a '+e+" spec"},n.unrecognizedParse=function(e){return'Unrecognized parse "'+e+'".'},n.differentParse=function(e,t,n){return'An ancestor parsed field "'+e+'" as '+n+" but a child wants to parse the field as "+t+"."},n.invalidTransformIgnored=function(e){return"Ignoring an invalid transform: "+ue.stringify(e)+"."},n.NO_FIELDS_NEEDS_AS='If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.',n.encodingOverridden=function(e){return"Layer's shared "+e.join(",")+" channel "+(1===e.length?"is":"are")+" overriden"},n.projectionOverridden=function(e){var t=e.parentProjection,n=e.projection;return"Layer's shared projection "+ue.stringify(t)+" is overridden by a child projection "+ue.stringify(n)+"."},n.primitiveChannelDef=function(e,t,n){return"Channel "+e+" is a "+t+". Converted to {value: "+ue.stringify(n)+"}."},n.invalidFieldType=function(e){return'Invalid field type "'+e+'"'},n.nonZeroScaleUsedWithLengthMark=function(e,t,n){return"A "+(n.scaleType?n.scaleType+" scale":n.zeroFalse?"scale with zero=false":"scale with custom domain that excludes zero")+" is used to encode "+e+"'s "+t+". This can be misleading as the "+("x"===t?"width":"height")+" of the "+e+" can be arbitrary based on the scale domain. You may want to use point mark instead."},n.invalidFieldTypeForCountAggregate=function(e,t){return'Invalid field type "'+e+'" for aggregate: "'+t+'", using "quantitative" instead.'},n.invalidAggregate=function(e){return'Invalid aggregation operator "'+e+'"'},n.emptyOrInvalidFieldType=function(e,t,n){return'Invalid field type "'+e+'" for channel "'+t+'", using "'+n+'" instead.'},n.droppingColor=function(e,t){var n=t.fill,r=t.stroke;return"Dropping color "+e+" as the plot also has "+(n&&r?"fill and stroke":n?"fill":"stroke")},n.emptyFieldDef=function(e,t){return"Dropping "+ue.stringify(e)+' from channel "'+t+'" since it does not contain data field or value.'},n.latLongDeprecated=function(e,t,n){return e+"-encoding with type "+t+" is deprecated. Replacing with "+n+"-encoding."},n.LINE_WITH_VARYING_SIZE="Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.",n.incompatibleChannel=function(e,t,n){return e+' dropped as it is incompatible with "'+t+'"'+(n?" when "+n:"")+"."},n.invalidEncodingChannel=function(e){return e+"-encoding is dropped as "+e+" is not a valid encoding channel."},n.facetChannelShouldBeDiscrete=function(e){return e+" encoding should be discrete (ordinal / nominal / binned)."},n.discreteChannelCannotEncode=function(e,t){return'Using discrete channel "'+e+'" to encode "'+t+'" field can be misleading as it does not encode '+("ordinal"===t?"order":"magnitude")+"."},n.BAR_WITH_POINT_SCALE_AND_RANGESTEP_NULL="Bar mark should not be used with point scale when rangeStep is null. Please use band scale instead.",n.lineWithRange=function(e,t){return"Line mark is for continuous lines and thus cannot be used with "+(e&&t?"x2 and y2":e?"x2":"y2")+". We will use the rule mark (line segments) instead."},n.orientOverridden=function(e,t){return'Specified orient "'+e+'" overridden with "'+t+'"'},n.CANNOT_UNION_CUSTOM_DOMAIN_WITH_FIELD_DOMAIN="custom domain scale cannot be unioned with default field-based domain",n.cannotUseScalePropertyWithNonColor=function(e){return'Cannot use the scale property "'+e+'" with non-color channel.'},n.unaggregateDomainHasNoEffectForRawField=function(e){return"Using unaggregated domain with raw field has no effect ("+ue.stringify(e)+")."},n.unaggregateDomainWithNonSharedDomainOp=function(e){return'Unaggregated domain not applicable for "'+e+'" since it produces values outside the origin domain of the source data.'},n.unaggregatedDomainWithLogScale=function(e){return"Unaggregated domain is currently unsupported for log scale ("+ue.stringify(e)+")."},n.cannotApplySizeToNonOrientedMark=function(e){return'Cannot apply size to non-oriented mark "'+e+'".'},n.rangeStepDropped=function(e){return'rangeStep for "'+e+'" is dropped as top-level '+("x"===e?"width":"height")+" is provided."},n.scaleTypeNotWorkWithChannel=function(e,t,n){return'Channel "'+e+'" does not work with "'+t+'" scale. We are using "'+n+'" scale instead.'},n.scaleTypeNotWorkWithFieldDef=function(e,t){return'FieldDef does not work with "'+e+'" scale. We are using "'+t+'" scale instead.'},n.scalePropertyNotWorkWithScaleType=function(e,t,n){return n+"-scale's \""+t+'" is dropped as it does not work with '+e+" scale."},n.scaleTypeNotWorkWithMark=function(e,t){return'Scale type "'+t+'" does not work with mark "'+e+'".'},n.mergeConflictingProperty=function(e,t,n,r){return"Conflicting "+t.toString()+' property "'+e.toString()+'" ('+ue.stringify(n)+" and "+ue.stringify(r)+").  Using "+ue.stringify(n)+"."},n.independentScaleMeansIndependentGuide=function(e){return'Setting the scale to be independent for "'+e+'" means we also have to set the guide (axis or legend) to be independent.'},n.domainSortDropped=function(e){return"Dropping sort property "+ue.stringify(e)+" as unioned domains only support boolean or op 'count'."},n.UNABLE_TO_MERGE_DOMAINS="Unable to merge domains",n.MORE_THAN_ONE_SORT="Domains that should be unioned has conflicting sort properties. Sort will be set to true.",n.INVALID_CHANNEL_FOR_AXIS="Invalid channel for axis.",n.cannotStackRangedMark=function(e){return'Cannot stack "'+e+'" if there is already "'+e+'2"'},n.cannotStackNonLinearScale=function(e){return"Cannot stack non-linear scale ("+e+")"},n.stackNonSummativeAggregate=function(e){return'Stacking is applied even though the aggregate function is non-summative ("'+e+'")'},n.invalidTimeUnit=function(e,t){return"Invalid "+e+": "+ue.stringify(t)},n.dayReplacedWithDate=function(e){return'Time unit "'+e+'" is not supported. We are replacing it with '+e.replace("day","date")+"."},n.droppedDay=function(e){return"Dropping day from datetime "+ue.stringify(e)+" as day cannot be combined with other units."},n.errorBarCenterAndExtentAreNotNeeded=function(e,t){return(t?"extent ":"")+(t&&e?"and ":"")+(e?"center ":"")+(t&&e?"are ":"is ")+"not needed when data are aggregated."},n.errorBarCenterIsUsedWithWrongExtent=function(e,t,n){return e+" is not usually used with "+t+" for "+n+"."},n.errorBarContinuousAxisHasCustomizedAggregate=function(e,t){return"Continuous axis should not have customized aggregation function "+e+"; "+t+" already agregates the axis."},n.errorBarCenterIsNotNeeded=function(e,t){return"Center is not needed to be specified in "+t+" when extent is "+e+"."},n.errorBand1DNotSupport=function(e){return"1D error band does not support "+e},n.channelRequiredForBinned=function(e){return"Channel "+e+' is required for "binned" bin'},n.domainRequiredForThresholdScale=function(e){return"Domain for "+e+" is required for threshold scale"}});t(de);de.LocalLogger,de.wrap,de.set,de.reset,de.warn,de.info,de.debug,de.message;var pe=n(function(e,u){Object.defineProperty(u,"__esModule",{value:!0});var c=ae.__importStar(de);u.isDateTime=function(e){return!(!e||!(e.year||e.quarter||e.month||e.date||e.day||e.hours||e.minutes||e.seconds||e.milliseconds))},u.MONTHS=["january","february","march","april","may","june","july","august","september","october","november","december"],u.SHORT_MONTHS=u.MONTHS.map(function(e){return e.substr(0,3)}),u.DAYS=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],u.SHORT_DAYS=u.DAYS.map(function(e){return e.substr(0,3)}),u.dateTimeExpr=function(e,t){void 0===t&&(t=!1);var n=[];if(t&&void 0!==e.day&&1<ue.keys(e).length&&(c.warn(c.message.droppedDay(e)),delete(e=ue.duplicate(e)).day),void 0!==e.year?n.push(e.year):void 0!==e.day?n.push(2006):n.push(0),void 0!==e.month){var r=t?function(e){if(oe.isNumber(e))return(e-1).toString();var t=e.toLowerCase(),n=u.MONTHS.indexOf(t);if(-1!==n)return n+"";var r=t.substr(0,3),i=u.SHORT_MONTHS.indexOf(r);if(-1!==i)return i+"";throw new Error(c.message.invalidTimeUnit("month",e))}(e.month):e.month;n.push(r)}else if(void 0!==e.quarter){var i=t?function(e){if(oe.isNumber(e))return 4<e&&c.warn(c.message.invalidTimeUnit("quarter",e)),(e-1).toString();throw new Error(c.message.invalidTimeUnit("quarter",e))}(e.quarter):e.quarter;n.push(i+"*3")}else n.push(0);if(void 0!==e.date)n.push(e.date);else if(void 0!==e.day){var a=t?function(e){if(oe.isNumber(e))return e%7+"";var t=e.toLowerCase(),n=u.DAYS.indexOf(t);if(-1!==n)return n+"";var r=t.substr(0,3),i=u.SHORT_DAYS.indexOf(r);if(-1!==i)return i+"";throw new Error(c.message.invalidTimeUnit("day",e))}(e.day):e.day;n.push(a+"+1")}else n.push(1);for(var o=0,s=["hours","minutes","seconds","milliseconds"];o<s.length;o++){var l=s[o];void 0!==e[l]?n.push(e[l]):n.push(0)}return e.utc?"utc("+n.join(", ")+")":"datetime("+n.join(", ")+")"}});t(pe);pe.isDateTime,pe.MONTHS,pe.SHORT_MONTHS,pe.DAYS,pe.SHORT_DAYS,pe.dateTimeExpr;var ge=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.isFacetFieldDef=function(e){return!!e&&!!e.header}});t(ge);ge.isFacetFieldDef;var me=n(function(e,f){Object.defineProperty(f,"__esModule",{value:!0});var d,t,n=ae.__importStar(de);(t=d=f.TimeUnit||(f.TimeUnit={})).YEAR="year",t.MONTH="month",t.DAY="day",t.DATE="date",t.HOURS="hours",t.MINUTES="minutes",t.SECONDS="seconds",t.MILLISECONDS="milliseconds",t.YEARMONTH="yearmonth",t.YEARMONTHDATE="yearmonthdate",t.YEARMONTHDATEHOURS="yearmonthdatehours",t.YEARMONTHDATEHOURSMINUTES="yearmonthdatehoursminutes",t.YEARMONTHDATEHOURSMINUTESSECONDS="yearmonthdatehoursminutesseconds",t.MONTHDATE="monthdate",t.HOURSMINUTES="hoursminutes",t.HOURSMINUTESSECONDS="hoursminutesseconds",t.MINUTESSECONDS="minutesseconds",t.SECONDSMILLISECONDS="secondsmilliseconds",t.QUARTER="quarter",t.YEARQUARTER="yearquarter",t.QUARTERMONTH="quartermonth",t.YEARQUARTERMONTH="yearquartermonth",t.UTCYEAR="utcyear",t.UTCMONTH="utcmonth",t.UTCDAY="utcday",t.UTCDATE="utcdate",t.UTCHOURS="utchours",t.UTCMINUTES="utcminutes",t.UTCSECONDS="utcseconds",t.UTCMILLISECONDS="utcmilliseconds",t.UTCYEARMONTH="utcyearmonth",t.UTCYEARMONTHDATE="utcyearmonthdate",t.UTCYEARMONTHDATEHOURS="utcyearmonthdatehours",t.UTCYEARMONTHDATEHOURSMINUTES="utcyearmonthdatehoursminutes",t.UTCYEARMONTHDATEHOURSMINUTESSECONDS="utcyearmonthdatehoursminutesseconds",t.UTCMONTHDATE="utcmonthdate",t.UTCHOURSMINUTES="utchoursminutes",t.UTCHOURSMINUTESSECONDS="utchoursminutesseconds",t.UTCMINUTESSECONDS="utcminutesseconds",t.UTCSECONDSMILLISECONDS="utcsecondsmilliseconds",t.UTCQUARTER="utcquarter",t.UTCYEARQUARTER="utcyearquarter",t.UTCQUARTERMONTH="utcquartermonth",t.UTCYEARQUARTERMONTH="utcyearquartermonth";var r={year:1,quarter:1,month:1,day:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1};f.TIMEUNIT_PARTS=ue.flagKeys(r),f.isLocalSingleTimeUnit=function(e){return!!r[e]};var i={utcyear:1,utcquarter:1,utcmonth:1,utcday:1,utcdate:1,utchours:1,utcminutes:1,utcseconds:1,utcmilliseconds:1};f.isUtcSingleTimeUnit=function(e){return!!i[e]};var a={utcyearquarter:1,utcyearquartermonth:1,utcyearmonth:1,utcyearmonthdate:1,utcyearmonthdatehours:1,utcyearmonthdatehoursminutes:1,utcyearmonthdatehoursminutesseconds:1,utcquartermonth:1,utcmonthdate:1,utchoursminutes:1,utchoursminutesseconds:1,utcminutesseconds:1,utcsecondsmilliseconds:1},o=ae.__assign({},i,a);function p(e){return!!o[e]}f.isUTCTimeUnit=p,f.getLocalTimeUnit=function(e){return e.substr(3)};var s=ae.__assign({},r,i,{yearquarter:1,yearquartermonth:1,yearmonth:1,yearmonthdate:1,yearmonthdatehours:1,yearmonthdatehoursminutes:1,yearmonthdatehoursminutesseconds:1,quartermonth:1,monthdate:1,hoursminutes:1,hoursminutesseconds:1,minutesseconds:1,secondsmilliseconds:1},a);f.TIMEUNITS=ue.flagKeys(s),f.isTimeUnit=function(e){return!!s[e]};var l={year:"setFullYear",month:"setMonth",date:"setDate",hours:"setHours",minutes:"setMinutes",seconds:"setSeconds",milliseconds:"setMilliseconds",quarter:null,day:null};function g(e,t){var n=l[e];return{setDateMethod:t?"setUTC"+n.substr(3):n,getDateMethod:"get"+(t?"UTC":"")+n.substr(3)}}function m(e,t){var n=e.indexOf(t);return-1<n&&(t!==d.SECONDS||0===n||"i"!==e.charAt(n-1))}f.convert=function(e,t){for(var n=p(e),r=n?new Date(Date.UTC(0,0,1,0,0,0,0)):new Date(0,0,1,0,0,0,0),i=0,a=f.TIMEUNIT_PARTS;i<a.length;i++){var o=a[i];if(m(e,o))switch(o){case d.DAY:throw new Error("Cannot convert to TimeUnits containing 'day'");case d.QUARTER:var s=g("month",n),l=s.getDateMethod;r[s.setDateMethod](3*Math.floor(t[l]()/3));break;default:var u=g(o,n),c=u.getDateMethod;r[u.setDateMethod](t[c]())}}return r},f.getTimeUnitParts=function(n){return f.TIMEUNIT_PARTS.reduce(function(e,t){return m(n,t)?e.concat(t):e},[])},f.containsTimeUnit=m,f.fieldExpr=function(r,e){var i=ue.accessPathWithDatum(e),a=p(r)?"utc":"",t=f.TIMEUNIT_PARTS.reduce(function(e,t){var n;return m(r,t)&&(e[t]=(n=t)===d.QUARTER?"("+a+"quarter("+i+")-1)":""+a+n+"("+i+")"),e},{});return pe.dateTimeExpr(t)},f.formatExpression=function(e,t,n,r){if(e){var i=[],a="",o=m(e,d.YEAR);m(e,d.QUARTER)&&(a="'Q' + quarter("+t+")"),m(e,d.MONTH)&&i.push(!1!==n?"%b":"%B"),m(e,d.DAY)?i.push(n?"%a":"%A"):m(e,d.DATE)&&i.push("%d"+(o?",":"")),o&&i.push(n?"%y":"%Y");var s=[];m(e,d.HOURS)&&s.push("%H"),m(e,d.MINUTES)&&s.push("%M"),m(e,d.SECONDS)&&s.push("%S"),m(e,d.MILLISECONDS)&&s.push("%L");var l=[];return 0<i.length&&l.push(i.join(" ")),0<s.length&&l.push(s.join(":")),0<l.length&&(a&&(a+=" + ' ' + "),a+=r?"utcFormat("+t+", '"+l.join(" ")+"')":"timeFormat("+t+", '"+l.join(" ")+"')"),a||void 0}},f.normalizeTimeUnit=function(e){return"day"!==e&&0<=e.indexOf("day")?(n.warn(n.message.dayReplacedWithDate(e)),e.replace("day","date")):e}});t(me);me.TimeUnit,me.TIMEUNIT_PARTS,me.isLocalSingleTimeUnit,me.isUtcSingleTimeUnit,me.isUTCTimeUnit,me.getLocalTimeUnit,me.TIMEUNITS,me.isTimeUnit,me.convert,me.getTimeUnitParts,me.containsTimeUnit,me.fieldExpr,me.formatExpression,me.normalizeTimeUnit;var he=n(function(e,t){var n,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=n=t.Type||(t.Type={})).QUANTITATIVE="quantitative",r.ORDINAL="ordinal",r.TEMPORAL="temporal",r.NOMINAL="nominal",r.GEOJSON="geojson",t.TYPE_INDEX={quantitative:1,ordinal:1,temporal:1,nominal:1,geojson:1},t.isType=function(e){return!!t.TYPE_INDEX[e]},t.QUANTITATIVE=n.QUANTITATIVE,t.ORDINAL=n.ORDINAL,t.TEMPORAL=n.TEMPORAL,t.NOMINAL=n.NOMINAL,t.GEOJSON=n.GEOJSON,t.getFullName=function(e){if(e)switch(e=e.toLowerCase()){case"q":case t.QUANTITATIVE:return"quantitative";case"t":case t.TEMPORAL:return"temporal";case"o":case t.ORDINAL:return"ordinal";case"n":case t.NOMINAL:return"nominal";case t.GEOJSON:return"geojson"}}});t(he);he.Type,he.TYPE_INDEX,he.isType,he.QUANTITATIVE,he.ORDINAL,he.TEMPORAL,he.NOMINAL,he.GEOJSON,he.getFullName;var ve=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var l=ae.__importStar(de);function r(e){return!!e&&!!e.condition&&!oe.isArray(e.condition)&&i(e.condition)}function i(e){return!(!e||!e.field&&"count"!==e.aggregate)}function n(e){return e&&"value"in e&&void 0!==e.value}function a(e){return!(!e||!e.axis&&!e.stack&&!e.impute)}function o(e){return!!e&&!!e.legend}function s(e){return!!e&&!!e.format}function u(e){switch(e.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return!!e.bin;case"temporal":return!1}throw new Error(l.message.invalidFieldType(e.type))}function c(e){return!u(e)}function f(e){return"count"===e.aggregate}function d(e,t){var n=e.field,r=e.bin,i=e.timeUnit,a=e.aggregate;return"count"===a?t.countTitle:Se.isBinning(r)?n+" (binned)":i?n+" ("+me.getTimeUnitParts(i).join("-")+")":a?ue.titlecase(a)+" of "+n:n}function p(e,t){var n=e.aggregate||e.timeUnit||Se.isBinning(e.bin)&&"bin";return n?n.toUpperCase()+"("+e.field+")":e.field}t.isConditionalSelection=function(e){return e.selection},t.isRepeatRef=function(e){return e&&!oe.isString(e)&&"repeat"in e},t.toFieldDefBase=function(e){var t=e.field,n=e.timeUnit,r=e.bin,i=e.aggregate;return ae.__assign({},n?{timeUnit:n}:{},r?{bin:r}:{},i?{aggregate:i}:{},{field:t})},t.isConditionalDef=function(e){return!!e&&!!e.condition},t.hasConditionalFieldDef=r,t.hasConditionalValueDef=function(e){return!!e&&!!e.condition&&(oe.isArray(e.condition)||n(e.condition))},t.isFieldDef=i,t.isStringFieldDef=function(e){return i(e)&&oe.isString(e.field)},t.isValueDef=n,t.isScaleFieldDef=function(e){return!(!e||!e.scale&&!e.sort)},t.isPositionFieldDef=a,t.isMarkPropFieldDef=o,t.isTextFieldDef=s,t.vgField=function(e,t){void 0===t&&(t={});var n=e.field,r=t.prefix,i=t.suffix;if(f(e))n="count_*";else{var a=void 0;t.nofn||(e.op?a=e.op:Se.isBinning(e.bin)?(a=Se.binToString(e.bin),i=t.binSuffix||""):e.aggregate?a=String(e.aggregate):e.timeUnit&&(a=String(e.timeUnit))),a&&(n=n?a+"_"+n:a)}return i&&(n=n+"_"+i),r&&(n=r+"_"+n),t.forAs?n:t.expr?ue.flatAccessWithDatum(n,t.expr):ue.replacePathInField(n)},t.isDiscrete=u,t.isContinuous=c,t.isCount=f,t.verbalTitleFormatter=d,t.functionalTitleFormatter=p,t.defaultTitleFormatter=function(e,t){switch(t.fieldTitle){case"plain":return e.field;case"functional":return p(e);default:return d(e,t)}};var g=t.defaultTitleFormatter;function m(e){g=e}function h(e){return a(e)&&e.axis?e.axis:o(e)&&e.legend?e.legend:ge.isFacetFieldDef(e)&&e.header?e.header:void 0}function v(e,t){return g(e,t)}function y(e,t){if(e.timeUnit)return"temporal";if(Se.isBinning(e.bin))return"quantitative";switch(_e.rangeType(t)){case"continuous":return"quantitative";case"discrete":case"flexible":return"nominal";default:return"quantitative"}}function _(e,t){if(e.aggregate&&!ce.isAggregateOp(e.aggregate)){e.aggregate;var n=ae.__rest(e,["aggregate"]);l.warn(l.message.invalidAggregate(e.aggregate)),e=n}if(e.timeUnit&&(e=ae.__assign({},e,{timeUnit:me.normalizeTimeUnit(e.timeUnit)})),Se.isBinning(e.bin)&&(e=ae.__assign({},e,{bin:S(e.bin,t)})),Se.isBinned(e.bin)&&!ue.contains(_e.POSITION_SCALE_CHANNELS,t)&&l.warn("Channel "+t+' should not be used with "binned" bin'),e.type){var r=he.getFullName(e.type);e.type!==r&&(e=ae.__assign({},e,{type:r})),"quantitative"!==e.type&&ce.isCountingAggregateOp(e.aggregate)&&(l.warn(l.message.invalidFieldTypeForCountAggregate(e.type,e.aggregate)),e=ae.__assign({},e,{type:"quantitative"}))}else{var i=y(e,t);l.warn(l.message.emptyOrInvalidFieldType(e.type,t,i)),e=ae.__assign({},e,{type:i})}var a=E(e,t),o=a.compatible,s=a.warning;return o||l.warn(s),e}function S(e,t){return oe.isBoolean(e)?{maxbins:Se.autoMaxBins(t)}:e.maxbins||e.step?e:ae.__assign({},e,{maxbins:Se.autoMaxBins(t)})}t.setTitleFormatter=m,t.resetTitleFormatter=function(){m(t.defaultTitleFormatter)},t.title=function(e,t,n){var r=n.allowDisabling,i=(h(e)||{}).title;return r?ue.getFirstDefined(i,e.title,v(e,t)):i||e.title||v(e,t)},t.getGuide=h,t.defaultTitle=v,t.format=function(e){return s(e)&&e.format?e.format:(h(e)||{}).format},t.defaultType=y,t.getFieldDef=function(e){return i(e)?e:r(e)?e.condition:void 0},t.normalize=function(e,t){if(oe.isString(e)||oe.isNumber(e)||oe.isBoolean(e)){var n=oe.isString(e)?"string":oe.isNumber(e)?"number":"boolean";return l.warn(l.message.primitiveChannelDef(t,n,e)),{value:e}}return i(e)?_(e,t):r(e)?ae.__assign({},e,{condition:_(e.condition,t)}):e},t.normalizeFieldDef=_,t.normalizeBin=S;var b={compatible:!0};function E(e,t){var n=e.type;if("geojson"===n&&"shape"!==t)return{compatible:!1,warning:"Channel "+t+" should not be used with a geojson data."};switch(t){case"row":case"column":return c(e)?{compatible:!1,warning:l.message.facetChannelShouldBeDiscrete(t)}:b;case"x":case"y":case"color":case"fill":case"stroke":case"text":case"detail":case"key":case"tooltip":case"href":return b;case"longitude":case"longitude2":case"latitude":case"latitude2":return n!==he.QUANTITATIVE?{compatible:!1,warning:"Channel "+t+" should be used with a quantitative field only, not "+e.type+" field."}:b;case"opacity":case"size":case"x2":case"y2":return"nominal"!==n||e.sort?b:{compatible:!1,warning:"Channel "+t+" should not be used with an unsorted discrete field."};case"shape":return"nominal"!==e.type&&"geojson"!==e.type?{compatible:!1,warning:"Shape channel should be used with only either nominal or geojson data"}:b;case"order":return"nominal"!==e.type||"sort"in e?b:{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}}throw new Error("channelCompatability not implemented for channel "+t)}function N(e,t){var n,r,i=t.timeUnit,a=t.type,o=t.time,s=t.undefinedIfExprNotRequired;return pe.isDateTime(e)?r=pe.dateTimeExpr(e,!0):(oe.isString(e)||oe.isNumber(e))&&(i||"temporal"===a)&&(r=me.isLocalSingleTimeUnit(i)?pe.dateTimeExpr(((n={})[i]=e,n),!0):me.isUtcSingleTimeUnit(i)?N(e,{timeUnit:me.getLocalTimeUnit(i)}):"datetime("+JSON.stringify(e)+")"),r?o?"time("+r+")":r:s?void 0:JSON.stringify(e)}t.channelCompatibility=E,t.isNumberFieldDef=function(e){return"quantitative"===e.type||Se.isBinning(e.bin)},t.isTimeFieldDef=function(e){return"temporal"===e.type||!!e.timeUnit},t.valueExpr=N,t.valueArray=function(e,t){var n=e.timeUnit,r=e.type;return t.map(function(e){var t=N(e,{timeUnit:n,type:r,undefinedIfExprNotRequired:!0});return void 0!==t?{signal:t}:e})}});t(ve);ve.isConditionalSelection,ve.isRepeatRef,ve.toFieldDefBase,ve.isConditionalDef,ve.hasConditionalFieldDef,ve.hasConditionalValueDef,ve.isFieldDef,ve.isStringFieldDef,ve.isValueDef,ve.isScaleFieldDef,ve.isPositionFieldDef,ve.isMarkPropFieldDef,ve.isTextFieldDef,ve.vgField,ve.isDiscrete,ve.isContinuous,ve.isCount,ve.verbalTitleFormatter,ve.functionalTitleFormatter,ve.defaultTitleFormatter,ve.setTitleFormatter,ve.resetTitleFormatter,ve.title,ve.getGuide,ve.defaultTitle,ve.format,ve.defaultType,ve.getFieldDef,ve.normalize,ve.normalizeFieldDef,ve.normalizeBin,ve.channelCompatibility,ve.isNumberFieldDef,ve.isTimeFieldDef,ve.valueExpr,ve.valueArray;var ye=n(function(e,t){var n,r;Object.defineProperty(t,"__esModule",{value:!0}),(r=n=t.Mark||(t.Mark={})).AREA="area",r.BAR="bar",r.LINE="line",r.POINT="point",r.RECT="rect",r.RULE="rule",r.TEXT="text",r.TICK="tick",r.TRAIL="trail",r.CIRCLE="circle",r.SQUARE="square",r.GEOSHAPE="geoshape",t.AREA=n.AREA,t.BAR=n.BAR,t.LINE=n.LINE,t.POINT=n.POINT,t.TEXT=n.TEXT,t.TICK=n.TICK,t.TRAIL=n.TRAIL,t.RECT=n.RECT,t.RULE=n.RULE,t.GEOSHAPE=n.GEOSHAPE,t.CIRCLE=n.CIRCLE,t.SQUARE=n.SQUARE;var i={area:1,bar:1,line:1,point:1,text:1,tick:1,trail:1,rect:1,geoshape:1,rule:1,circle:1,square:1};function a(e){return e.type}t.isMark=function(e){return!!i[e]},t.isPathMark=function(e){return ue.contains(["line","area","trail"],e)},t.PRIMITIVE_MARKS=ue.flagKeys(i),t.isMarkDef=a;var o=oe.toSet(t.PRIMITIVE_MARKS);t.isPrimitiveMark=function(e){return(a(e)?e.type:e)in o},t.STROKE_CONFIG=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit"],t.FILL_CONFIG=["fill","fillOpacity"],t.FILL_STROKE_CONFIG=[].concat(t.STROKE_CONFIG,t.FILL_CONFIG),t.VL_ONLY_MARK_CONFIG_PROPERTIES=["filled","color","tooltip"],t.VL_ONLY_MARK_SPECIFIC_CONFIG_PROPERTY_INDEX={area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize"],line:["point"],text:["shortTimeLabels"],tick:["bandSize","thickness"]},t.defaultMarkConfig={color:"#4c78a8",tooltip:{content:"encoding"}},t.defaultBarConfig={binSpacing:1,continuousBandSize:5},t.defaultTickConfig={thickness:1}});t(ye);ye.Mark,ye.AREA,ye.BAR,ye.LINE,ye.POINT,ye.TEXT,ye.TICK,ye.TRAIL,ye.RECT,ye.RULE,ye.GEOSHAPE,ye.CIRCLE,ye.SQUARE,ye.isMark,ye.isPathMark,ye.PRIMITIVE_MARKS,ye.isMarkDef,ye.isPrimitiveMark,ye.STROKE_CONFIG,ye.FILL_CONFIG,ye.FILL_STROKE_CONFIG,ye.VL_ONLY_MARK_CONFIG_PROPERTIES,ye.VL_ONLY_MARK_SPECIFIC_CONFIG_PROPERTY_INDEX,ye.defaultMarkConfig,ye.defaultBarConfig,ye.defaultTickConfig;var _e=n(function(e,i){var t,n;Object.defineProperty(i,"__esModule",{value:!0}),(n=t=i.Channel||(i.Channel={})).ROW="row",n.COLUMN="column",n.X="x",n.Y="y",n.X2="x2",n.Y2="y2",n.LATITUDE="latitude",n.LONGITUDE="longitude",n.LATITUDE2="latitude2",n.LONGITUDE2="longitude2",n.COLOR="color",n.FILL="fill",n.STROKE="stroke",n.SHAPE="shape",n.SIZE="size",n.OPACITY="opacity",n.TEXT="text",n.ORDER="order",n.DETAIL="detail",n.KEY="key",n.TOOLTIP="tooltip",n.HREF="href",i.X=t.X,i.Y=t.Y,i.X2=t.X2,i.Y2=t.Y2,i.LATITUDE=t.LATITUDE,i.LATITUDE2=t.LATITUDE2,i.LONGITUDE=t.LONGITUDE,i.LONGITUDE2=t.LONGITUDE2,i.ROW=t.ROW,i.COLUMN=t.COLUMN,i.SHAPE=t.SHAPE,i.SIZE=t.SIZE,i.COLOR=t.COLOR,i.FILL=t.FILL,i.STROKE=t.STROKE,i.TEXT=t.TEXT,i.DETAIL=t.DETAIL,i.KEY=t.KEY,i.ORDER=t.ORDER,i.OPACITY=t.OPACITY,i.TOOLTIP=t.TOOLTIP,i.HREF=t.HREF,i.GEOPOSITION_CHANNEL_INDEX={longitude:1,longitude2:1,latitude:1,latitude2:1},i.GEOPOSITION_CHANNELS=ue.flagKeys(i.GEOPOSITION_CHANNEL_INDEX);var r=ae.__assign({x:1,y:1,x2:1,y2:1},i.GEOPOSITION_CHANNEL_INDEX,{color:1,fill:1,stroke:1,opacity:1,size:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1});i.isColorChannel=function(e){return"color"===e||"fill"===e||"stroke"===e};var a=ae.__assign({},r,{row:1,column:1});i.CHANNELS=ue.flagKeys(a);a.order,a.detail;var o=ae.__rest(a,["order","detail"]);i.SINGLE_DEF_CHANNELS=ue.flagKeys(o),i.isChannel=function(e){return!!a[e]},i.UNIT_CHANNELS=ue.flagKeys(r);r.x,r.y,r.x2,r.y2,r.latitude,r.longitude,r.latitude2,r.longitude2;var s=ae.__rest(r,["x","y","x2","y2","latitude","longitude","latitude2","longitude2"]);i.NONPOSITION_CHANNELS=ue.flagKeys(s);var l={x:1,y:1};i.POSITION_SCALE_CHANNELS=ue.flagKeys(l);s.text,s.tooltip,s.href,s.detail,s.key,s.order;var u=ae.__rest(s,["text","tooltip","href","detail","key","order"]);i.NONPOSITION_SCALE_CHANNELS=ue.flagKeys(u);var c=ae.__assign({},l,u);function f(e){switch(e){case i.COLOR:case i.FILL:case i.STROKE:case i.DETAIL:case i.KEY:case i.TOOLTIP:case i.HREF:case i.ORDER:case i.OPACITY:case i.ROW:case i.COLUMN:return{point:!0,tick:!0,rule:!0,circle:!0,square:!0,bar:!0,rect:!0,line:!0,trail:!0,area:!0,text:!0,geoshape:!0};case i.X:case i.Y:case i.LATITUDE:case i.LONGITUDE:return{point:!0,tick:!0,rule:!0,circle:!0,square:!0,bar:!0,rect:!0,line:!0,trail:!0,area:!0,text:!0};case i.X2:case i.Y2:case i.LATITUDE2:case i.LONGITUDE2:return{rule:!0,bar:!0,rect:!0,area:!0};case i.SIZE:return{point:!0,tick:!0,rule:!0,circle:!0,square:!0,bar:!0,text:!0,line:!0,trail:!0};case i.SHAPE:return{point:!0,geoshape:!0};case i.TEXT:return{text:!0}}}i.SCALE_CHANNELS=ue.flagKeys(c),i.isScaleChannel=function(e){return!!c[e]},i.supportMark=function(e,t,n){if(ue.contains([ye.CIRCLE,ye.POINT,ye.SQUARE,ye.TICK],n)&&ue.contains([i.X2,i.Y2],t)){var r=e[t===i.X2?i.X:i.Y];return!!(ve.isFieldDef(r)&&ve.isFieldDef(e[t])&&Se.isBinned(r.bin))}return n in f(t)},i.getSupportedMark=f,i.rangeType=function(e){switch(e){case i.X:case i.Y:case i.SIZE:case i.OPACITY:case i.X2:case i.Y2:return"continuous";case i.ROW:case i.COLUMN:case i.SHAPE:case i.TEXT:case i.TOOLTIP:case i.HREF:return"discrete";case i.COLOR:case i.FILL:case i.STROKE:return"flexible";case i.LATITUDE:case i.LONGITUDE:case i.LATITUDE2:case i.LONGITUDE2:case i.DETAIL:case i.KEY:case i.ORDER:return}throw new Error("rangeType not implemented for "+e)}});t(_e);_e.Channel,_e.X,_e.Y,_e.X2,_e.Y2,_e.LATITUDE,_e.LATITUDE2,_e.LONGITUDE,_e.LONGITUDE2,_e.ROW,_e.COLUMN,_e.SHAPE,_e.SIZE,_e.COLOR,_e.FILL,_e.STROKE,_e.TEXT,_e.DETAIL,_e.KEY,_e.ORDER,_e.OPACITY,_e.TOOLTIP,_e.HREF,_e.GEOPOSITION_CHANNEL_INDEX,_e.GEOPOSITION_CHANNELS,_e.isColorChannel,_e.CHANNELS,_e.SINGLE_DEF_CHANNELS,_e.isChannel,_e.UNIT_CHANNELS,_e.NONPOSITION_CHANNELS,_e.POSITION_SCALE_CHANNELS,_e.NONPOSITION_SCALE_CHANNELS,_e.SCALE_CHANNELS,_e.isScaleChannel,_e.supportMark,_e.getSupportedMark,_e.rangeType;var Se=n(function(e,t){function n(e){return oe.isObject(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.binToString=function(t){return oe.isBoolean(t)?"bin":"bin"+ue.keys(t).map(function(e){return ue.varName("_"+e+"_"+t[e])}).join("")},t.isBinning=function(e){return!0===e||n(e)},t.isBinned=function(e){return"binned"===e},t.isBinParams=n,t.autoMaxBins=function(e){switch(e){case _e.ROW:case _e.COLUMN:case _e.SIZE:case _e.COLOR:case _e.FILL:case _e.STROKE:case _e.OPACITY:case _e.SHAPE:return 6;default:return 10}}});t(Se);Se.binToString,Se.isBinning,Se.isBinned,Se.isBinParams,Se.autoMaxBins;var be=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=ae.__importStar(de);function i(e,t){var n=e&&e[t];return!!n&&(oe.isArray(n)?ue.some(n,function(e){return!!e.field}):ve.isFieldDef(n)||ve.hasConditionalFieldDef(n))}function n(e,n,r){if(e)for(var t=function(t){oe.isArray(e[t])?e[t].forEach(function(e){n.call(r,e,t)}):n.call(r,e[t],t)},i=0,a=ue.keys(e);i<a.length;i++){t(a[i])}}t.channelHasField=i,t.isAggregate=function(r){return ue.some(_e.CHANNELS,function(e){if(i(r,e)){var t=r[e];if(oe.isArray(t))return ue.some(t,function(e){return!!e.aggregate});var n=ve.getFieldDef(t);return n&&!!n.aggregate}return!1})},t.extractTransformsFromEncoding=function(o,s){var l=[],u=[],c=[],f=[],d={};return n(o,function(e,t){if(ve.isFieldDef(e)){var n=ve.vgField(e,{forAs:!0});if(e.aggregate&&ce.isAggregateOp(e.aggregate))f.push({op:e.aggregate,field:e.field,as:n});else{var r=e.bin;if(Se.isBinning(r)){var i=e.field;u.push({bin:r,field:i,as:n})}else if(e.timeUnit){var a=e.timeUnit;i=e.field,c.push({timeUnit:a,field:i,as:n})}l.push(n)}d[t]={field:ve.vgField(e),type:e.type,title:ve.title(e,s,{allowDisabling:!0})}}else d[t]=o[t]}),{bins:u,timeUnits:c,aggregate:f,groupby:l,encoding:d}},t.normalizeEncoding=function(i,a){return ue.keys(i).reduce(function(e,n){if(!_e.isChannel(n))return o.warn(o.message.invalidEncodingChannel(n)),e;if(!_e.supportMark(i,n,a))return o.warn(o.message.incompatibleChannel(n,a)),e;if("size"===n&&"line"===a){var t=ve.getFieldDef(i[n]);if(t&&t.aggregate)return o.warn(o.message.LINE_WITH_VARYING_SIZE),e}if("color"===n&&("fill"in i||"stroke"in i))return o.warn(o.message.droppingColor("encoding",{fill:"fill"in i,stroke:"stroke"in i})),e;var r=i[n];if("detail"===n||"order"===n&&!oe.isArray(r)&&!ve.isValueDef(r)||"tooltip"===n&&oe.isArray(r))r&&(e[n]=(oe.isArray(r)?r:[r]).reduce(function(e,t){return ve.isFieldDef(t)?e.push(ve.normalizeFieldDef(t,n)):o.warn(o.message.emptyFieldDef(t,n)),e},[]));else{if(!ve.isFieldDef(r)&&!ve.isValueDef(r)&&!ve.isConditionalDef(r))return o.warn(o.message.emptyFieldDef(r,n)),e;e[n]=ve.normalize(r,n)}return e},{})},t.isRanged=function(e){return e&&(!!e.x&&!!e.x2||!!e.y&&!!e.y2)},t.fieldDefs=function(n){var r=[];return _e.CHANNELS.forEach(function(e){if(i(n,e)){var t=n[e];(oe.isArray(t)?t:[t]).forEach(function(e){ve.isFieldDef(e)?r.push(e):ve.hasConditionalFieldDef(e)&&r.push(e.condition)})}}),r},t.forEach=n,t.reduce=function(r,i,e,a){return r?ue.keys(r).reduce(function(e,n){var t=r[n];return oe.isArray(t)?t.reduce(function(e,t){return i.call(a,e,t,n)},e):i.call(a,e,t,n)},e):e}});t(be);be.channelHasField,be.isAggregate,be.extractTransformsFromEncoding,be.normalizeEncoding,be.isRanged,be.fieldDefs,be.forEach,be.reduce;var Ee=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var c=ae.__importStar(de);function m(e,t,n,r){var i=e.color,a=e.opacity,o=e.type;return e[t]||void 0===e[t]&&n[t]?[ae.__assign({},r,{mark:ae.__assign({},n[t],i?{color:i}:{},a?{opacity:a}:{},ye.isMarkDef(r.mark)?r.mark:{type:r.mark},{style:o+"-"+t},oe.isBoolean(e[t])?{}:e[t])})]:[]}t.makeCompositeAggregatePartFactory=function(l,u,c,f,d){var p=c.scale,g=c.axis;return function(e,t,n,r,i){var a,o;void 0===r&&(r=void 0),void 0===i&&(i={});var s=g&&void 0!==g.title?void 0:void 0!==c.title?c.title:c.field;return m(l,e,d,{mark:t,encoding:ae.__assign((a={},a[u]=ae.__assign({field:n+"_"+c.field,type:c.type},s?{title:s}:{},p?{scale:p}:{},g?{axis:g}:{}),a),oe.isString(r)?(o={},o[u+"2"]={field:r+"_"+c.field,type:c.type},o):{},f,i)})}},t.partLayerMixins=m,t.compositeMarkContinuousAxis=function(e,t,n){var r,i,a,o=e.encoding;if("vertical"===t?(a="y",r=o.y,i=o.y2?o.y2:void 0):(a="x",r=o.x,i=o.x2?o.x2:void 0),r&&r.aggregate){var s=r.aggregate,l=ae.__rest(r,["aggregate"]);s!==n&&c.warn(c.message.errorBarContinuousAxisHasCustomizedAggregate(s,n)),r=l}if(i&&i.aggregate){s=i.aggregate;var u=ae.__rest(i,["aggregate"]);s!==n&&c.warn(c.message.errorBarContinuousAxisHasCustomizedAggregate(s,n)),i=u}return{continuousAxisChannelDef:r,continuousAxisChannelDef2:i,continuousAxis:a}},t.compositeMarkOrient=function(e,t){var n=e.mark,r=e.encoding;if(ve.isFieldDef(r.x)&&ve.isContinuous(r.x)){if(ve.isFieldDef(r.y)&&ve.isContinuous(r.y)){if(void 0===r.x.aggregate&&r.y.aggregate===t)return"vertical";if(void 0===r.y.aggregate&&r.x.aggregate===t)return"horizontal";if(r.x.aggregate===t&&r.y.aggregate===t)throw new Error("Both x and y cannot have aggregate");return ye.isMarkDef(n)&&n.orient?n.orient:"vertical"}return"horizontal"}if(ve.isFieldDef(r.y)&&ve.isContinuous(r.y))return"vertical";throw new Error("Need a valid continuous axis for "+t+"s")},t.filterUnsupportedChannels=function(e,r,i){return ae.__assign({},e,{encoding:be.reduce(e.encoding,function(e,t,n){return-1<r.indexOf(n)?e[n]=t:c.warn(c.message.incompatibleChannel(n,i)),e},{})})}});t(Ee);Ee.makeCompositeAggregatePartFactory,Ee.partLayerMixins,Ee.compositeMarkContinuousAxis,Ee.compositeMarkOrient,Ee.filterUnsupportedChannels;var Ne=n(function(e,te){Object.defineProperty(te,"__esModule",{value:!0});var ne=ae.__importStar(de);te.BOXPLOT="boxplot";te.BOXPLOT_PARTS=ue.keys({box:1,median:1,outliers:1,rule:1,ticks:1});var re=["x","y","color","detail","opacity","size"];function ie(e){return[{op:"q1",field:e,as:"lower_box_"+e},{op:"q3",field:e,as:"upper_box_"+e}]}te.normalizeBoxPlot=function(e,t){var n,r=(e=Ee.filterUnsupportedChannels(e,re,te.BOXPLOT)).mark,i=(e.encoding,e.selection),a=(e.projection,ae.__rest(e,["mark","encoding","selection","projection"])),o=ye.isMarkDef(r)?r:{type:r};i&&ne.warn(ne.message.selectionNotSupported("boxplot"));var s,l,u,c,f,d,p,g,m,h,v,y,_,S,b,E,N,O,T,x,A,C=o.extent||t.boxplot.extent,D=ue.getFirstDefined(o.size,t.boxplot.size),k=!oe.isNumber(C),P=(s=e,l=C,u=t,c=Ee.compositeMarkOrient(s,te.BOXPLOT),f=Ee.compositeMarkContinuousAxis(s,c,te.BOXPLOT),d=f.continuousAxisChannelDef,p=f.continuousAxis,g=d.field,m=!oe.isNumber(l),h=ie(g).concat([{op:"median",field:g,as:"mid_box_"+g},{op:"min",field:g,as:(m?"lower_whisker_":"min_")+g},{op:"max",field:g,as:(m?"upper_whisker_":"max_")+g}]),v=m?[]:[{calculate:"datum.upper_box_"+g+" - datum.lower_box_"+g,as:"iqr_"+g},{calculate:"min(datum.upper_box_"+g+" + datum.iqr_"+g+" * "+l+", datum.max_"+g+")",as:"upper_whisker_"+g},{calculate:"max(datum.lower_box_"+g+" - datum.iqr_"+g+" * "+l+", datum.min_"+g+")",as:"lower_whisker_"+g}],(y=s.encoding)[_=p],S=ae.__rest(y,["symbol"==typeof _?_:_+""]),b=be.extractTransformsFromEncoding(S,u),E=b.bins,N=b.timeUnits,O=b.aggregate,T=b.groupby,x=b.encoding,A="vertical"===c?"horizontal":"vertical",{transform:E.concat(N,[{aggregate:O.concat(h),groupby:T}],v),groupby:T,continuousAxisChannelDef:d,continuousAxis:p,encodingWithoutContinuousAxis:x,tickOrient:A}),w=P.transform,F=P.continuousAxisChannelDef,R=P.continuousAxis,I=P.groupby,L=P.encodingWithoutContinuousAxis,M=P.tickOrient,U=(L.color,L.size),j=ae.__rest(L,["color","size"]),z=function(e){return Ee.makeCompositeAggregatePartFactory(o,R,F,e,t.boxplot)},B=z(j),H=z(L),G=z(ae.__assign({},j,U?{size:U}:{})),q={type:"tick",color:"black",opacity:1,orient:M},W=ae.__assign({type:"bar"},D?{size:D}:{}),Y=ae.__assign({type:"tick"},oe.isObject(t.boxplot.median)&&t.boxplot.median.color?{color:t.boxplot.median.color}:{},D?{size:D}:{},{orient:M}),V=B("rule","rule","lower_whisker","lower_box").concat(B("rule","rule","upper_box","upper_whisker"),B("ticks",q,"lower_whisker"),B("ticks",q,"upper_whisker"),H("box",W,"lower_box","upper_box"),G("median",Y,"mid_box")),X=[];if(!k){var K="datum.lower_box_"+F.field,Q="datum.upper_box_"+F.field,J="("+Q+" - "+K+")",Z=K+" - "+C+" * "+J,$=Q+" + "+C+" * "+J,ee="datum."+F.field;X=Ee.partLayerMixins(o,"outliers",t.boxplot,{transform:[{window:ie(F.field),frame:[null,null],groupby:I},{filter:"("+ee+" < "+Z+") || ("+ee+" > "+$+")"}],mark:"point",encoding:ae.__assign((n={},n[R]={field:F.field,type:F.type},n),j)})}return 0<X.length?ae.__assign({},a,{layer:[{transform:w,layer:V}].concat(X)}):ae.__assign({},a,{transform:w,layer:V})}});t(Ne);Ne.BOXPLOT,Ne.BOXPLOT_PARTS,Ne.normalizeBoxPlot;var Oe=n(function(e,D){Object.defineProperty(D,"__esModule",{value:!0});var k=ae.__importStar(de);D.ERRORBAR="errorbar";function d(e,t,n){var r=(e=Ee.filterUnsupportedChannels(e,D.errorBarSupportedChannels,t)).mark,i=e.encoding,a=e.selection,o=(e.projection,ae.__rest(e,["mark","encoding","selection","projection"])),s=ye.isMarkDef(r)?r:{type:r};a&&k.warn(k.message.selectionNotSupported(t));var l=function(e,t){var n=e.encoding;if(ve.isFieldDef(n.x2)&&ve.isFieldDef(n.x)&&ve.isContinuous(n.x)){if(ve.isFieldDef(n.y2)&&ve.isFieldDef(n.y)&&ve.isContinuous(n.y))throw new Error("Cannot have both x2 and y2 with both are quantiative");return{orient:"horizontal",isRangedErrorBar:!0}}return ve.isFieldDef(n.y2)&&ve.isFieldDef(n.y)&&ve.isContinuous(n.y)?{orient:"vertical",isRangedErrorBar:!0}:{orient:Ee.compositeMarkOrient(e,t),isRangedErrorBar:!1}}(e,t),u=l.orient,c=l.isRangedErrorBar,f=Ee.compositeMarkContinuousAxis(e,u,t),d=f.continuousAxisChannelDef,p=f.continuousAxisChannelDef2,g=f.continuousAxis,m=function(e,t,n,r,i,a){var o=[],s=[],l=t.field;if(r)(e.center||e.extent)&&k.warn(k.message.errorBarCenterAndExtentAreNotNeeded(e.center,e.extent)),s=[{calculate:"datum."+l,as:"lower_"+l},{calculate:"datum."+n.field,as:"upper_"+l}];else{var u=e.center?e.center:e.extent?"iqr"===e.extent?"median":"mean":a.errorbar.center,c=e.extent?e.extent:"mean"===u?"stderr":"iqr";"median"===u!=("iqr"===c)&&k.warn(k.message.errorBarCenterIsUsedWithWrongExtent(u,c,i)),"stderr"===c||"stdev"===c?(o=[{op:c,field:l,as:"extent_"+l},{op:u,field:l,as:"center_"+l}],s=[{calculate:"datum.center_"+l+" + datum.extent_"+l,as:"upper_"+l},{calculate:"datum.center_"+l+" - datum.extent_"+l,as:"lower_"+l}]):(e.center&&e.extent&&k.warn(k.message.errorBarCenterIsNotNeeded(e.extent,i)),o=[{op:"ci"===c?"ci0":"q1",field:l,as:"lower_"+l},{op:"ci"===c?"ci1":"q3",field:l,as:"upper_"+l}])}return{postAggregateCalculates:s,errorBarSpecificAggregate:o}}(s,d,p,c,t,n),h=m.errorBarSpecificAggregate,v=m.postAggregateCalculates,y=g,_=(i[y],g+"2"),S=(i[_],ae.__rest(i,["symbol"==typeof y?y:y+"","symbol"==typeof _?_:_+""])),b=be.extractTransformsFromEncoding(S,n),E=b.bins,N=b.timeUnits,O=b.aggregate,T=b.groupby,x=b.encoding,A=O.concat(h),C=c?[]:T;return{transform:E.concat(N,A.length?[{aggregate:A,groupby:C}]:[],v),groupby:C,continuousAxisChannelDef:d,continuousAxis:g,encodingWithoutContinuousAxis:x,ticksOrient:"vertical"===u?"horizontal":"vertical",markDef:s,outerSpec:o}}D.ERRORBAR_PARTS=ue.keys({ticks:1,rule:1}),D.normalizeErrorBar=function(e,t){var n=d(e,D.ERRORBAR,t),r=n.transform,i=n.continuousAxisChannelDef,a=n.continuousAxis,o=n.encodingWithoutContinuousAxis,s=n.ticksOrient,l=n.markDef,u=n.outerSpec,c=Ee.makeCompositeAggregatePartFactory(l,a,i,o,t.errorbar),f={type:"tick",orient:s};return ae.__assign({},u,{transform:r,layer:c("ticks",f,"lower").concat(c("ticks",f,"upper"),c("rule","rule","lower","upper"))})},D.errorBarSupportedChannels=["x","y","x2","y2","color","detail","opacity"],D.errorBarParams=d});t(Oe);Oe.ERRORBAR,Oe.ERRORBAR_PARTS,Oe.normalizeErrorBar,Oe.errorBarSupportedChannels,Oe.errorBarParams;var Te=n(function(e,g){Object.defineProperty(g,"__esModule",{value:!0});var m=ae.__importStar(de);g.ERRORBAND="errorband";g.ERRORBAND_PARTS=ue.keys({band:1,borders:1}),g.normalizeErrorBand=function(e,t){var n=Oe.errorBarParams(e,g.ERRORBAND,t),r=n.transform,i=n.continuousAxisChannelDef,a=n.continuousAxis,o=n.encodingWithoutContinuousAxis,s=n.markDef,l=n.outerSpec,u=Ee.makeCompositeAggregatePartFactory(s,a,i,o,t.errorband),c=void 0!==e.encoding.x&&void 0!==e.encoding.y,f={type:c?"area":"rect"},d={type:c?"line":"rule"},p=ae.__assign({},s.interpolate?{interpolate:s.interpolate}:{},s.tension&&s.interpolate?{interpolate:s.tension}:{});return c?(f=ae.__assign({},f,p),d=ae.__assign({},d,p)):s.interpolate?m.warn(m.message.errorBand1DNotSupport("interpolate")):s.tension&&m.warn(m.message.errorBand1DNotSupport("tension")),ae.__assign({},l,{transform:r,layer:u("band",f,"lower","upper").concat(u("borders",d,"lower"),u("borders",d,"upper"))})}});t(Te);Te.ERRORBAND,Te.ERRORBAND_PARTS,Te.normalizeErrorBand;var xe=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r={};function n(e,t,n){r[e]={normalizer:t,parts:n}}t.add=n,t.remove=function(e){delete r[e]},t.getAllCompositeMarks=function(){return ue.keys(r)},t.getCompositeMarkParts=function(e){if(e in r)return r[e].parts;throw new Error("Unregistered composite mark "+e)},n(Ne.BOXPLOT,Ne.normalizeBoxPlot,Ne.BOXPLOT_PARTS),n(Oe.ERRORBAR,Oe.normalizeErrorBar,Oe.ERRORBAR_PARTS),n(Te.ERRORBAND,Te.normalizeErrorBand,Te.ERRORBAND_PARTS),t.normalize=function(e,t){var n=ye.isMarkDef(e.mark)?e.mark.type:e.mark;if(n in r)return(0,r[n].normalizer)(e,t);throw new Error('Invalid mark type "'+n+'"')}});t(xe);xe.add,xe.remove,xe.getAllCompositeMarks,xe.getCompositeMarkParts,xe.normalize;var Ae=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.VL_ONLY_GUIDE_CONFIG=["shortTimeLabels"]});t(Ae);Ae.VL_ONLY_GUIDE_CONFIG;var Ce=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.defaultLegendConfig={};var n={clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,direction:1,fillColor:1,format:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,strokeWidth:1,symbolFillColor:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,title:1,titleAlign:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontWeight:1,titleLimit:1,titleOpacity:1,titlePadding:1,type:1,values:1,zindex:1},r=ae.__assign({},n,{opacity:1,shape:1,stroke:1,fill:1,size:1,encode:1});t.LEGEND_PROPERTIES=ue.flagKeys(n),t.VG_LEGEND_PROPERTIES=ue.flagKeys(r)});t(Ce);Ce.defaultLegendConfig,Ce.LEGEND_PROPERTIES,Ce.VG_LEGEND_PROPERTIES;var De=n(function(e,g){Object.defineProperty(g,"__esModule",{value:!0});var r,t,n=ae.__importStar(de);(t=r=g.ScaleType||(g.ScaleType={})).LINEAR="linear",t.BIN_LINEAR="bin-linear",t.LOG="log",t.POW="pow",t.SQRT="sqrt",t.TIME="time",t.UTC="utc",t.SEQUENTIAL="sequential",t.QUANTILE="quantile",t.QUANTIZE="quantize",t.THRESHOLD="threshold",t.ORDINAL="ordinal",t.BIN_ORDINAL="bin-ordinal",t.POINT="point",t.BAND="band";var i={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric","bin-linear":"bin-linear",time:"time",utc:"time",sequential:"sequential",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"};g.SCALE_TYPES=ue.keys(i),g.scaleCompatible=function(e,t){var n=i[e],r=i[t];return n===r||"ordinal-position"===n&&"time"===r||"ordinal-position"===r&&"time"===n};var a={linear:0,log:1,pow:1,sqrt:1,time:0,utc:0,point:10,band:11,"bin-linear":0,sequential:0,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};g.scaleTypePrecedence=function(e){return a[e]},g.CONTINUOUS_TO_CONTINUOUS_SCALES=["linear","bin-linear","log","pow","sqrt","time","utc"];var o=oe.toSet(g.CONTINUOUS_TO_CONTINUOUS_SCALES);g.CONTINUOUS_TO_DISCRETE_SCALES=["quantile","quantize","threshold"];var s=oe.toSet(g.CONTINUOUS_TO_DISCRETE_SCALES);g.CONTINUOUS_DOMAIN_SCALES=g.CONTINUOUS_TO_CONTINUOUS_SCALES.concat(["sequential","quantile","quantize","threshold"]);var l=oe.toSet(g.CONTINUOUS_DOMAIN_SCALES);g.DISCRETE_DOMAIN_SCALES=["ordinal","bin-ordinal","point","band"];var u=oe.toSet(g.DISCRETE_DOMAIN_SCALES),c=oe.toSet(["bin-linear","bin-ordinal"]);function f(e){return e in u}function d(e){return e in l}function p(e){return e in o}function m(e){return e in s}g.TIME_SCALE_TYPES=["time","utc"],g.hasDiscreteDomain=f,g.isBinScale=function(e){return e in c},g.hasContinuousDomain=d,g.isContinuousToContinuous=p,g.isContinuousToDiscrete=m,g.defaultScaleConfig={textXRangeStep:90,rangeStep:21,pointPadding:.5,bandPaddingInner:.1,facetSpacing:16,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4},g.isExtendedScheme=function(e){return e&&!!e.name},g.isSelectionDomain=function(e){return e&&e.selection};var h={type:1,domain:1,range:1,rangeStep:1,scheme:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1};g.SCALE_PROPERTIES=ue.flagKeys(h);var v=ae.__rest(h,["type","domain","range","rangeStep","scheme"]);function y(e,t,n){return ue.contains([he.Type.ORDINAL,he.Type.NOMINAL],t)?void 0===e||f(e):t===he.Type.TEMPORAL?ue.contains([r.TIME,r.UTC,r.SEQUENTIAL,void 0],e):t!==he.Type.QUANTITATIVE||(n?ue.contains([r.BIN_LINEAR,r.BIN_ORDINAL,r.LINEAR],e):ue.contains([r.LOG,r.POW,r.SQRT,r.QUANTILE,r.QUANTIZE,r.THRESHOLD,r.LINEAR,r.SEQUENTIAL,void 0],e))}function _(e,t){switch(e){case _e.Channel.X:case _e.Channel.Y:return p(t)||ue.contains(["band","point"],t);case _e.Channel.SIZE:case _e.Channel.OPACITY:return p(t)||m(t)||ue.contains(["band","point"],t);case _e.Channel.COLOR:case _e.Channel.FILL:case _e.Channel.STROKE:return"band"!==t;case _e.Channel.SHAPE:return"ordinal"===t}return!1}function S(e,t,n){var r=e+"_"+t;return n?r+"_bin":r}g.NON_TYPE_DOMAIN_RANGE_VEGA_SCALE_PROPERTIES=ue.flagKeys(v),g.SCALE_TYPE_INDEX=function(){for(var e={},t=0,n=_e.CHANNELS;t<n.length;t++)for(var r=n[t],i=0,a=ue.keys(he.TYPE_INDEX);i<a.length;i++)for(var o=a[i],s=0,l=g.SCALE_TYPES;s<l.length;s++)for(var u=l[s],c=0,f=[!1,!0];c<f.length;c++){var d=f[c],p=S(r,o,d);_(r,u)&&y(u,o,d)&&(e[p]=e[p]||[],e[p].push(u))}return e}(),g.scaleTypeSupportProperty=function(e,t){switch(t){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":return ue.contains(["sequential","ordinal","bin-ordinal","quantile","quantize","threshold"],e);case"interpolate":return ue.contains(["linear","bin-linear","pow","log","sqrt","utc","time"],e);case"round":return p(e)||"band"===e||"point"===e;case"padding":return p(e)||ue.contains(["point","band"],e);case"paddingOuter":case"rangeStep":return ue.contains(["point","band"],e);case"paddingInner":return"band"===e;case"clamp":return p(e)||"sequential"===e;case"nice":return p(e)||"sequential"===e||"quantize"===e;case"exponent":return"pow"===e;case"base":return"log"===e;case"zero":return d(e)&&!ue.contains(["log","time","utc","bin-linear","threshold","quantile"],e)}throw new Error("Invalid scale property "+t+".")},g.channelScalePropertyIncompatability=function(e,t){switch(t){case"interpolate":case"scheme":return _e.isColorChannel(e)?void 0:n.message.cannotUseScalePropertyWithNonColor(e);case"type":case"domain":case"range":case"base":case"exponent":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"rangeStep":case"reverse":case"round":case"clamp":case"zero":return}throw new Error('Invalid scale property "'+t+'".')},g.scaleTypeSupportDataType=y,g.channelSupportScaleType=_,g.getSupportedScaleType=function(e,t,n){return g.SCALE_TYPE_INDEX[S(e,t,n)]}});t(De);De.ScaleType,De.SCALE_TYPES,De.scaleCompatible,De.scaleTypePrecedence,De.CONTINUOUS_TO_CONTINUOUS_SCALES,De.CONTINUOUS_TO_DISCRETE_SCALES,De.CONTINUOUS_DOMAIN_SCALES,De.DISCRETE_DOMAIN_SCALES,De.TIME_SCALE_TYPES,De.hasDiscreteDomain,De.isBinScale,De.hasContinuousDomain,De.isContinuousToContinuous,De.isContinuousToDiscrete,De.defaultScaleConfig,De.isExtendedScheme,De.isSelectionDomain,De.SCALE_PROPERTIES,De.NON_TYPE_DOMAIN_RANGE_VEGA_SCALE_PROPERTIES,De.SCALE_TYPE_INDEX,De.scaleTypeSupportProperty,De.channelScalePropertyIncompatability,De.scaleTypeSupportDataType,De.channelSupportScaleType,De.getSupportedScaleType;var ke=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.SELECTION_ID="_vgsid_",t.defaultConfig={single:{on:"click",fields:[t.SELECTION_ID],resolve:"global",empty:"all"},multi:{on:"click",fields:[t.SELECTION_ID],toggle:"event.shiftKey",resolve:"global",empty:"all"},interval:{on:"[mousedown, window:mouseup] > window:mousemove!",encodings:["x","y"],translate:"[mousedown, window:mouseup] > window:mousemove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global"}}});t(ke);ke.SELECTION_ID,ke.defaultConfig;var Pe=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.extractTitleConfig=function(e){var t=e.anchor,n=(e.frame,e.offset),r=e.orient,i=e.color,a=ae.__rest(e,["anchor","frame","offset","orient","color"]);return{mark:ae.__assign({},a,i?{fill:i}:{}),nonMark:ae.__assign({},t?{anchor:t}:{},n?{offset:n}:{},r?{orient:r}:{})}}});t(Pe);Pe.extractTitleConfig;var we=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=ae.__importStar(ye),S=ye;t.defaultViewConfig={width:200,height:200},t.isVgScheme=function(e){return e&&!!e.scheme},t.defaultConfig={padding:5,timeFormat:"%b %d, %Y",countTitle:"Number of Records",invalidValues:"filter",view:t.defaultViewConfig,mark:n.defaultMarkConfig,area:{},bar:n.defaultBarConfig,circle:{},geoshape:{},line:{},point:{},rect:{},rule:{color:"black"},square:{},text:{color:"black"},tick:n.defaultTickConfig,trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:De.defaultScaleConfig,projection:{},axis:{},axisX:{},axisY:{minExtent:30},axisLeft:{},axisRight:{},axisTop:{},axisBottom:{},axisBand:{},legend:Ce.defaultLegendConfig,selection:ke.defaultConfig,style:{},title:{}},t.initConfig=function(e){return ue.mergeDeep(ue.duplicate(t.defaultConfig),e)};var b=["view"].concat(S.PRIMITIVE_MARKS),E=["padding","numberFormat","timeFormat","countTitle","stack","scale","selection","invalidValues","overlay"],N=ae.__assign({view:["width","height"]},S.VL_ONLY_MARK_SPECIFIC_CONFIG_PROPERTY_INDEX);function O(e,t,n,r){var i="title"===t?Pe.extractTitleConfig(e.title).mark:r?e[t][r]:e[t];"view"===t&&(n="cell");var a=ae.__assign({},i,e.style[t]);0<ue.keys(a).length&&(e.style[n||t]=a),r||delete e[t]}t.stripAndRedirectConfig=function(e){e=ue.duplicate(e);for(var t=0,n=E;t<n.length;t++)delete e[a=n[t]];if(e.axis)for(var r=0,i=Ae.VL_ONLY_GUIDE_CONFIG;r<i.length;r++){var a=i[r];delete e.axis[a]}if(e.legend)for(var o=0,s=Ae.VL_ONLY_GUIDE_CONFIG;o<s.length;o++)a=s[o],delete e.legend[a];if(e.mark)for(var l=0,u=S.VL_ONLY_MARK_CONFIG_PROPERTIES;l<u.length;l++)a=u[l],delete e.mark[a];for(var c=0,f=b;c<f.length;c++){for(var d=f[c],p=0,g=S.VL_ONLY_MARK_CONFIG_PROPERTIES;p<g.length;p++)a=g[p],delete e[d][a];var m=N[d];if(m)for(var h=0,v=m;h<v.length;h++)a=v[h],delete e[d][a];O(e,d)}for(var y=0,_=xe.getAllCompositeMarks();y<_.length;y++)delete e[_[y]];for(var a in O(e,"title","group-title"),e)oe.isObject(e[a])&&0===ue.keys(e[a]).length&&delete e[a];return 0<ue.keys(e).length?e:void 0}});t(we);we.defaultViewConfig,we.isVgScheme,we.defaultConfig,we.initConfig,we.stripAndRedirectConfig;var Fe=n(function(e,d){Object.defineProperty(d,"__esModule",{value:!0});var p=ae.__importStar(de),t={zero:1,center:1,normalize:1};function g(e){return!!t[e]}d.isStackOffset=g,d.STACKABLE_MARKS=[ye.BAR,ye.AREA,ye.RULE,ye.POINT,ye.CIRCLE,ye.SQUARE,ye.LINE,ye.TEXT,ye.TICK],d.STACK_BY_DEFAULT_MARKS=[ye.BAR,ye.AREA],d.stack=function(e,t,n){var r=ye.isMarkDef(e)?e.type:e;if(!ue.contains(d.STACKABLE_MARKS,r))return null;var i=function(e){var t=e.x,n=e.y;if(ve.isFieldDef(t)&&ve.isFieldDef(n))if("quantitative"===t.type&&"quantitative"===n.type){if(t.stack)return"x";if(n.stack)return"y";if(!!t.aggregate!=!!n.aggregate)return t.aggregate?"x":"y"}else{if("quantitative"===t.type)return"x";if("quantitative"===n.type)return"y"}else{if(ve.isFieldDef(t)&&"quantitative"===t.type)return"x";if(ve.isFieldDef(n)&&"quantitative"===n.type)return"y"}}(t);if(!i)return null;var a,o=t[i],s=ve.isStringFieldDef(o)?ve.vgField(o,{}):void 0,l="x"===i?"y":"x",u=t[l],c=ve.isStringFieldDef(u)?ve.vgField(u,{}):void 0,f=_e.NONPOSITION_CHANNELS.reduce(function(r,i){if(be.channelHasField(t,i)){var e=t[i];(oe.isArray(e)?e:[e]).forEach(function(e){var t=ve.getFieldDef(e);if(!t.aggregate){var n=ve.isStringFieldDef(t)?ve.vgField(t,{}):void 0;(!n||n!==c&&n!==s)&&r.push({channel:i,fieldDef:t})}})}return r},[]);return 0===f.length?null:(a=void 0!==o.stack?o.stack:ue.contains(d.STACK_BY_DEFAULT_MARKS,r)?ue.getFirstDefined(n,"zero"):n)&&g(a)?(o.scale&&o.scale.type&&o.scale.type!==De.ScaleType.LINEAR&&p.warn(p.message.cannotStackNonLinearScale(o.scale.type)),be.channelHasField(t,i===_e.X?_e.X2:_e.Y2)?(void 0!==o.stack&&p.warn(p.message.cannotStackRangedMark(i)),null):(o.aggregate&&!ue.contains(ce.SUM_OPS,o.aggregate)&&p.warn(p.message.stackNonSummativeAggregate(o.aggregate)),{groupbyChannel:u?l:void 0,fieldChannel:i,impute:ye.isPathMark(r),stackBy:f,offset:a})):null}});t(Fe);Fe.isStackOffset,Fe.STACKABLE_MARKS,Fe.STACK_BY_DEFAULT_MARKS,Fe.stack;var Re=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var c=ae.__importStar(xe),w=ae.__importStar(de);function F(e,t){if(Ie.isFacetSpec(e))return r=t,i=(n=e).spec,a=ae.__rest(n,["spec"]),ae.__assign({},a,{spec:F(i,r)});var n,r,i,a,o,s,l,u,c,f,d,p,g,m,h,v,y,_,S,b,E,N,O,T,x,A,C,D;if(Ie.isLayerSpec(e))return function t(e,n,r,i){var a=e.layer,o=e.encoding,s=e.projection,l=ae.__rest(e,["layer","encoding","projection"]);var u=R({parentEncoding:r,encoding:o});var c=I({parentProjection:i,projection:s});return ae.__assign({},l,{layer:a.map(function(e){return Ie.isLayerSpec(e)?t(e,n,u,c):L(e,n,u,c)})})}(e,t);if(Ie.isRepeatSpec(e))return s=t,l=(o=e).spec,u=ae.__rest(o,["spec"]),ae.__assign({},u,{spec:F(l,s)});if(Ie.isVConcatSpec(e))return f=t,d=(c=e).vconcat,p=ae.__rest(c,["vconcat"]),ae.__assign({},p,{vconcat:d.map(function(e){return F(e,f)})});if(Ie.isHConcatSpec(e))return m=t,h=(g=e).hconcat,v=ae.__rest(g,["hconcat"]),ae.__assign({},v,{hconcat:h.map(function(e){return F(e,m)})});if(Ie.isUnitSpec(e)){var k=be.channelHasField(e.encoding,_e.ROW),P=be.channelHasField(e.encoding,_e.COLUMN);return k||P?(_=t,S=(y=e).encoding,b=S.row,E=S.column,N=ae.__rest(S,["row","column"]),O=y.mark,T=y.width,x=y.projection,A=y.height,C=y.selection,y.encoding,D=ae.__rest(y,["mark","width","projection","height","selection","encoding"]),ae.__assign({},D,{facet:ae.__assign({},b?{row:b}:{},E?{column:E}:{}),spec:L(ae.__assign({},x?{projection:x}:{},{mark:O},T?{width:T}:{},A?{height:A}:{},{encoding:N},C?{selection:C}:{}),_)})):L(e,t)}throw new Error(w.message.INVALID_SPEC)}function R(e){var t=e.parentEncoding,n=e.encoding;if(t&&n){var r=ue.keys(t).reduce(function(e,t){return n[t]&&e.push(t),e},[]);0<r.length&&w.warn(w.message.encodingOverridden(r))}var i=ae.__assign({},t||{},n||{});return 0<ue.keys(i).length?i:void 0}function I(e){var t=e.parentProjection,n=e.projection;return t&&n&&w.warn(w.message.projectionOverridden({parentProjection:t,projection:n})),n||t}function L(e,t,n,r){var i,a=e.encoding,o=e.projection,s=ye.isMarkDef(e.mark)?e.mark.type:e.mark;if(n||r){var l=I({parentProjection:r,projection:o}),u=R({parentEncoding:n,encoding:a});return L(ae.__assign({},e,l?{projection:l}:{},u?{encoding:u}:{}),t)}return i=e,ye.isPrimitiveMark(i.mark)?be.isRanged(a)?function(e){var t=be.channelHasField(e.encoding,_e.X),n=be.channelHasField(e.encoding,_e.Y),r=be.channelHasField(e.encoding,_e.X2),i=be.channelHasField(e.encoding,_e.Y2);if(r&&!t||i&&!n){var a=ue.duplicate(e);return r&&!t&&(a.encoding.x=a.encoding.x2,delete a.encoding.x2),i&&!n&&(a.encoding.y=a.encoding.y2,delete a.encoding.y2),a}return e}(e):"line"===s&&(a.x2||a.y2)?(w.warn(w.message.lineWithRange(!!a.x2,!!a.y2)),L(ae.__assign({mark:"rule"},e),t,n,r)):ye.isPathMark(s)?function(e,t){void 0===t&&(t={});var n,r=e.selection,i=e.projection,a=e.encoding,o=e.mark,s=ae.__rest(e,["selection","projection","encoding","mark"]),l=ye.isMarkDef(o)?o:{type:o},u=(p=l,g=t[l.type],m=a,"transparent"===p.point?{opacity:0}:p.point?oe.isObject(p.point)?p.point:{}:void 0!==p.point?null:g.point||m.shape?oe.isObject(g.point)?g.point:{}:null),c="area"===l.type&&(f=l,d=t[l.type],f.line?!0===f.line?{}:f.line:void 0!==f.line?null:d.line?!0===d.line?{}:d.line:null);var f,d;var p,g,m;if(!u&&!c)return ae.__assign({},e,{mark:b(l)});var h=[ae.__assign({},r?{selection:r}:{},{mark:b(ae.__assign({},l,"area"===l.type?{opacity:.7}:{})),encoding:ue.omit(a,["shape"])})],v=Fe.stack(l,a,t?t.stack:void 0),y=a;if(v){var _=v.fieldChannel,S=v.offset;y=ae.__assign({},a,((n={})[_]=ae.__assign({},a[_],S?{stack:S}:{}),n))}c&&h.push(ae.__assign({},i?{projection:i}:{},{mark:ae.__assign({type:"line"},ue.pick(l,["clip","interpolate","tension"]),c),encoding:y}));u&&h.push(ae.__assign({},i?{projection:i}:{},{mark:ae.__assign({type:"point",opacity:1,filled:!0},ue.pick(l,["clip"]),u),encoding:y}));return ae.__assign({},s,{layer:h})}(e,t):e:c.normalize(e,t)}function b(e){e.point,e.line;var t=ae.__rest(e,["point","line"]);return 1<ue.keys(t).length?t:t.type}t.normalizeTopLevelSpec=function(e,t){return F(e,t)}});t(Re);Re.normalizeTopLevelSpec;var Ie=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=ae.__importStar(be);function i(e){return void 0!==e.facet}function a(e){return!!e.mark}function o(e){return void 0!==e.layer}function s(e){return void 0!==e.repeat}function l(e){return u(e)||n(e)}function u(e){return void 0!==e.vconcat}function n(e){return void 0!==e.hconcat}function c(r,e){return e.forEach(function(n){var e=["field","type","value","timeUnit","bin","aggregate"].reduce(function(e,t){return void 0!==n[t]&&(e[t]=n[t]),e},{}),t=ue.hash(e);r[t]=r[t]||n}),r}t.isFacetSpec=i,t.isUnitSpec=a,t.isLayerSpec=o,t.isRepeatSpec=s,t.isConcatSpec=l,t.isVConcatSpec=u,t.isHConcatSpec=n,t.normalize=Re.normalizeTopLevelSpec,t.fieldDefs=function(e){return ue.vals(function t(e,n){return void 0===n&&(n={}),o(e)?e.layer.forEach(function(e){a(e)?c(n,r.fieldDefs(e.encoding)):t(e,n)}):i(e)?(c(n,r.fieldDefs(e.facet)),t(e.spec,n)):s(e)?t(e.spec,n):l(e)?(u(e)?e.vconcat:e.hconcat).forEach(function(e){return t(e,n)}):c(n,r.fieldDefs(e.encoding)),n}(e))},t.isStacked=function(e,t){return t=t||e.config,!!ye.isPrimitiveMark(e.mark)&&null!==Fe.stack(e.mark,e.encoding,t?t.stack:void 0)}});t(Ie);Ie.isFacetSpec,Ie.isUnitSpec,Ie.isLayerSpec,Ie.isRepeatSpec,Ie.isConcatSpec,Ie.isVConcatSpec,Ie.isHConcatSpec,Ie.normalize,Ie.fieldDefs,Ie.isStacked;var Le=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=ae.__importStar(de);function a(e){return oe.isString(e)?{type:e}:e||{}}t.extractCompositionLayout=function(e){var t=e||{},n=t.align,r=void 0===n?void 0:n,i=t.center,a=void 0===i?void 0:i,o=t.bounds,s=void 0===o?void 0:o,l=t.spacing;return{align:r,bounds:s,center:a,spacing:void 0===l?void 0:l}},t.normalizeAutoSize=function(e,t,n){void 0===n&&(n=!0);var r=ae.__assign({type:"pad"},a(t),a(e));return"fit"===r.type&&(n||(i.warn(i.message.FIT_NON_SINGLE),r.type="pad")),r};var r=["background","padding","datasets"];t.extractTopLevelProperties=function(n){return r.reduce(function(e,t){return n&&void 0!==n[t]&&(e[t]=n[t]),e},{})}});t(Le);Le.extractCompositionLayout,Le.normalizeAutoSize,Le.extractTopLevelProperties;var Me=n(function(e,t){function n(e){return!!e.url}function r(e){return!!e.values}Object.defineProperty(t,"__esModule",{value:!0}),t.isUrlData=n,t.isInlineData=r,t.isNamedData=function(e){return!!e.name&&!n(e)&&!r(e)},t.MAIN="main",t.RAW="raw"});t(Me);Me.isUrlData,Me.isInlineData,Me.isNamedData,Me.MAIN,Me.RAW;var Ue,je,ze="[",Be="]",He="{",Ge="}",qe=":",We=",",Ye="@",Ve=">",Xe=/[[\]{}]/,Ke={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};function Qe(e,t,n,r,i){for(var a,o=0,s=e.length;t<s;++t){if(a=e[t],!o&&a===n)return t;i&&0<=i.indexOf(a)?--o:r&&0<=r.indexOf(a)&&++o}return t}function Je(e){for(var t=[],n=0,r=e.length,i=0;i<r;)i=Qe(e,i,We,ze+He,Be+Ge),t.push(e.substring(n,i).trim()),n=++i;if(0===t.length)throw"Empty event selector: "+e;return t}function Ze(e){return"["===e[0]?function(e){var t,n,r=e.length,i=1;if((i=Qe(e,i,Be,ze,Be))===r)throw"Empty between selector: "+e;if(2!==(t=Je(e.substring(1,i))).length)throw"Between selector must have two elements: "+e;if((e=e.slice(i+1).trim())[0]!==Ve)throw"Expected '>' after between selector: "+e;{if(t=t.map(Ze),(n=Ze(e.slice(1).trim())).between)return{between:t,stream:n};n.between=t}return n}(e):function(t){var e,n,r={source:Ue},i=[],a=[0,0],o=0,s=0,l=t.length,u=0;if(t[l-1]===Ge){if(!(0<=(u=t.lastIndexOf(He))))throw"Unmatched right brace: "+t;try{a=function(n){var e=n.split(We);if(!n.length||2<e.length)throw n;return e.map(function(e){var t=+e;if(t!=t)throw n;return t})}(t.substring(u+1,l-1))}catch(e){throw"Invalid throttle specification: "+t}t=t.slice(0,u).trim(),l=t.length,u=0}if(!l)throw t;t[0]===Ye&&(o=++u);(e=Qe(t,u,qe))<l&&(i.push(t.substring(s,e).trim()),s=u=++e);if((u=Qe(t,u,ze))===l)i.push(t.substring(s,l).trim());else if(i.push(t.substring(s,u).trim()),n=[],(s=++u)===l)throw"Unmatched left bracket: "+t;for(;u<l;){if((u=Qe(t,u,Be))===l)throw"Unmatched left bracket: "+t;if(n.push(t.substring(s,u).trim()),u<l-1&&t[++u]!==ze)throw"Expected left bracket: "+t;s=++u}if(!(l=i.length)||Xe.test(i[l-1]))throw"Invalid event selector: "+t;1<l?(r.type=i[1],o?r.markname=i[0].slice(1):(c=i[0],je.hasOwnProperty(c)?r.marktype=i[0]:r.source=i[0])):r.type=i[0];var c;"!"===r.type.slice(-1)&&(r.consume=!0,r.type=r.type.slice(0,-1));null!=n&&(r.filter=n);a[0]&&(r.throttle=a[0]);a[1]&&(r.debounce=a[1]);return r}(e)}var $e=Object.freeze({selector:function(e,t,n){return Ue=t||"view",je=n||Ke,Je(e.trim()).map(Ze)}}),et=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.isSignalRef=function(e){return!!e.signal},t.isVgRangeStep=function(e){return!!e.step},t.isDataRefUnionedDomain=function(e){return!oe.isArray(e)&&"fields"in e&&!("data"in e)},t.isFieldRefUnionDomain=function(e){return!oe.isArray(e)&&"fields"in e&&"data"in e},t.isDataRefDomain=function(e){return!oe.isArray(e)&&"field"in e&&"data"in e},t.isSignalRefDomain=function(e){return!oe.isArray(e)&&"signal"in e};t.VG_MARK_CONFIGS=ue.flagKeys({opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeMiterLimit:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,cursor:1,href:1,tooltip:1,cornerRadius:1})});t(et);et.isSignalRef,et.isVgRangeStep,et.isDataRefUnionedDomain,et.isFieldRefUnionDomain,et.isDataRefDomain,et.isSignalRefDomain,et.VG_MARK_CONFIGS;var tt=n(function(e,t){function o(e,n,t,r){void 0===r&&(r={header:!1});var i=e.combine(),a=i.orient,o=i.scale,s=i.title,l=i.zindex,u=ae.__rest(i,["orient","scale","title","zindex"]);if(ue.keys(u).forEach(function(e){var t=fe.AXIS_PROPERTY_TYPE[e];t&&t!==n&&"both"!==t&&delete u[e]}),"grid"===n){if(!u.grid)return;if(u.encode){var c=u.encode.grid;u.encode=ae.__assign({},c?{grid:c}:{}),0===ue.keys(u.encode).length&&delete u.encode}return ae.__assign({scale:o,orient:a},u,{domain:!1,labels:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:ue.getFirstDefined(l,0)})}if(r.header||!e.mainExtracted){if(u.encode){for(var f=0,d=fe.AXIS_PARTS;f<d.length;f++){var p=d[f];e.hasAxisPart(p)||delete u.encode[p]}0===ue.keys(u.encode).length&&delete u.encode}var g,m,h=(g=s,m=t,oe.isArray(g)?g.map(function(e){return ve.defaultTitle(e,m)}).join(", "):g);return ae.__assign({scale:o,orient:a,grid:!1},h?{title:h}:{},u,{zindex:ue.getFirstDefined(l,1)})}}Object.defineProperty(t,"__esModule",{value:!0}),t.assembleAxis=o,t.assembleAxes=function(e,t){var n=e.x,r=void 0===n?[]:n,i=e.y,a=void 0===i?[]:i;return r.map(function(e){return o(e,"main",t)}).concat(r.map(function(e){return o(e,"grid",t)}),a.map(function(e){return o(e,"main",t)}),a.map(function(e){return o(e,"grid",t)})).filter(function(e){return e})}});t(tt);tt.assembleAxis,tt.assembleAxes;var nt=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.HEADER_TITLE_PROPERTIES_MAP={titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontWeight:"fontWeight",titleLimit:"limit",titlePadding:"offset"},t.HEADER_LABEL_PROPERTIES_MAP={labelAngle:"angle",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelLimit:"limit",labelPadding:"offset"},t.HEADER_TITLE_PROPERTIES=Object.keys(t.HEADER_TITLE_PROPERTIES_MAP),t.HEADER_LABEL_PROPERTIES=Object.keys(t.HEADER_LABEL_PROPERTIES_MAP)});t(nt);nt.HEADER_TITLE_PROPERTIES_MAP,nt.HEADER_LABEL_PROPERTIES_MAP,nt.HEADER_TITLE_PROPERTIES,nt.HEADER_LABEL_PROPERTIES;var rt=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.isSortField=function(e){return!(!e||"count"!==e.op&&!e.field||!e.op)},t.isSortArray=function(e){return!!e&&oe.isArray(e)}});t(rt);rt.isSortField,rt.isSortArray;var it=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var u=ae.__importStar(de);function c(e,t,n,r){var i=ae.__assign({},t?{scale:t}:{},{field:ve.vgField(e,n)});return r?ae.__assign({},i,r):i}function f(e,t,n){return{signal:'scale("'+e+'", ('+ve.vgField(t,{expr:"datum"})+" + "+(void 0!==n?ve.vgField(n,{expr:"datum"}):ve.vgField(t,{binSuffix:"end",expr:"datum"}))+") / 2)"}}function s(e,t,n,r,i,a,o){if(t){if(ve.isFieldDef(t)){if(Se.isBinning(t.bin))return ue.contains([_e.X,_e.Y],e)&&t.type===he.QUANTITATIVE?a&&a.impute?c(t,r,{binSuffix:"mid"}):f(r,t):c(t,r,ot.binRequiresRange(t,e)?{binSuffix:"range"}:{});if(Se.isBinned(t.bin)){if(ve.isFieldDef(n))return f(r,t,n);u.warn(u.message.channelRequiredForBinned(e))}if(i){var s=i.get("type");if(De.hasDiscreteDomain(s))return"band"===s?c(t,r,{binSuffix:"range"},{band:.5}):c(t,r,{binSuffix:"range"})}return c(t,r,{})}if(ve.isValueDef(t)){var l=t.value;return ue.contains(["x","x2"],e)&&"width"===l?{field:{group:"width"}}:ue.contains(["y","y2"],e)&&"height"===l?{field:{group:"height"}}:{value:l}}}return oe.isFunction(o)?o():o}function d(e,t){if(e){if(ve.isValueDef(e))return{value:e.value};if(ve.isFieldDef(e))return ot.formatSignalRef(e,ve.format(e),"datum",t)}}t.position=function(e,t,n,r,i,a,o){return ve.isFieldDef(t)&&a&&e===a.fieldChannel?c(t,r,{suffix:"end"}):s(e,t,n,r,i,a,o)},t.position2=function(e,t,n,r,i,a,o){return ve.isFieldDef(t)&&a&&e.charAt(0)===a.fieldChannel.charAt(0)?c(t,r,{suffix:"start"}):s(e,n,void 0,r,i,a,o)},t.getOffset=function(e,t){var n=t[e+"Offset"];if(n)return n},t.bin=function(e,t,n,r){return c(e,t,{binSuffix:"start"===n?void 0:"end"},r?{offset:r}:{})},t.fieldRef=c,t.bandRef=function(e,t){return void 0===t&&(t=!0),{scale:e,band:t}},t.midPoint=s,t.tooltipForChannelDefs=function(e,t){for(var n=[],r={},i=0,a=e;i<a.length;i++){var o=a[i],s=ve.title(o,t,{allowDisabling:!1}),l=d(o,t).signal;r[s]||n.push('"'+s+'": '+l),r[s]=!0}return n.length?{signal:"{"+n.join(", ")+"}"}:void 0},t.text=d,t.mid=function(e){return ae.__assign({},e,{mult:.5})},t.getDefaultRef=function(t,n,r,i,a){return function(){if(oe.isString(t)){if(r){var e=i.get("type");if(ue.contains([De.ScaleType.LOG,De.ScaleType.TIME,De.ScaleType.UTC],e))"bar"!==a&&"area"!==a||u.warn(u.message.nonZeroScaleUsedWithLengthMark(a,n,{scaleType:e}));else{if(function(e){if(!1!==e.get("zero"))return!0;var t=e.domains;return!!oe.isArray(t)&&ue.some(t,function(e){return oe.isArray(e)&&2===e.length&&e[0]<=0&&0<=e[1]})}(i))return{scale:r,value:0};"bar"!==a&&"area"!==a||u.warn(u.message.nonZeroScaleUsedWithLengthMark(a,n,{zeroFalse:!1===i.explicit.zero}))}}return"zeroOrMin"===t?"x"===n?{value:0}:{field:{group:"height"}}:"x"===n?{field:{group:"width"}}:{value:0}}return t}}});t(it);it.position,it.position2,it.getOffset,it.bin,it.fieldRef,it.bandRef,it.midPoint,it.tooltipForChannelDefs,it.text,it.mid,it.getDefaultRef;var at=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var p=ae.__importStar(de),g=ae.__importStar(it);function s(e){var t,n,r=e.markDef,i=e.encoding,a=e.config,o=r.filled,s=r.type,l={fill:ot.getMarkConfig("fill",r,a),stroke:ot.getMarkConfig("stroke",r,a),color:ot.getMarkConfig("color",r,a)},u=ue.contains(["bar","point","circle","square","geoshape"],s)?"transparent":void 0,c={fill:ue.getFirstDefined(r.fill,l.fill,u),stroke:ue.getFirstDefined(r.stroke,l.stroke)},f=o?"fill":"stroke",d=ae.__assign({},c.fill?{fill:{value:c.fill}}:{},c.stroke?{stroke:{value:c.stroke}}:{});return i.fill||i.stroke?(r.color&&p.warn(p.message.droppingColor("property",{fill:"fill"in i,stroke:"stroke"in i})),ae.__assign({},m("fill",e,{defaultValue:ue.getFirstDefined(c.fill,u)}),m("stroke",e,{defaultValue:c.stroke}))):i.color?ae.__assign({},d,m("color",e,{vgChannel:f,defaultValue:ue.getFirstDefined(r[f],r.color,l[f],l.color,o?u:void 0)})):void 0!==r.fill||void 0!==r.stroke?(r.color&&p.warn(p.message.droppingColor("property",{fill:"fill"in r,stroke:"stroke"in r})),d):r.color?ae.__assign({},d,((t={})[f]={value:r.color},t)):void 0!==l.fill||void 0!==l.stroke?d:l.color?ae.__assign({},u?{fill:{value:"transparent"}}:{},((n={})[f]={value:l.color},n)):{}}function l(e,t,n){var r,i,a=e.config,o=e.mark;if(a.invalidValues&&n&&!ye.isPathMark(o)){var s=u(e,{invalid:!0,channels:_e.SCALE_CHANNELS});if(s)return(r={})[t]=[{test:s,value:null}].concat(oe.array(n)),r}return n?((i={})[t]=n,i):{}}function u(a,e){var t=e.invalid,n=void 0!==t&&t,r=e.channels.reduce(function(e,t){var n=a.getScaleComponent(t);if(n){var r=n.get("type"),i=a.vgField(t,{expr:"datum"});i&&De.hasContinuousDomain(r)&&(e[i]=!0)}return e},{}),i=ue.keys(r);if(0<i.length){var o=n?"||":"&&";return i.map(function(e){return e+" "+(n?"===":"!==")+" null "+o+" "+(n?"":"!")+"isNaN("+e+")"}).join(" "+o+" ")}}function m(t,n,e){void 0===e&&(e={});var r=e.defaultValue,i=e.vgChannel,a=e.defaultRef||(void 0!==r?{value:r}:void 0),o=n.encoding[t];return c(n,o,i||t,function(e){return g.midPoint(t,e,void 0,n.scaleName(t),n.getScaleComponent(t),null,a)})}function c(r,e,t,i){var n,a,o=e&&e.condition,s=i(e);if(o){var l=(oe.isArray(o)?o:[o]).map(function(e){var t=i(e),n=ve.isConditionalSelection(e)?xr.selectionPredicate(r,e.selection):Ar.expression(r,e.test);return ae.__assign({test:n},t)});return(n={})[t]=l.concat(void 0!==s?[s]:[]),n}return void 0!==s?((a={})[t]=s,a):{}}function f(r){var i=r.encoding,a=r.markDef,o=r.config,e=i.tooltip;return oe.isArray(e)?{tooltip:g.tooltipForChannelDefs(e,o)}:c(r,e,"tooltip",function(e){var t=g.text(e,r.config);if(t)return t;var n=ue.getFirstDefined(a.tooltip,ot.getMarkConfig("tooltip",a,o));return oe.isString(n)?{value:n}:oe.isObject(n)?"encoding"===n.content?g.tooltipForChannelDefs(be.fieldDefs(i),o):{signal:"datum"}:void 0})}function d(t,e){void 0===e&&(e="text");var n=t.encoding[e];return c(t,n,e,function(e){return g.text(e,t.config)})}function o(e,t,n,r){var i,a=t.encoding,o=t.mark,s=t.stack,l=a[e],u=a[e===_e.X?_e.X2:_e.Y2],c=t.scaleName(e),f=t.getScaleComponent(e),d=g.getOffset(e,t.markDef),p=l||!a.latitude&&!a.longitude?ae.__assign({},g.position(e,l,u,c,f,s,g.getDefaultRef(n,e,c,f,o)),d?{offset:d}:{}):{field:t.getName(e)};return(i={})[r||e]=p,i}t.color=s,t.baseEncodeEntry=function(e,t){var n,r,i=s(e),a=i.fill,o=i.stroke;return ae.__assign({},(n=e.markDef,r=t,et.VG_MARK_CONFIGS.reduce(function(e,t){return void 0!==n[t]&&"ignore"!==r[t]&&(e[t]={value:n[t]}),e},{})),l(e,"fill",a),l(e,"stroke",o),m("opacity",e),f(e),d(e,"href"))},t.valueIfDefined=function(e,t){var n;if(void 0!==t)return(n={})[e]={value:t},n},t.defined=function(e){if("filter"===e.config.invalidValues){var t=u(e,{channels:["x","y"]});if(t)return{defined:{signal:t}}}return{}},t.nonPosition=m,t.wrapCondition=c,t.tooltip=f,t.text=d,t.bandPosition=function(e,t,n){var r,i,a,o=n.scaleName(t),s="x"===t?"width":"height";if(n.encoding.size||void 0!==n.markDef.size)if(n.markDef.orient){var l=((r={})[t+"c"]=g.fieldRef(e,o,{},{band:.5}),r);if(ve.getFieldDef(n.encoding.size))return ae.__assign({},l,m("size",n,{vgChannel:s}));if(ve.isValueDef(n.encoding.size))return ae.__assign({},l,m("size",n,{vgChannel:s}));if(void 0!==n.markDef.size)return ae.__assign({},l,((i={})[s]={value:n.markDef.size},i))}else p.warn(p.message.cannotApplySizeToNonOrientedMark(n.markDef.type));return(a={})[t]=g.fieldRef(e,o,{binSuffix:"range"}),a[s]=g.bandRef(o),a},t.centeredBandPosition=function(e,t,n,r){var i="x"===e?"xc":"yc",a="x"===e?"width":"height";return ae.__assign({},o(e,t,n,i),m("size",t,{defaultRef:r,vgChannel:a}))},t.binPosition=function(e,t,n,r,i,a){var o,s,l={x:a?i:0,x2:a?0:i,y:a?0:i,y2:a?i:0},u=n===_e.X?_e.X2:_e.Y2;return Se.isBinning(e.bin)?((o={})[u]=g.bin(e,r,"start",l[n+"2"]),o[n]=g.bin(e,r,"end",l[n]),o):Se.isBinned(e.bin)&&ve.isFieldDef(t)?((s={})[u]=g.fieldRef(e,r,{},{offset:l[n+"2"]}),s[n]=g.fieldRef(t,r,{},{offset:l[n]}),s):void p.warn(p.message.channelRequiredForBinned(u))},t.pointPosition=o,t.pointPosition2=function(e,t,n){var r,i=e.encoding,a=e.mark,o=e.stack,s="x2"===n?"x":"y",l=i[s],u=e.scaleName(s),c=e.getScaleComponent(s),f=g.getOffset(n,e.markDef),d=l||!i.latitude&&!i.longitude?ae.__assign({},g.position2(n,l,i[n],u,c,o,g.getDefaultRef(t,s,u,c,a)),f?{offset:f}:{}):{field:e.getName(n)};return(r={})[n]=d,r}});t(at);at.color,at.baseEncodeEntry,at.valueIfDefined,at.defined,at.nonPosition,at.wrapCondition,at.tooltip,at.text,at.bandPosition,at.centeredBandPosition,at.binPosition,at.pointPosition,at.pointPosition2;var ot=n(function(e,t){function l(e){return[].concat(e.type,e.style||[])}function s(e,t,n,r){var i=(void 0===r?{}:r).skipGeneralMarkConfig,a=void 0!==i&&i;return ue.getFirstDefined(o(e,t,n.style),n[t.type][e],a?void 0:n.mark[e])}function o(e,t,n){for(var r,i=0,a=l(t);i<a.length;i++){var o=n[a[i]],s=e;o&&void 0!==o[s]&&(r=o[s])}return r}function u(e,t,n){if(e.type===he.QUANTITATIVE)return t||n.numberFormat}function c(e,t){return"format("+e+', "'+(t||"")+'")'}function i(e,t,n){return c(e,t||n.numberFormat)}function f(e,t,n,r){return e+" === null || isNaN("+e+') ? "null" : '+i(e,n,r)+' + " - " + '+i(t,n,r)}function d(e,t,n,r,i,a,o){return void 0===o&&(o=!1),!t||n?(n=n||i)||o?(a?"utc":"time")+"Format("+e+", '"+n+"')":void 0:me.formatExpression(t,e,r,a)}function n(e,t){var i=e.slice();return t.forEach(function(e){for(var t=0,n=i;t<n.length;t++){var r=n[t];if(ue.stringify(r)===ue.stringify(e))return}i.push(e)}),i}function r(e,t){return e===t?e:e+", "+t}Object.defineProperty(t,"__esModule",{value:!0}),t.applyConfig=function(e,t,n){for(var r=0,i=n;r<i.length;r++){var a=i[r],o=t[a];void 0!==o&&(e[a]={value:o})}return e},t.applyMarkConfig=function(e,t,n){for(var r=0,i=n;r<i.length;r++){var a=i[r],o=s(a,t.markDef,t.config);void 0!==o&&(e[a]={value:o})}return e},t.getStyles=l,t.getMarkConfig=s,t.getStyleConfig=o,t.formatSignalRef=function(e,t,n,r){var i=u(e,t,r);if(Se.isBinning(e.bin))return{signal:f(ve.vgField(e,{expr:n}),ve.vgField(e,{expr:n,binSuffix:"end"}),i,r)};if("quantitative"===e.type)return{signal:""+c(ve.vgField(e,{expr:n,binSuffix:"range"}),i)};if(ve.isTimeFieldDef(e)){var a=ve.isScaleFieldDef(e)&&e.scale&&e.scale.type===De.ScaleType.UTC;return{signal:d(ve.vgField(e,{expr:n}),e.timeUnit,t,r.text.shortTimeLabels,r.timeFormat,a,!0)}}return{signal:"''+"+ve.vgField(e,{expr:n})}},t.numberFormat=u,t.numberFormatExpr=i,t.binFormatExpression=f,t.timeFormatExpression=d,t.sortParams=function(e,n){return(oe.isArray(e)?e:[e]).reduce(function(e,t){return e.field.push(ve.vgField(t,n)),e.order.push(t.sort||"ascending"),e},{field:[],order:[]})},t.mergeTitleFieldDefs=n,t.mergeTitle=r,t.mergeTitleComponent=function(e,t){if(oe.isArray(e.value)&&oe.isArray(t.value))return{explicit:e.explicit,value:n(e.value,t.value)};if(!oe.isArray(e.value)&&!oe.isArray(t.value))return{explicit:e.explicit,value:r(e.value,t.value)};throw new Error("It should never reach here")},t.binRequiresRange=function(e,t){return Se.isBinning(e.bin)?_e.isScaleChannel(t)&&ue.contains(["ordinal","nominal"],e.type):(console.warn("Only use this method with binned field defs"),!1)},t.guideEncodeEntry=function(r,i){return ue.keys(r).reduce(function(e,t){var n=r[t];return ae.__assign({},e,at.wrapCondition(i,n,t,function(e){return{value:e.value}}))},{})}});t(ot);ot.applyConfig,ot.applyMarkConfig,ot.getStyles,ot.getMarkConfig,ot.getStyleConfig,ot.formatSignalRef,ot.numberFormat,ot.numberFormatExpr,ot.binFormatExpression,ot.timeFormatExpression,ot.sortParams,ot.mergeTitleFieldDefs,ot.mergeTitle,ot.mergeTitleComponent,ot.binRequiresRange,ot.guideEncodeEntry;var st=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this.debugName=t,this._children=[],this._parent=null,e&&(this.parent=e)}return e.prototype.clone=function(){throw new Error("Cannot clone node")},e.prototype.producedFields=function(){return{}},e.prototype.dependentFields=function(){return{}},Object.defineProperty(e.prototype,"parent",{get:function(){return this._parent},set:function(e){(this._parent=e).addChild(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"children",{get:function(){return this._children},enumerable:!0,configurable:!0}),e.prototype.numChildren=function(){return this._children.length},e.prototype.addChild=function(e,t){void 0!==t?this._children.splice(t,0,e):this._children.push(e)},e.prototype.removeChild=function(e){var t=this._children.indexOf(e);return this._children.splice(t,1),t},e.prototype.remove=function(){for(var e=this._parent.removeChild(this),t=0,n=this._children;t<n.length;t++){var r=n[t];r._parent=this._parent,this._parent.addChild(r,e++)}},e.prototype.insertAsParentOf=function(e){var t=e.parent;t.removeChild(this),this.parent=t,e.parent=this},e.prototype.swapWithParent=function(){for(var e=this._parent,t=e.parent,n=0,r=this._children;n<r.length;n++){r[n].parent=e}this._children=[],e.removeChild(this),e.parent.removeChild(e),this.parent=t,e.parent=this},e}(),r=function(a){function e(e,t,n,r){var i=a.call(this,e,t)||this;return i.type=n,i.refCounts=r,i._source=i._name=t,!i.refCounts||i._name in i.refCounts||(i.refCounts[i._name]=0),i}return ae.__extends(e,a),e.prototype.clone=function(){var e=new this.constructor;return e.debugName="clone_"+this.debugName,e._source=this._source,e._name="clone_"+this._name,e.type=this.type,e.refCounts=this.refCounts,e.refCounts[e._name]=0,e},e.prototype.getSource=function(){return this.refCounts[this._name]++,this._source},e.prototype.isRequired=function(){return!!this.refCounts[this._name]},e.prototype.setSource=function(e){this._source=e},e}(t.DataFlowNode=n);t.OutputNode=r;var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ae.__extends(t,e),t}(n);t.TransformNode=i,t.isTransformNode=function(e){return e instanceof i}});t(st);var lt,ut,ct,ft,dt;st.DataFlowNode,st.OutputNode,st.TransformNode,st.isTransformNode;function pt(e){this.type=e}pt.prototype.visit=function(e){var t,n,r;if(e(this))return 1;for(n=0,r=(t=function(e){switch(e.type){case"ArrayExpression":return e.elements;case"BinaryExpression":case"LogicalExpression":return[e.left,e.right];case"CallExpression":var t=e.arguments.slice();return t.unshift(e.callee),t;case"ConditionalExpression":return[e.test,e.consequent,e.alternate];case"MemberExpression":return[e.object,e.property];case"ObjectExpression":return e.properties;case"Property":return[e.key,e.value];case"UnaryExpression":return[e.argument];case"Identifier":case"Literal":case"RawCode":default:return[]}}(this)).length;n<r;++n)if(t[n].visit(e))return 1};var gt=1,mt=2,ht=3,vt=4,yt=5,_t=6,St=7,bt=8;(lt={})[gt]="Boolean",lt[mt]="<end>",lt[ht]="Identifier",lt[vt]="Keyword",lt[yt]="Null",lt[_t]="Numeric",lt[St]="Punctuator",lt[bt]="String",lt[9]="RegularExpression";var Et="ArrayExpression",Nt="BinaryExpression",Ot="CallExpression",Tt="ConditionalExpression",xt="Identifier",At="Literal",Ct="LogicalExpression",Dt="MemberExpression",kt="ObjectExpression",Pt="Property",wt="UnaryExpression",Ft="Unexpected token %0",Rt="Unexpected number",It="Unexpected string",Lt="Unexpected identifier",Mt="Unexpected reserved word",Ut="Unexpected end of input",jt="Invalid regular expression",zt="Invalid regular expression: missing /",Bt="Octal literals are not allowed in strict mode.",Ht="Duplicate data property in object literal not allowed in strict mode",Gt="ILLEGAL",qt="Disabled.",Wt=new RegExp("[ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮͰ-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԯԱ-Ֆՙա-ևא-תװ-ײؠ-يٮٯٱ-ۓەۥۦۮۯۺ-ۼۿܐܒ-ܯݍ-ޥޱߊ-ߪߴߵߺࠀ-ࠕࠚࠤࠨࡀ-ࡘࢠ-ࢲऄ-हऽॐक़-ॡॱ-ঀঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়-ৡৰৱਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-హఽౘౙౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-ഺഽൎൠൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆก-ะาำเ-ๆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜ-ໟༀཀ-ཇཉ-ཬྈ-ྌက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛸᜀ-ᜌᜎ-ᜑᜠ-ᜱᝀ-ᝑᝠ-ᝬᝮ-ᝰក-ឳៗៜᠠ-ᡷᢀ-ᢨᢪᢰ-ᣵᤀ-ᤞᥐ-ᥭᥰ-ᥴᦀ-ᦫᧁ-ᧇᨀ-ᨖᨠ-ᩔᪧᬅ-ᬳᭅ-ᭋᮃ-ᮠᮮᮯᮺ-ᯥᰀ-ᰣᱍ-ᱏᱚ-ᱽᳩ-ᳬᳮ-ᳱᳵᳶᴀ-ᶿḀ-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼⁱⁿₐ-ₜℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳮⳲⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯⶀ-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⸯ々-〇〡-〩〱-〵〸-〼ぁ-ゖゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘟꘪꘫꙀ-ꙮꙿ-ꚝꚠ-ꛯꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞭꞰꞱꟷ-ꠁꠃ-ꠅꠇ-ꠊꠌ-ꠢꡀ-ꡳꢂ-ꢳꣲ-ꣷꣻꤊ-ꤥꤰ-ꥆꥠ-ꥼꦄ-ꦲꧏꧠ-ꧤꧦ-ꧯꧺ-ꧾꨀ-ꨨꩀ-ꩂꩄ-ꩋꩠ-ꩶꩺꩾ-ꪯꪱꪵꪶꪹ-ꪽꫀꫂꫛ-ꫝꫠ-ꫪꫲ-ꫴꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭟꭤꭥꯀ-ꯢ가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִײַ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻﹰ-ﹴﹶ-ﻼＡ-Ｚａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ]"),Yt=new RegExp("[ªµºÀ-ÖØ-öø-ˁˆ-ˑˠ-ˤˬˮ̀-ʹͶͷͺ-ͽͿΆΈ-ΊΌΎ-ΡΣ-ϵϷ-ҁ҃-҇Ҋ-ԯԱ-Ֆՙա-և֑-ׇֽֿׁׂׅׄא-תװ-ײؐ-ؚؠ-٩ٮ-ۓە-ۜ۟-۪ۨ-ۼۿܐ-݊ݍ-ޱ߀-ߵߺࠀ-࠭ࡀ-࡛ࢠ-ࢲࣤ-ॣ०-९ॱ-ঃঅ-ঌএঐও-নপ-রলশ-হ়-ৄেৈো-ৎৗড়ঢ়য়-ৣ০-ৱਁ-ਃਅ-ਊਏਐਓ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹ਼ਾ-ੂੇੈੋ-੍ੑਖ਼-ੜਫ਼੦-ੵઁ-ઃઅ-ઍએ-ઑઓ-નપ-રલળવ-હ઼-ૅે-ૉો-્ૐૠ-ૣ૦-૯ଁ-ଃଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହ଼-ୄେୈୋ-୍ୖୗଡ଼ଢ଼ୟ-ୣ୦-୯ୱஂஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹா-ூெ-ைொ-்ௐௗ௦-௯ఀ-ఃఅ-ఌఎ-ఐఒ-నప-హఽ-ౄె-ైొ-్ౕౖౘౙౠ-ౣ౦-౯ಁ-ಃಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹ಼-ೄೆ-ೈೊ-್ೕೖೞೠ-ೣ೦-೯ೱೲഁ-ഃഅ-ഌഎ-ഐഒ-ഺഽ-ൄെ-ൈൊ-ൎൗൠ-ൣ൦-൯ൺ-ൿංඃඅ-ඖක-නඳ-රලව-ෆ්ා-ුූෘ-ෟ෦-෯ෲෳก-ฺเ-๎๐-๙ກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ູົ-ຽເ-ໄໆ່-ໍ໐-໙ໜ-ໟༀ༘༙༠-༩༹༵༷༾-ཇཉ-ཬཱ-྄྆-ྗྙ-ྼ࿆က-၉ၐ-ႝႠ-ჅჇჍა-ჺჼ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚ፝-፟ᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙿᚁ-ᚚᚠ-ᛪᛮ-ᛸᜀ-ᜌᜎ-᜔ᜠ-᜴ᝀ-ᝓᝠ-ᝬᝮ-ᝰᝲᝳក-៓ៗៜ៝០-៩᠋-᠍᠐-᠙ᠠ-ᡷᢀ-ᢪᢰ-ᣵᤀ-ᤞᤠ-ᤫᤰ-᤻᥆-ᥭᥰ-ᥴᦀ-ᦫᦰ-ᧉ᧐-᧙ᨀ-ᨛᨠ-ᩞ᩠-᩿᩼-᪉᪐-᪙ᪧ᪰-᪽ᬀ-ᭋ᭐-᭙᭫-᭳ᮀ-᯳ᰀ-᰷᱀-᱉ᱍ-ᱽ᳐-᳔᳒-ᳶ᳸᳹ᴀ-᷵᷼-ἕἘ-Ἕἠ-ὅὈ-Ὅὐ-ὗὙὛὝὟ-ώᾀ-ᾴᾶ-ᾼιῂ-ῄῆ-ῌῐ-ΐῖ-Ίῠ-Ῥῲ-ῴῶ-ῼ‌‍‿⁀⁔ⁱⁿₐ-ₜ⃐-⃥⃜⃡-⃰ℂℇℊ-ℓℕℙ-ℝℤΩℨK-ℭℯ-ℹℼ-ℿⅅ-ⅉⅎⅠ-ↈⰀ-Ⱞⰰ-ⱞⱠ-ⳤⳫ-ⳳⴀ-ⴥⴧⴭⴰ-ⵧⵯ⵿-ⶖⶠ-ⶦⶨ-ⶮⶰ-ⶶⶸ-ⶾⷀ-ⷆⷈ-ⷎⷐ-ⷖⷘ-ⷞⷠ-ⷿⸯ々-〇〡-〯〱-〵〸-〼ぁ-ゖ゙゚ゝ-ゟァ-ヺー-ヿㄅ-ㄭㄱ-ㆎㆠ-ㆺㇰ-ㇿ㐀-䶵一-鿌ꀀ-ꒌꓐ-ꓽꔀ-ꘌꘐ-ꘫꙀ-꙯ꙴ-꙽ꙿ-ꚝꚟ-꛱ꜗ-ꜟꜢ-ꞈꞋ-ꞎꞐ-ꞭꞰꞱꟷ-ꠧꡀ-ꡳꢀ-꣄꣐-꣙꣠-ꣷꣻ꤀-꤭ꤰ-꥓ꥠ-ꥼꦀ-꧀ꧏ-꧙ꧠ-ꧾꨀ-ꨶꩀ-ꩍ꩐-꩙ꩠ-ꩶꩺ-ꫂꫛ-ꫝꫠ-ꫯꫲ-꫶ꬁ-ꬆꬉ-ꬎꬑ-ꬖꬠ-ꬦꬨ-ꬮꬰ-ꭚꭜ-ꭟꭤꭥꯀ-ꯪ꯬꯭꯰-꯹가-힣ힰ-ퟆퟋ-ퟻ豈-舘並-龎ﬀ-ﬆﬓ-ﬗיִ-ﬨשׁ-זּטּ-לּמּנּסּףּפּצּ-ﮱﯓ-ﴽﵐ-ﶏﶒ-ﷇﷰ-ﷻ︀-️︠-︭︳︴﹍-﹏ﹰ-ﹴﹶ-ﻼ０-９Ａ-Ｚ＿ａ-ｚｦ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ]");function Vt(e,t){if(!e)throw new Error("ASSERT: "+t)}function Xt(e){return 48<=e&&e<=57}function Kt(e){return 0<="0123456789abcdefABCDEF".indexOf(e)}function Qt(e){return 0<="01234567".indexOf(e)}function Jt(e){return 10===e||13===e||8232===e||8233===e}function Zt(e){return 36===e||95===e||65<=e&&e<=90||97<=e&&e<=122||92===e||128<=e&&Wt.test(String.fromCharCode(e))}function $t(e){return 36===e||95===e||65<=e&&e<=90||97<=e&&e<=122||48<=e&&e<=57||92===e||128<=e&&Yt.test(String.fromCharCode(e))}var en={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function tn(){for(var e,t;ct<ft&&(e=ut.charCodeAt(ct),32===(t=e)||9===t||11===t||12===t||160===t||5760<=t&&0<=[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(t)||Jt(e));)++ct}function nn(e){var t,n,r,i=0;for(n="u"===e?4:2,t=0;t<n;++t)ct<ft&&Kt(ut[ct])?(r=ut[ct++],i=16*i+"0123456789abcdef".indexOf(r.toLowerCase())):yn({},Ft,Gt);return String.fromCharCode(i)}function rn(){var e,t,n,r;for(t=0,"}"===(e=ut[ct])&&yn({},Ft,Gt);ct<ft&&Kt(e=ut[ct++]);)t=16*t+"0123456789abcdef".indexOf(e.toLowerCase());return(1114111<t||"}"!==e)&&yn({},Ft,Gt),t<=65535?String.fromCharCode(t):(n=55296+(t-65536>>10),r=56320+(t-65536&1023),String.fromCharCode(n,r))}function an(){var e,t;for(e=ut.charCodeAt(ct++),t=String.fromCharCode(e),92===e&&(117!==ut.charCodeAt(ct)&&yn({},Ft,Gt),++ct,(e=nn("u"))&&"\\"!==e&&Zt(e.charCodeAt(0))||yn({},Ft,Gt),t=e);ct<ft&&$t(e=ut.charCodeAt(ct));)++ct,t+=String.fromCharCode(e),92===e&&(t=t.substr(0,t.length-1),117!==ut.charCodeAt(ct)&&yn({},Ft,Gt),++ct,(e=nn("u"))&&"\\"!==e&&$t(e.charCodeAt(0))||yn({},Ft,Gt),t+=e);return t}function on(){var e,t;return e=ct,{type:1===(t=92===ut.charCodeAt(ct)?an():function(){var e,t;for(e=ct++;ct<ft;){if(92===(t=ut.charCodeAt(ct)))return ct=e,an();if(!$t(t))break;++ct}return ut.slice(e,ct)}()).length?ht:en.hasOwnProperty(t)?vt:"null"===t?yt:"true"===t||"false"===t?gt:ht,value:t,start:e,end:ct}}function sn(){var e,t,n,r,i=ct,a=ut.charCodeAt(ct),o=ut[ct];switch(a){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++ct,{type:St,value:String.fromCharCode(a),start:i,end:ct};default:if(61===(e=ut.charCodeAt(ct+1)))switch(a){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return ct+=2,{type:St,value:String.fromCharCode(a)+String.fromCharCode(e),start:i,end:ct};case 33:case 61:return ct+=2,61===ut.charCodeAt(ct)&&++ct,{type:St,value:ut.slice(i,ct),start:i,end:ct}}}return">>>="===(r=ut.substr(ct,4))?{type:St,value:r,start:i,end:ct+=4}:">>>"===(n=r.substr(0,3))||"<<="===n||">>="===n?{type:St,value:n,start:i,end:ct+=3}:o===(t=n.substr(0,2))[1]&&0<="+-<>&|".indexOf(o)||"=>"===t?{type:St,value:t,start:i,end:ct+=2}:0<="<>=!+-*%&|^/".indexOf(o)?{type:St,value:o,start:i,end:++ct}:void yn({},Ft,Gt)}function ln(){var e,t,n;if(Vt(Xt((n=ut[ct]).charCodeAt(0))||"."===n,"Numeric literal must start with a decimal digit or a decimal point"),t=ct,e="","."!==n){if(e=ut[ct++],n=ut[ct],"0"===e){if("x"===n||"X"===n)return++ct,function(e){for(var t="";ct<ft&&Kt(ut[ct]);)t+=ut[ct++];return 0===t.length&&yn({},Ft,Gt),Zt(ut.charCodeAt(ct))&&yn({},Ft,Gt),{type:_t,value:parseInt("0x"+t,16),start:e,end:ct}}(t);if(Qt(n))return function(e){for(var t="0"+ut[ct++];ct<ft&&Qt(ut[ct]);)t+=ut[ct++];return(Zt(ut.charCodeAt(ct))||Xt(ut.charCodeAt(ct)))&&yn({},Ft,Gt),{type:_t,value:parseInt(t,8),octal:!0,start:e,end:ct}}(t);n&&Xt(n.charCodeAt(0))&&yn({},Ft,Gt)}for(;Xt(ut.charCodeAt(ct));)e+=ut[ct++];n=ut[ct]}if("."===n){for(e+=ut[ct++];Xt(ut.charCodeAt(ct));)e+=ut[ct++];n=ut[ct]}if("e"===n||"E"===n)if(e+=ut[ct++],"+"!==(n=ut[ct])&&"-"!==n||(e+=ut[ct++]),Xt(ut.charCodeAt(ct)))for(;Xt(ut.charCodeAt(ct));)e+=ut[ct++];else yn({},Ft,Gt);return Zt(ut.charCodeAt(ct))&&yn({},Ft,Gt),{type:_t,value:parseFloat(e),start:t,end:ct}}function un(){var e,t,n,r;return dt=null,tn(),e=ct,t=function(){var e,t,n,r;for(Vt("/"===(e=ut[ct]),"Regular expression literal must start with a slash"),t=ut[ct++],r=n=!1;ct<ft;)if(t+=e=ut[ct++],"\\"===e)Jt((e=ut[ct++]).charCodeAt(0))&&yn({},zt),t+=e;else if(Jt(e.charCodeAt(0)))yn({},zt);else if(n)"]"===e&&(n=!1);else{if("/"===e){r=!0;break}"["===e&&(n=!0)}return r||yn({},zt),{value:t.substr(1,t.length-2),literal:t}}(),n=function(){var e,t,n;for(n=t="";ct<ft&&$t((e=ut[ct]).charCodeAt(0));)++ct,"\\"===e&&ct<ft?yn({},Ft,Gt):(n+=e,t+=e);return 0<=n.search(/[^gimuy]/g)&&yn({},jt,n),{value:n,literal:t}}(),r=function(e,t){var n=e;0<=t.indexOf("u")&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,function(e,t){if(parseInt(t,16)<=1114111)return"x";yn({},jt)}).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{return new RegExp(e,t)}catch(e){return null}}(t.value,n.value),{literal:t.literal+n.literal,value:r,regex:{pattern:t.value,flags:n.value},start:e,end:ct}}function cn(){var e;return tn(),ft<=ct?{type:mt,start:ct,end:ct}:Zt(e=ut.charCodeAt(ct))?on():40===e||41===e||59===e?sn():39===e||34===e?function(){var e,t,n,r,i="",a=!1;for(Vt("'"===(e=ut[ct])||'"'===e,"String literal must starts with a quote"),t=ct,++ct;ct<ft;){if((n=ut[ct++])===e){e="";break}if("\\"===n)if((n=ut[ct++])&&Jt(n.charCodeAt(0)))"\r"===n&&"\n"===ut[ct]&&++ct;else switch(n){case"u":case"x":"{"===ut[ct]?(++ct,i+=rn()):i+=nn(n);break;case"n":i+="\n";break;case"r":i+="\r";break;case"t":i+="\t";break;case"b":i+="\b";break;case"f":i+="\f";break;case"v":i+="\v";break;default:Qt(n)?(0!==(r="01234567".indexOf(n))&&(a=!0),ct<ft&&Qt(ut[ct])&&(a=!0,r=8*r+"01234567".indexOf(ut[ct++]),0<="0123".indexOf(n)&&ct<ft&&Qt(ut[ct])&&(r=8*r+"01234567".indexOf(ut[ct++]))),i+=String.fromCharCode(r)):i+=n}else{if(Jt(n.charCodeAt(0)))break;i+=n}}return""!==e&&yn({},Ft,Gt),{type:bt,value:i,octal:a,start:t,end:ct}}():46===e?Xt(ut.charCodeAt(ct+1))?ln():sn():Xt(e)?ln():sn()}function fn(){var e;return ct=(e=dt).end,dt=cn(),ct=e.end,e}function dn(){var e;e=ct,dt=cn(),ct=e}function pn(e,t,n){var r=new pt("||"===e||"&&"===e?Ct:Nt);return r.operator=e,r.left=t,r.right=n,r}function gn(e){var t=new pt(xt);return t.name=e,t}function mn(e){var t=new pt(At);return t.value=e.value,t.raw=ut.slice(e.start,e.end),e.regex&&("//"===t.raw&&(t.raw="/(?:)/"),t.regex=e.regex),t}function hn(e,t,n){var r=new pt(Dt);return r.computed="["===e,r.object=t,r.property=n,r.computed||(n.member=!0),r}function vn(e,t,n){var r=new pt(Pt);return r.key=t,r.value=n,r.kind=e,r}function yn(e,t){var n,r=Array.prototype.slice.call(arguments,2),i=t.replace(/%(\d)/g,function(e,t){return Vt(t<r.length,"Message reference must be in range"),r[t]});throw(n=new Error(i)).index=ct,n.description=i,n}function _n(e){e.type===mt&&yn(e,Ut),e.type===_t&&yn(e,Rt),e.type===bt&&yn(e,It),e.type===ht&&yn(e,Lt),e.type===vt&&yn(e,Mt),yn(e,Ft,e.value)}function Sn(e){var t=fn();t.type===St&&t.value===e||_n(t)}function bn(e){return dt.type===St&&dt.value===e}function En(e){return dt.type===vt&&dt.value===e}function Nn(){var e,t,n=[];for(ct=dt.start,Sn("[");!bn("]");)bn(",")?(fn(),n.push(null)):(n.push(Fn()),bn("]")||Sn(","));return fn(),e=n,(t=new pt(Et)).elements=e,t}function On(){var e;return ct=dt.start,(e=fn()).type===bt||e.type===_t?(e.octal&&yn(e,Bt),mn(e)):gn(e.value)}function Tn(){var e,t,n,r,i,a,o,s=[],l={},u=String;for(ct=dt.start,Sn("{");!bn("}");)i=r=n=void 0,ct=dt.start,t="$"+((e=(n=dt).type===ht?(i=On(),Sn(":"),vn("init",i,Fn())):n.type!==mt&&n.type!==St?(r=On(),Sn(":"),vn("init",r,Fn())):void _n(n)).key.type===xt?e.key.name:u(e.key.value)),Object.prototype.hasOwnProperty.call(l,t)?yn({},Ht):l[t]=!0,s.push(e),bn("}")||Sn(",");return Sn("}"),a=s,(o=new pt(kt)).properties=a,o}var xn={if:1,this:1};function An(){var e,t,n,r;if(bn("("))return Sn("("),r=Rn(),Sn(")"),r;if(bn("["))return Nn();if(bn("{"))return Tn();if(e=dt.type,ct=dt.start,e===ht||xn[dt.value])n=gn(fn().value);else if(e===bt||e===_t)dt.octal&&yn(dt,Bt),n=mn(fn());else{if(e===vt)throw new Error(qt);e===gt?((t=fn()).value="true"===t.value,n=mn(t)):e===yt?((t=fn()).value=null,n=mn(t)):bn("/")||bn("/=")?(n=mn(un()),dn()):_n(fn())}return n}function Cn(){var e=[];if(Sn("("),!bn(")"))for(;ct<ft&&(e.push(Fn()),!bn(")"));)Sn(",");return Sn(")"),e}function Dn(){var e,t;return ct=dt.start,e=fn(),(t=e).type!==ht&&t.type!==vt&&t.type!==gt&&t.type!==yt&&_n(e),gn(e.value)}function kn(){var e=function(){var e,t,n,r,i,a;for(e=An();;)if(bn("."))Sn("."),e=hn(".",e,Dn());else if(bn("("))t=Cn(),r=e,i=t,a=void 0,(a=new pt(Ot)).callee=r,a.arguments=i,e=a;else{if(!bn("["))break;n=void 0,Sn("["),n=Rn(),Sn("]"),e=hn("[",e,n)}return e}();if(dt.type===St&&(bn("++")||bn("--")))throw new Error(qt);return e}function Pn(){var e,t,n,r,i;if(dt.type!==St&&dt.type!==vt)t=kn();else{if(bn("++")||bn("--"))throw new Error(qt);if(bn("+")||bn("-")||bn("~")||bn("!"))e=fn(),t=Pn(),n=e.value,r=t,(i=new pt(wt)).operator=n,i.argument=r,i.prefix=!0,t=i;else{if(En("delete")||En("void")||En("typeof"))throw new Error(qt);t=kn()}}return t}function wn(e){var t=0;if(e.type!==St&&e.type!==vt)return 0;switch(e.value){case"||":t=1;break;case"&&":t=2;break;case"|":t=3;break;case"^":t=4;break;case"&":t=5;break;case"==":case"!=":case"===":case"!==":t=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":t=7;break;case"<<":case">>":case">>>":t=8;break;case"+":case"-":t=9;break;case"*":case"/":case"%":t=11}return t}function Fn(){var e,t,n,r,i,a,o;return e=function(){var e,t,n,r,i,a,o,s,l,u;if(e=dt,l=Pn(),0===(i=wn(r=dt)))return l;for(r.prec=i,fn(),t=[e,dt],a=[l,r,o=Pn()];0<(i=wn(dt));){for(;2<a.length&&i<=a[a.length-2].prec;)o=a.pop(),s=a.pop().value,l=a.pop(),t.pop(),n=pn(s,l,o),a.push(n);(r=fn()).prec=i,a.push(r),t.push(dt),n=Pn(),a.push(n)}for(n=a[u=a.length-1],t.pop();1<u;)t.pop(),n=pn(a[u-1].value,a[u-2],n),u-=2;return n}(),bn("?")&&(fn(),t=Fn(),Sn(":"),n=Fn(),r=e,i=t,a=n,(o=new pt(Tt)).test=r,o.consequent=i,o.alternate=a,e=o),e}function Rn(){var e=Fn();if(bn(","))throw new Error(qt);return e}var In={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function Ln(u){function e(o,s,l){return function(e){return t=o,r=s,i=l,a=u((n=e)[0]),r&&(a=r+"("+a+")",0===r.lastIndexOf("new ",0)&&(a="("+a+")")),a+"."+t+(i<0?"":0===i?"()":"("+n.slice(1).map(u).join(",")+")");var t,n,r,i,a}}var t="new Date",n="String";return{isNaN:"isNaN",isFinite:"isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(e){e.length<3&&g("Missing arguments to clamp function."),3<e.length&&g("Too many arguments to clamp function.");var t=e.map(u);return"Math.max("+t[1]+", Math.min("+t[2]+","+t[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:t,date:e("getDate",t,0),day:e("getDay",t,0),year:e("getFullYear",t,0),month:e("getMonth",t,0),hours:e("getHours",t,0),minutes:e("getMinutes",t,0),seconds:e("getSeconds",t,0),milliseconds:e("getMilliseconds",t,0),time:e("getTime",t,0),timezoneoffset:e("getTimezoneOffset",t,0),utcdate:e("getUTCDate",t,0),utcday:e("getUTCDay",t,0),utcyear:e("getUTCFullYear",t,0),utcmonth:e("getUTCMonth",t,0),utchours:e("getUTCHours",t,0),utcminutes:e("getUTCMinutes",t,0),utcseconds:e("getUTCSeconds",t,0),utcmilliseconds:e("getUTCMilliseconds",t,0),length:e("length",null,-1),indexof:e("indexOf",null),lastindexof:e("lastIndexOf",null),slice:e("slice",null),parseFloat:"parseFloat",parseInt:"parseInt",upper:e("toUpperCase",n,0),lower:e("toLowerCase",n,0),substring:e("substring",n),replace:e("replace",n),regexp:"RegExp",test:e("test","RegExp"),if:function(e){e.length<3&&g("Missing arguments to if function."),3<e.length&&g("Too many arguments to if function.");var t=e.map(u);return"("+t[0]+"?"+t[1]+":"+t[2]+")"}}}var Mn=Object.freeze({ASTNode:pt,parse:function(e){ct=0,ft=(ut=e).length,dt=null,dn();var t=Rn();if(dt.type!==mt)throw new Error("Unexpect token after expression.");return t},codegen:function(e){var n=(e=e||{}).whitelist?j(e.whitelist):{},r=e.blacklist?j(e.blacklist):{},i=e.constants||In,a=(e.functions||Ln)(f),t=e.globalvar,o=e.fieldvar,s={},l={},u=0,c=F(t)?t:function(e){return t+'["'+e+'"]'};function f(e){if(m(e))return e;var t=d[e.type];return null==t&&g("Unsupported type: "+e.type),t(e)}var d={Literal:function(e){return e.raw},Identifier:function(e){var t=e.name;return 0<u?t:r.hasOwnProperty(t)?g("Illegal identifier: "+t):i.hasOwnProperty(t)?i[t]:n.hasOwnProperty(t)?t:(s[t]=1,c(t))},MemberExpression:function(e){var t=!e.computed,n=f(e.object);t&&(u+=1);var r=f(e.property);return n===o&&(l[r]=1),t&&(u-=1),n+(t?"."+r:"["+r+"]")},CallExpression:function(e){"Identifier"!==e.callee.type&&g("Illegal callee type: "+e.callee.type);var t=e.callee.name,n=e.arguments,r=a.hasOwnProperty(t)&&a[t];return r||g("Unrecognized function: "+t),F(r)?r(n):r+"("+n.map(f).join(",")+")"},ArrayExpression:function(e){return"["+e.elements.map(f).join(",")+"]"},BinaryExpression:function(e){return"("+f(e.left)+e.operator+f(e.right)+")"},UnaryExpression:function(e){return"("+e.operator+f(e.argument)+")"},ConditionalExpression:function(e){return"("+f(e.test)+"?"+f(e.consequent)+":"+f(e.alternate)+")"},LogicalExpression:function(e){return"("+f(e.left)+e.operator+f(e.right)+")"},ObjectExpression:function(e){return"{"+e.properties.map(f).join(",")+"}"},Property:function(e){u+=1;var t=f(e.key);return u-=1,t+":"+f(e.value)}};function p(e){var t={code:f(e),globals:Object.keys(s),fields:Object.keys(l)};return s={},l={},t}return p.functions=a,p.constants=i,p},functions:Ln,constants:In}),Un=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.getDependentFields=function(e){var t=Mn.parse(e),n={};return t.visit(function(e){"MemberExpression"===e.type&&function e(t){return"MemberExpression"===t.object.type?e(t.object):"datum"===t.object.name}(e)&&(n[function e(t){var n=[];return"Identifier"===t.type?[t.name]:"Literal"===t.type?[t.value]:("MemberExpression"===t.type&&(n=(n=n.concat(e(t.object))).concat(e(t.property))),n)}(e).slice(1).join(".")]=!0)}),n}});t(Un);Un.getDependentFields;var jn=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(r){function s(e,t){var n=r.call(this,e)||this;return n.transform=t,n._dependentFields=Un.getDependentFields(n.transform.calculate),n}return ae.__extends(s,r),s.prototype.clone=function(){return new s(null,ue.duplicate(this.transform))},s.parseAllForSortIndex=function(o,e){return e.forEachFieldDef(function(e,t){if(ve.isScaleFieldDef(e)&&rt.isSortArray(e.sort)){var n=e.field,r=e.timeUnit,i=e.sort,a=i.map(function(e,t){return Ar.fieldFilterExpression({field:n,timeUnit:r,equal:e})+" ? "+t+" : "}).join("")+i.length;o=new s(o,{calculate:a,as:l(e,t,{forAs:!0})})}}),o},s.prototype.producedFields=function(){var e={};return e[this.transform.as]=!0,e},s.prototype.dependentFields=function(){return this._dependentFields},s.prototype.assemble=function(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}},s.prototype.hash=function(){return"Calculate "+ue.hash(this.transform)},s}(st.TransformNode);function l(e,t,n){return ve.vgField(e,ae.__assign({prefix:t,suffix:"sort_index"},n||{}))}t.CalculateNode=n,t.sortArrayIndexField=l});t(jn);jn.CalculateNode,jn.sortArrayIndexField;var zn=n(function(e,c){function S(e){return((e=(e%360+360)%360)+90)%180==0?{}:e<90||270<e?{align:{value:"right"}}:135<=e&&e<225?{align:{value:"left"}}:{}}function b(e){return 45<=(e=(e%360+360)%360)&&e<=135?{baseline:"top"}:{baseline:"middle"}}function f(e,t,n,r,i){var a,o,s,l;if(i){var u=null,c=r.facetFieldDef;if(c&&i.labels){var f=c.header,d=void 0===f?{}:f,p=d.format,g=d.labelAngle,m=e.config?e.config:void 0,h=ae.__assign({},S(g));u=ae.__assign({text:ot.formatSignalRef(c,p,"parent",e.config),offset:10},"row"===t?{orient:"left"}:{},{style:"guide-label"},void 0!==g?{angle:g}:{},b(g),E(m,c,nt.HEADER_LABEL_PROPERTIES,nt.HEADER_LABEL_PROPERTIES_MAP),0<ue.keys(h).length?{encode:{update:h}}:{})}var v=i.axes,y=v&&0<v.length;if(u||y){var _="row"===t?"height":"width";return ae.__assign({name:e.getName(t+"_"+n),type:"group",role:t+"-"+n},r.facetFieldDef?{from:{data:e.getName(t+"_domain")},sort:(o=c,s=t,l=o.sort,rt.isSortField(l)?{field:ve.vgField(l,{expr:"datum"}),order:l.order||"ascending"}:oe.isArray(l)?{field:jn.sortArrayIndexField(o,s,{expr:"datum"}),order:"ascending"}:{field:ve.vgField(o,{expr:"datum"}),order:l||"ascending"})}:{},u?{title:u}:{},i.sizeSignal?{encode:{update:(a={},a[_]=i.sizeSignal,a)}}:{},y?{axes:v}:{})}}return null}function E(e,t,n,r){for(var i={},a=0,o=n;a<o.length;a++){var s=o[a];e&&e.header&&e.header[s]&&(i[r[s]]=e.header[s]),t&&t.header&&t.header[s]&&(i[r[s]]=t.header[s])}return i}Object.defineProperty(c,"__esModule",{value:!0}),c.HEADER_CHANNELS=["row","column"],c.HEADER_TYPES=["header","footer"],c.getHeaderType=function(e){return"top"===e||"left"===e?"header":"footer"},c.getTitleGroup=function(e,t){var n=e.component.layoutHeaders[t].title,r=e.config?e.config:void 0,i=e.component.layoutHeaders[t].facetFieldDef?e.component.layoutHeaders[t].facetFieldDef:void 0;return{name:t+"-title",type:"group",role:t+"-title",title:ae.__assign({text:n,offset:10},"row"===t?{orient:"left"}:{},{style:"guide-title"},E(r,i,nt.HEADER_TITLE_PROPERTIES,nt.HEADER_TITLE_PROPERTIES_MAP))}},c.getHeaderGroups=function(e,t){for(var n=e.component.layoutHeaders[t],r=[],i=0,a=c.HEADER_TYPES;i<a.length;i++){var o=a[i];if(n[o])for(var s=0,l=n[o];s<l.length;s++){var u=l[s];r.push(f(e,t,o,n,u))}}return r},c.labelAlign=S,c.labelBaseline=b,c.getHeaderGroup=f,c.getHeaderProperties=E});t(zn);zn.HEADER_CHANNELS,zn.HEADER_TYPES,zn.getHeaderType,zn.getTitleGroup,zn.getHeaderGroups,zn.labelAlign,zn.labelBaseline,zn.getHeaderGroup,zn.getHeaderProperties;var Bn=n(function(e,t){function n(e,t){var n="width"===t?"x":"y",r=e.component.layoutSize.get(t);if(!r||"merged"===r)return[];var i=e.getSizeSignalRef(t).signal;if("range-step"===r){var a=e.getScaleComponent(n);if(a){var o=a.get("type"),s=a.get("range");if(De.hasDiscreteDomain(o)&&et.isVgRangeStep(s)){var l=e.scaleName(n);if(gr.isFacetModel(e.parent))if("independent"===e.parent.component.resolve.scale[n])return[u(l,s)];return[u(l,s),{name:i,update:c(l,a,"domain('"+l+"').length")}]}}throw new Error("layout size is range step although there is no rangeStep.")}return[{name:i,value:r}]}function u(e,t){return{name:e+"_step",value:t.step}}function c(e,t,n){var r=t.get("type"),i=t.get("padding"),a=ue.getFirstDefined(t.get("paddingOuter"),i),o=t.get("paddingInner");return"bandspace("+n+", "+(o="band"===r?void 0!==o?o:i:1)+", "+a+") * "+e+"_step"}Object.defineProperty(t,"__esModule",{value:!0}),t.assembleLayoutSignals=function(e){return[].concat(n(e,"width"),n(e,"height"))},t.sizeSignals=n,t.sizeExpr=c});t(Bn);Bn.assembleLayoutSignals,Bn.sizeSignals,Bn.sizeExpr;var Hn=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=ae.__importStar(de);t.defaultScaleResolve=function(e,t){if(gr.isLayerModel(t)||gr.isFacetModel(t))return"shared";if(gr.isConcatModel(t)||gr.isRepeatModel(t))return ue.contains(_e.POSITION_SCALE_CHANNELS,e)?"independent":"shared";throw new Error("invalid model type for resolve")},t.parseGuideResolve=function(e,t){var n=e.scale[t],r=ue.contains(_e.POSITION_SCALE_CHANNELS,t)?"axis":"legend";return"independent"===n?("shared"===e[r][t]&&i.warn(i.message.independentScaleMeansIndependentGuide(t)),"independent"):e[r][t]||"shared"}});t(Hn);Hn.defaultScaleResolve,Hn.parseGuideResolve;var Gn=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var i=ae.__importStar(de),n=function(){function e(e,t){void 0===e&&(e={}),void 0===t&&(t={}),this.explicit=e,this.implicit=t}return e.prototype.clone=function(){return new e(ue.duplicate(this.explicit),ue.duplicate(this.implicit))},e.prototype.combine=function(){return ae.__assign({},this.explicit,this.implicit)},e.prototype.get=function(e){return ue.getFirstDefined(this.explicit[e],this.implicit[e])},e.prototype.getWithExplicit=function(e){return void 0!==this.explicit[e]?{explicit:!0,value:this.explicit[e]}:void 0!==this.implicit[e]?{explicit:!1,value:this.implicit[e]}:{explicit:!1,value:void 0}},e.prototype.setWithExplicit=function(e,t){void 0!==t.value&&this.set(e,t.value,t.explicit)},e.prototype.set=function(e,t,n){return delete this[n?"implicit":"explicit"][e],this[n?"explicit":"implicit"][e]=t,this},e.prototype.copyKeyFromSplit=function(e,t){void 0!==t.explicit[e]?this.set(e,t.explicit[e],!0):void 0!==t.implicit[e]&&this.set(e,t.implicit[e],!1)},e.prototype.copyKeyFromObject=function(e,t){void 0!==t[e]&&this.set(e,t[e],!0)},e.prototype.copyAll=function(e){for(var t=0,n=ue.keys(e.combine());t<n.length;t++){var r=n[t],i=e.getWithExplicit(r);this.setWithExplicit(r,i)}},e}();function o(e,t,n,r){return e.explicit&&t.explicit&&i.warn(i.message.mergeConflictingProperty(n,r,e.value,t.value)),e}t.Split=n,t.makeExplicit=function(e){return{explicit:!0,value:e}},t.makeImplicit=function(e){return{explicit:!1,value:e}},t.tieBreakByComparing=function(a){return function(e,t,n,r){var i=a(e.value,t.value);return 0<i?e:i<0?t:o(e,t,n,r)}},t.defaultTieBreaker=o,t.mergeValuesWithExplicit=function(e,t,n,r,i){return void 0===i&&(i=o),void 0===e||void 0===e.value?t:e.explicit&&!t.explicit?e:t.explicit&&!e.explicit?t:ue.stringify(e.value)===ue.stringify(t.value)?e:i(e,t,n,r)}});t(Gn);Gn.Split,Gn.makeExplicit,Gn.makeImplicit,Gn.tieBreakByComparing,Gn.defaultTieBreaker,Gn.mergeValuesWithExplicit;var qn=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ae.__extends(t,e),t}(Gn.Split);t.LegendComponent=n});t(qn);qn.LegendComponent;var Wn=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var p=ae.__importStar(at);function g(e){return n(e,function(e,t){return Math.max(e,t.value)})}function m(e){return n(e,function(e,t){return ue.getFirstDefined(e,t.value)})}function n(e,t){return ve.hasConditionalValueDef(e)?(oe.isArray(e.condition)?e.condition:[e.condition]).reduce(t,e.value):ve.isValueDef(e)?e.value:void 0}t.symbols=function(e,t,n,r,i){if("gradient"!==i.get("type")){var a=ae.__assign({},ot.applyMarkConfig({},n,ye.FILL_STROKE_CONFIG),p.color(n));switch(n.mark){case ye.BAR:case ye.TICK:case ye.TEXT:a.shape={value:"square"};break;case ye.CIRCLE:case ye.SQUARE:a.shape={value:n.mark};break;case ye.POINT:case ye.LINE:case ye.GEOSHAPE:case ye.AREA:}var o=n.markDef,s=n.encoding,l=o.filled,u=g(s.opacity)||o.opacity;if(a.fill)if("fill"===r||l&&r===_e.COLOR)delete a.fill;else if(a.fill.field)i.get("symbolFillColor")?delete a.fill:(a.fill={value:"black"},a.fillOpacity={value:u||1});else if(oe.isArray(a.fill)){var c=m(s.fill||s.color)||o.fill||l&&o.color;c&&(a.fill={value:c})}if(a.stroke)if("stroke"===r||!l&&r===_e.COLOR)delete a.stroke;else if(a.stroke.field)delete a.stroke;else if(oe.isArray(a.stroke)){var f=ue.getFirstDefined(m(s.stroke||s.color),o.stroke,l?o.color:void 0);f&&(a.stroke={value:f})}if(a.fill&&"transparent"!==a.fill.value&&!a.stroke&&(a.stroke={value:"transparent"}),r!==_e.SHAPE){var d=m(s.shape)||o.shape;d&&(a.shape={value:d})}return r!==_e.OPACITY&&u&&(a.opacity={value:u}),a=ae.__assign({},a,t),0<ue.keys(a).length?a:void 0}},t.gradient=function(e,t,n,r,i){var a={};if("gradient"===i.get("type")){var o=g(n.encoding.opacity)||n.markDef.opacity;o&&(a.opacity={value:o})}return a=ae.__assign({},a,t),0<ue.keys(a).length?a:void 0},t.labels=function(e,t,n,r,i){var a=n.legend(r),o=n.config,s={};if(ve.isTimeFieldDef(e)){var l=n.getScaleComponent(r).get("type")===De.ScaleType.UTC,u=ot.timeFormatExpression("datum.value",e.timeUnit,a.format,o.legend.shortTimeLabels,o.timeFormat,l);t=ae.__assign({},u?{text:{signal:u}}:{},t)}return s=ae.__assign({},s,t),0<ue.keys(s).length?s:void 0}});t(Wn);Wn.symbols,Wn.gradient,Wn.labels;var Yn=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.values=function(e,t){var n=e.values;if(n)return ve.valueArray(t,n)},t.clipHeight=function(e){if(De.hasContinuousDomain(e))return 20},t.labelOverlap=function(e){if(ue.contains(["quantile","threshold","log"],e))return"greedy"}});t(Yn);Yn.values,Yn.clipHeight,Yn.labelOverlap;var Vn=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var d=ae.__importStar(Wn),a=ae.__importStar(Yn);function l(e){var r,i;gr.isUnitModel(e)?e.component.legends=(i=(r=e).encoding,[_e.COLOR,_e.FILL,_e.STROKE,_e.SIZE,_e.SHAPE,_e.OPACITY].reduce(function(e,t){var n=i[t];return!r.legend(t)||!r.getScaleComponent(t)||ve.isFieldDef(n)&&t===_e.SHAPE&&n.type===he.GEOJSON||(e[t]=o(r,t)),e},{})):e.component.legends=function(i){for(var e=i.component,n=e.legends,a=e.resolve,t=function(t){l(t),ue.keys(t.component.legends).forEach(function(e){a.legend[e]=Hn.parseGuideResolve(i.component.resolve,e),"shared"===a.legend[e]&&(n[e]=u(n[e],t.component.legends[e]),n[e]||(a.legend[e]="independent",delete n[e]))})},r=0,o=i.children;r<o.length;r++){var s=o[r];t(s)}return ue.keys(n).forEach(function(e){for(var t=0,n=i.children;t<n.length;t++){var r=n[t];r.component.legends[e]&&"shared"===a.legend[e]&&delete r.component.legends[e]}}),n}(e)}function p(e,t,n,r){switch(t){case"values":return!!n.values;case"title":if("title"===t&&e===r.title)return!0}return e===n[t]}function o(i,a){for(var o=i.fieldDef(a),e=i.legend(a),s=new qn.LegendComponent({},function(e,t){var n;switch(t){case _e.COLOR:var r=e.scaleName(_e.COLOR);return e.markDef.filled?{fill:r}:{stroke:r};case _e.FILL:case _e.STROKE:case _e.SIZE:case _e.SHAPE:case _e.OPACITY:return(n={})[t]=e.scaleName(t),n}}(i,a)),t=0,n=Ce.LEGEND_PROPERTIES;t<n.length;t++){var r=n[t],l=g(r,e,a,i);if(void 0!==l){var u=p(l,r,e,o);(u||void 0===i.config.legend[r])&&s.set(r,l,u)}}var c=e.encoding||{},f=["labels","legend","title","symbols","gradient"].reduce(function(e,t){var n=ot.guideEncodeEntry(c[t]||{},i),r=d[t]?d[t](o,n,i,a,s):n;return void 0!==r&&0<ue.keys(r).length&&(e[t]={update:r}),e},{});return 0<ue.keys(f).length&&s.set("encode",f,!!e.encoding),s}function g(e,t,n,r){var i=r.fieldDef(n);switch(e){case"format":return ot.numberFormat(i,t.format,r.config);case"title":return ve.title(i,r.config,{allowDisabling:!0})||void 0;case"labelOverlap":return ue.getFirstDefined(t.labelOverlap,a.labelOverlap(r.getScaleComponent(n).get("type")));case"values":return a.values(t,i)}return t[e]}function u(t,r){if(!t)return r.clone();var e=t.getWithExplicit("orient"),n=r.getWithExplicit("orient");if(!e.explicit||!n.explicit||e.value===n.value){for(var i=!1,a=function(n){var e=Gn.mergeValuesWithExplicit(t.getWithExplicit(n),r.getWithExplicit(n),n,"legend",function(e,t){switch(n){case"title":return ot.mergeTitleComponent(e,t);case"type":return i=!0,Gn.makeImplicit("symbol")}return Gn.defaultTieBreaker(e,t,n,"legend")});t.setWithExplicit(n,e)},o=0,s=Ce.VG_LEGEND_PROPERTIES;o<s.length;o++){a(s[o])}return i&&(((t.implicit||{}).encode||{}).gradient&&ue.deleteNestedProperty(t.implicit,["encode","gradient"]),((t.explicit||{}).encode||{}).gradient&&ue.deleteNestedProperty(t.explicit,["encode","gradient"])),t}}t.parseLegend=l,t.parseLegendForChannel=o,t.mergeLegendComponent=u});t(Vn);Vn.parseLegend,Vn.parseLegendForChannel,Vn.mergeLegendComponent;var Xn=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.assembleLegends=function(e){for(var t=e.component.legends,n={},r=0,i=ue.keys(t);r<i.length;r++){var a=i[r],o=e.getScaleComponent(a),s=ue.stringify(o.domains);if(n[s])for(var l=0,u=n[s];l<u.length;l++){var c=u[l];Vn.mergeLegendComponent(c,t[a])||n[s].push(t[a])}else n[s]=[t[a].clone()]}return ue.flatten(ue.vals(n)).map(function(e){return e.combine()})}});t(Xn);Xn.assembleLegends;var Kn=n(function(e,t){function n(e){return e.children.reduce(function(e,t){return e.concat(t.assembleProjections())},r(e))}function r(r){var e=r.component.projection;if(!e||e.merged)return[];var t=e.combine(),n=t.name,i=ae.__rest(t,["name"]),a={signal:"["+e.size.map(function(e){return e.signal}).join(", ")+"]"},o=e.data.reduce(function(e,t){var n=et.isSignalRef(t)?t.signal:"data('"+r.lookupDataSource(t)+"')";return ue.contains(e,n)||e.push(n),e},[]);if(o.length<=0)throw new Error("Projection's fit didn't find any data sources");return[ae.__assign({name:n,size:a,fit:{signal:1<o.length?"["+o.join(", ")+"]":o[0]}},i)]}Object.defineProperty(t,"__esModule",{value:!0}),t.assembleProjections=function(e){return gr.isLayerModel(e)||gr.isConcatModel(e)||gr.isRepeatModel(e)?n(e):r(e)},t.assembleProjectionsForModelAndChildren=n,t.assembleProjectionForModel=r});t(Kn);Kn.assembleProjections,Kn.assembleProjectionsForModelAndChildren,Kn.assembleProjectionForModel;var Qn=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.PROJECTION_PROPERTIES=["type","clipAngle","clipExtent","center","rotate","precision","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"]});t(Qn);Qn.PROJECTION_PROPERTIES;var Jn=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(a){function e(e,t,n,r){var i=a.call(this,ae.__assign({},t),{name:e})||this;return i.specifiedProjection=t,i.size=n,i.data=r,i.merged=!1,i}return ae.__extends(e,a),e}(Gn.Split);t.ProjectionComponent=n});t(Jn);Jn.ProjectionComponent;var Zn=n(function(e,t){function a(e){gr.isUnitModel(e)?e.component.projection=function(t){var e=t.specifiedProjection,n=t.config;if(t.hasProjection){var r=[];return[[_e.LONGITUDE,_e.LATITUDE],[_e.LONGITUDE2,_e.LATITUDE2]].forEach(function(e){(t.channelHasField(e[0])||t.channelHasField(e[1]))&&r.push({signal:t.getName("geojson_"+r.length)})}),t.channelHasField(_e.SHAPE)&&t.fieldDef(_e.SHAPE).type===he.GEOJSON&&r.push({signal:t.getName("geojson_"+r.length)}),0===r.length&&r.push(t.requestDataName(Me.MAIN)),new Jn.ProjectionComponent(t.projectionName(!0),ae.__assign({},n.projection||{},e||{}),[t.getSizeSignalRef("width"),t.getSizeSignalRef("height")],r)}return}(e):e.component.projection=function(e){if(0===e.children.length)return;var r,t=ue.every(e.children,function(e){a(e);var t=e.component.projection;if(t){if(r){var n=function(t,n){var e=ue.every(Qn.PROJECTION_PROPERTIES,function(e){return!t.explicit.hasOwnProperty(e)&&!n.explicit.hasOwnProperty(e)||!(!t.explicit.hasOwnProperty(e)||!n.explicit.hasOwnProperty(e)||ue.stringify(t.get(e))!==ue.stringify(n.get(e)))});if(ue.stringify(t.size)===ue.stringify(n.size)){if(e)return t;if(ue.stringify(t.explicit)===ue.stringify({}))return n;if(ue.stringify(n.explicit)===ue.stringify({}))return t}return null}(r,t);return n&&(r=n),!!n}return r=t,!0}return!0});if(r&&t){var n=e.projectionName(!0),i=new Jn.ProjectionComponent(n,r.specifiedProjection,r.size,ue.duplicate(r.data));return e.children.forEach(function(e){e.component.projection&&(i.data=i.data.concat(e.component.projection.data),e.renameProjection(e.component.projection.get("name"),n),e.component.projection.merged=!0)}),i}return}(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.parseProjection=a});t(Zn);Zn.parseProjection;var $n=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=ae.__importStar(de);var r=function(i){function d(e,t,n){var r=i.call(this,e)||this;return r.dimensions=t,r.measures=n,r}return ae.__extends(d,i),d.prototype.clone=function(){return new d(null,ae.__assign({},this.dimensions),ue.duplicate(this.measures))},d.makeFromEncoding=function(e,s){var t=!1;s.forEachFieldDef(function(e){e.aggregate&&(t=!0)});var l={},u={};return t?(s.forEachFieldDef(function(e,t){var n,r,i,a=e.aggregate,o=e.field;a?"count"===a?(l["*"]=l["*"]||{},l["*"].count=ve.vgField(e,{forAs:!0})):(l[o]=l[o]||{},l[o][a]=ve.vgField(e,{forAs:!0}),_e.isScaleChannel(t)&&"unaggregated"===s.scaleDomain(t)&&(l[o].min=ve.vgField({field:o,aggregate:"min"},{forAs:!0}),l[o].max=ve.vgField({field:o,aggregate:"max"},{forAs:!0}))):(n=u,r=t,i=e,Se.isBinning(i.bin)?(n[ve.vgField(i,{})]=!0,n[ve.vgField(i,{binSuffix:"end"})]=!0,ot.binRequiresRange(i,r)&&(n[ve.vgField(i,{binSuffix:"range"})]=!0)):n[ve.vgField(i)]=!0)}),ue.keys(u).length+ue.keys(l).length===0?null:new d(e,u,l)):null},d.makeFromTransform=function(e,t){for(var n={},r={},i=0,a=t.aggregate;i<a.length;i++){var o=(f=a[i]).op,s=f.field,l=f.as;o&&("count"===o?(r["*"]=r["*"]||{},r["*"].count=l||ve.vgField(f,{forAs:!0})):(r[s]=r[s]||{},r[s][o]=l||ve.vgField(f,{forAs:!0})))}for(var u=0,c=t.groupby||[];u<c.length;u++){var f;n[f=c[u]]=!0}return ue.keys(n).length+ue.keys(r).length===0?null:new d(e,n,r)},d.prototype.merge=function(e){ue.differ(this.dimensions,e.dimensions)?n.debug("different dimensions, cannot merge"):(!function(e,t){for(var n in t)if(t.hasOwnProperty(n)){var r=t[n];for(var i in r)r.hasOwnProperty(i)&&(n in e?e[n][i]=r[i]:e[n]={op:r[i]})}}(this.measures,e.measures),e.remove())},d.prototype.addDimensions=function(e){var t=this;e.forEach(function(e){return t.dimensions[e]=!0})},d.prototype.dependentFields=function(){var t={};return ue.keys(this.dimensions).forEach(function(e){return t[e]=!0}),ue.keys(this.measures).forEach(function(e){return t[e]=!0}),t},d.prototype.producedFields=function(){for(var e={},t=0,n=ue.keys(this.measures);t<n.length;t++)for(var r=n[t],i=0,a=ue.keys(this.measures[r]);i<a.length;i++){var o=a[i];e[this.measures[r][o]||o+"_"+r]=!0}return e},d.prototype.hash=function(){return"Aggregate "+ue.hash({dimensions:this.dimensions,measures:this.measures})},d.prototype.assemble=function(){for(var e=[],t=[],n=[],r=0,i=ue.keys(this.measures);r<i.length;r++)for(var a=i[r],o=0,s=ue.keys(this.measures[a]);o<s.length;o++){var l=s[o];n.push(this.measures[a][l]),e.push(l),t.push(ue.replacePathInField(a))}return{type:"aggregate",groupby:ue.keys(this.dimensions),ops:e,fields:t,as:n}},d}(st.TransformNode);t.AggregateNode=r});t($n);$n.AggregateNode;var er=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var u=ae.__importStar(de),n=function(f){function e(e,t,n,r){var i=f.call(this,e)||this;i.model=t,i.name=n,i.data=r;for(var a=0,o=[_e.COLUMN,_e.ROW];a<o.length;a++){var s=o[a],l=t.facet[s];if(l){var u=l.bin,c=l.sort;i[s]=ae.__assign({name:t.getName(s+"_domain"),fields:[ve.vgField(l)].concat(Se.isBinning(u)?[ve.vgField(l,{binSuffix:"end"})]:[])},rt.isSortField(c)?{sortField:c}:oe.isArray(c)?{sortIndexField:jn.sortArrayIndexField(l,s)}:{})}}return i.childModel=t.child,i}return ae.__extends(e,f),Object.defineProperty(e.prototype,"fields",{get:function(){return(this.column&&this.column.fields||[]).concat(this.row&&this.row.fields||[])},enumerable:!0,configurable:!0}),e.prototype.getSource=function(){return this.name},e.prototype.getChildIndependentFieldsWithStep=function(){for(var e={},t=0,n=["x","y"];t<n.length;t++){var r=n[t],i=this.childModel.component.scales[r];if(i&&!i.merged){var a=i.get("type"),o=i.get("range");if(De.hasDiscreteDomain(a)&&et.isVgRangeStep(o)){var s=sr.assembleDomain(this.childModel,r),l=sr.getFieldFromDomain(s);l?e[r]=l:u.warn("Unknown field for ${channel}.  Cannot calculate view size.")}}}return e},e.prototype.assembleRowColumnData=function(e,t,n){var r="row"===e?"y":"x",i=[],a=[],o=[];n[r]&&(t?(i.push("distinct_"+n[r]),a.push("max")):(i.push(n[r]),a.push("distinct")),o.push("distinct_"+n[r]));var s=this[e],l=s.sortField,u=s.sortIndexField;if(l){var c=l.op,f=l.field;i.push(f),a.push(c),o.push(ve.vgField(l,{forAs:!0}))}else u&&(i.push(u),a.push("max"),o.push(u));return{name:this[e].name,source:t||this.data,transform:[ae.__assign({type:"aggregate",groupby:this[e].fields},i.length?{fields:i,ops:a,as:o}:{})]}},e.prototype.assemble=function(){var e=[],t=null,n=this.getChildIndependentFieldsWithStep();if(this.column&&this.row&&(n.x||n.y)){t="cross_"+this.column.name+"_"+this.row.name;var r=[].concat(n.x?[n.x]:[],n.y?[n.y]:[]),i=r.map(function(){return"distinct"});e.push({name:t,source:this.data,transform:[{type:"aggregate",groupby:this.column.fields.concat(this.row.fields),fields:r,ops:i}]})}for(var a=0,o=[_e.COLUMN,_e.ROW];a<o.length;a++){var s=o[a];this[s]&&e.push(this.assembleRowColumnData(s,t,n))}return e},e}(st.DataFlowNode);t.FacetNode=n});t(er);er.FacetNode;var tr=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var v=ae.__importStar(de);var n=function(r){function h(e,t){var n=r.call(this,e)||this;return n._parse=t,n}return ae.__extends(h,r),h.prototype.clone=function(){return new h(null,ue.duplicate(this._parse))},h.makeExplicit=function(e,t,n){var r={},i=t.data;return i&&i.format&&i.format.parse&&(r=i.format.parse),this.makeWithAncestors(e,r,{},n)},h.makeImplicitFromFilterTransform=function(e,t,n){var r={};return le.forEachLeaf(t.filter,function(e){if(Ar.isFieldPredicate(e)){var t=null;Ar.isFieldEqualPredicate(e)?t=e.equal:Ar.isFieldRangePredicate(e)?t=e.range[0]:Ar.isFieldOneOfPredicate(e)&&(t=(e.oneOf||e.in)[0]),t&&(pe.isDateTime(t)?r[e.field]="date":oe.isNumber(t)?r[e.field]="number":oe.isString(t)&&(r[e.field]="string")),e.timeUnit&&(r[e.field]="date")}}),0===ue.keys(r).length?null:this.makeWithAncestors(e,{},r,n)},h.makeImplicitFromEncoding=function(e,t,n){var r={};return(gr.isUnitModel(t)||gr.isFacetModel(t))&&t.forEachFieldDef(function(e){ve.isTimeFieldDef(e)?r[e.field]="date":ve.isNumberFieldDef(e)?ce.isCountingAggregateOp(e.aggregate)||(r[e.field]="number"):1<ue.accessPathDepth(e.field)?e.field in r||(r[e.field]="flatten"):ve.isScaleFieldDef(e)&&rt.isSortField(e.sort)&&1<ue.accessPathDepth(e.sort.field)&&(e.sort.field in r||(r[e.sort.field]="flatten"))}),this.makeWithAncestors(e,{},r,n)},h.makeWithAncestors=function(e,t,n,r){for(var i=0,a=ue.keys(n);i<a.length;i++){var o=a[i];void 0!==(u=r.getWithExplicit(o)).value&&(u.explicit||u.value===n[o]||"derived"===u.value||"flatten"===n[o]?delete n[o]:v.warn(v.message.differentParse(o,n[o],u.value)))}for(var s=0,l=ue.keys(t);s<l.length;s++){var u;o=l[s];void 0!==(u=r.get(o))&&(u===t[o]?delete t[o]:v.warn(v.message.differentParse(o,t[o],u)))}var c=new Gn.Split(t,n);r.copyAll(c);for(var f={},d=0,p=ue.keys(c.combine());d<p.length;d++){var g=p[d],m=c.get(g);null!==m&&(f[g]=m)}return 0===ue.keys(f).length||r.parseNothing?null:new h(e,f)},Object.defineProperty(h.prototype,"parse",{get:function(){return this._parse},enumerable:!0,configurable:!0}),h.prototype.merge=function(e){this._parse=ae.__assign({},this._parse,e.parse),e.remove()},h.prototype.assembleFormatParse=function(){for(var e={},t=0,n=ue.keys(this._parse);t<n.length;t++){var r=n[t],i=this._parse[r];1===ue.accessPathDepth(r)&&(e[r]=i)}return e},h.prototype.producedFields=function(){return oe.toSet(ue.keys(this._parse))},h.prototype.dependentFields=function(){return oe.toSet(ue.keys(this._parse))},h.prototype.assembleTransforms=function(t){var a=this;return void 0===t&&(t=!1),ue.keys(this._parse).filter(function(e){return!t||1<ue.accessPathDepth(e)}).map(function(e){var t,n,r,i=(t=e,n=a._parse[e],r=ue.accessPathWithDatum(t),"number"===n?"toNumber("+r+")":"boolean"===n?"toBoolean("+r+")":"string"===n?"toString("+r+")":"date"===n?"toDate("+r+")":"flatten"===n?r:0===n.indexOf("date:")?"timeParse("+r+","+n.slice(5,n.length)+")":0===n.indexOf("utc:")?"utcParse("+r+","+n.slice(4,n.length)+")":(v.warn(v.message.unrecognizedParse(n)),null));return i?{type:"formula",expr:i,as:ue.removePathFromField(e)}:null}).filter(function(e){return null!==e})},h}(st.DataFlowNode);t.ParseNode=n});t(tr);tr.ParseNode;var nr=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(a){function e(e){var t=a.call(this,null)||this;if(e=e||{name:"source"},Me.isInlineData(e))t._data={values:e.values};else if(Me.isUrlData(e)){if(t._data={url:e.url},e.format||(e.format={}),!e.format||!e.format.type){var n=/(?:\.([^.]+))?$/.exec(e.url)[1];ue.contains(["json","csv","tsv","dsv","topojson"],n)||(n="json"),e.format.type=n}}else Me.isNamedData(e)&&(t._data={});if(e.name&&(t._name=e.name),e.format){var r=e.format,i=(r.parse,ae.__rest(r,["parse"]));t._data.format=i}return t}return ae.__extends(e,a),Object.defineProperty(e.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),e.prototype.hasName=function(){return!!this._name},Object.defineProperty(e.prototype,"dataName",{get:function(){return this._name},set:function(e){this._name=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{set:function(e){throw new Error("Source nodes have to be roots.")},enumerable:!0,configurable:!0}),e.prototype.remove=function(){throw new Error("Source nodes are roots and cannot be removed.")},e.prototype.hash=function(){return Me.isInlineData(this._data)?(this._hash||(this._hash=ue.hash(this._data)),this._hash):Me.isUrlData(this._data)?ue.hash([this._data.url,this._data.format]):this._name},e.prototype.assemble=function(){return ae.__assign({name:this._name},this._data,{transform:[]})},e}(st.DataFlowNode);t.SourceNode=n});t(nr);nr.SourceNode;var rr=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(r){function i(e,t){var n=r.call(this,e)||this;return n.formula=t,n}return ae.__extends(i,r),i.prototype.clone=function(){return new i(null,ue.duplicate(this.formula))},i.makeFromEncoding=function(e,t){var n=t.reduceFieldDef(function(e,t){if(t.timeUnit){var n=ve.vgField(t,{forAs:!0});e[n]={as:n,timeUnit:t.timeUnit,field:t.field}}return e},{});return 0===ue.keys(n).length?null:new i(e,n)},i.makeFromTransform=function(e,t){var n;return new i(e,((n={})[t.field]={as:t.as,timeUnit:t.timeUnit,field:t.field},n))},i.prototype.merge=function(e){this.formula=ae.__assign({},this.formula,e.formula),e.remove()},i.prototype.producedFields=function(){var t={};return ue.vals(this.formula).forEach(function(e){t[e.as]=!0}),t},i.prototype.dependentFields=function(){var t={};return ue.vals(this.formula).forEach(function(e){t[e.field]=!0}),t},i.prototype.hash=function(){return"TimeUnit "+ue.hash(this.formula)},i.prototype.assemble=function(){return ue.vals(this.formula).map(function(e){return{type:"formula",as:e.as,expr:me.fieldExpr(e.timeUnit,e.field)}})},i}(st.TransformNode);t.TimeUnitNode=n});t(rr);rr.TimeUnitNode;var ir=n(function(e,t){function r(r){return function e(t){if(!(t instanceof nr.SourceNode)){var n=t.parent;r(t)&&e(n)}}}function l(t,e){var n=e.shift();e.forEach(function(e){t.removeChild(e),e.parent=n,e.remove()})}Object.defineProperty(t,"__esModule",{value:!0}),t.iterateFromLeaves=r,t.moveParseUp=function(e){var t=e.parent;if(e instanceof tr.ParseNode){if(t instanceof nr.SourceNode)return!1;if(1<t.numChildren())return!0;if(t instanceof tr.ParseNode)t.merge(e);else{if(ue.hasIntersection(t.producedFields(),e.dependentFields()))return!0;e.swapWithParent()}}return!0},t.mergeIdenticalTransforms=function e(t){for(var n=t.children.filter(function(e){return st.isTransformNode(e)}),r=n.map(function(e){return e.hash()}),i={},a=0;a<r.length;a++)void 0===i[r[a]]?i[r[a]]=[n[a]]:i[r[a]].push(n[a]);for(var o=0,s=ue.keys(i);o<s.length;o++)l(t,i[s[o]]);t.children.forEach(e)},t.removeUnusedSubtrees=function(e){return!(e instanceof st.OutputNode||0<e.numChildren()||e instanceof er.FacetNode||(e.remove(),0))},t.removeDuplicateTimeUnits=function(e){var n={};return r(function(e){if(e instanceof rr.TimeUnitNode){var t=e.producedFields();ue.keys(t).every(function(e){return!!n[e]})?e.remove():n=ae.__assign({},n,t)}return!0})(e)}});t(ir);ir.iterateFromLeaves,ir.moveParseUp,ir.mergeIdenticalTransforms,ir.removeUnusedSubtrees,ir.removeDuplicateTimeUnits;var ar=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(r){function p(e,t){var n=r.call(this,e)||this;return n._stack=t,n}return ae.__extends(p,r),p.prototype.clone=function(){return new p(null,ue.duplicate(this._stack))},p.makeFromTransform=function(e,t){var n,r=t.stack,i=t.groupby,a=t.as,o=t.offset,s=void 0===o?"zero":o,l=[],u=[];if(void 0!==t.sort)for(var c=0,f=t.sort;c<f.length;c++){var d=f[c];l.push(d.field),u.push(ue.getFirstDefined(d.order,"ascending"))}return n=a,new p(e,{stackField:r,groupby:i,offset:s,sort:{field:l,order:u},facetby:[],as:oe.isArray(n)&&n.every(function(e){return oe.isString(e)})&&1<n.length?a:oe.isString(a)?[a,a+"_end"]:[t.stack+"_start",t.stack+"_end"]})},p.makeFromEncoding=function(e,t){var n,r=t.stack;if(!r)return null;r.groupbyChannel&&(n=t.fieldDef(r.groupbyChannel));var i,a=t.stack.stackBy.reduce(function(e,t){var n=t.fieldDef,r=ve.vgField(n);return r&&e.push(r),e},[]),o=t.encoding.order;return i=oe.isArray(o)||ve.isFieldDef(o)?ot.sortParams(o):a.reduce(function(e,t){return e.field.push(t),e.order.push("descending"),e},{field:[],order:[]}),new p(e,{dimensionFieldDef:n,stackField:t.vgField(r.fieldChannel),facetby:[],stackby:a,sort:i,offset:r.offset,impute:r.impute,as:[t.vgField(r.fieldChannel,{suffix:"start",forAs:!0}),t.vgField(r.fieldChannel,{suffix:"end",forAs:!0})]})},Object.defineProperty(p.prototype,"stack",{get:function(){return this._stack},enumerable:!0,configurable:!0}),p.prototype.addDimensions=function(e){this._stack.facetby=this._stack.facetby.concat(e)},p.prototype.dependentFields=function(){var t={};t[this._stack.stackField]=!0,this.getGroupbyFields().forEach(function(e){return t[e]=!0}),this._stack.facetby.forEach(function(e){return t[e]=!0});var e=this._stack.sort.field;return oe.isArray(e)?e.forEach(function(e){return t[e]=!0}):t[e]=!0,t},p.prototype.producedFields=function(){return this._stack.as.reduce(function(e,t){return e[t]=!0,e},{})},p.prototype.hash=function(){return"Stack "+ue.hash(this._stack)},p.prototype.getGroupbyFields=function(){var e=this._stack,t=e.dimensionFieldDef,n=e.impute,r=e.groupby;return t?t.bin?n?[ve.vgField(t,{binSuffix:"mid"})]:[ve.vgField(t,{}),ve.vgField(t,{binSuffix:"end"})]:[ve.vgField(t)]:r||[]},p.prototype.assemble=function(){var e=[],t=this._stack,n=t.facetby,r=t.dimensionFieldDef,i=t.stackField,a=t.stackby,o=t.sort,s=t.offset,l=t.impute,u=t.as;return l&&r&&(r.bin&&e.push({type:"formula",expr:"("+ve.vgField(r,{expr:"datum"})+"+"+ve.vgField(r,{expr:"datum",binSuffix:"end"})+")/2",as:ve.vgField(r,{binSuffix:"mid",forAs:!0})}),e.push({type:"impute",field:i,groupby:a,key:ve.vgField(r,{binSuffix:"mid"}),method:"value",value:0})),e.push({type:"stack",groupby:this.getGroupbyFields().concat(n),field:i,sort:o,as:u,offset:s}),e},p}(st.TransformNode);t.StackNode=n});t(ar);ar.StackNode;var or=n(function(e,a){Object.defineProperty(a,"__esModule",{value:!0});var n=ae.__importStar(ir);function r(t){if(t instanceof er.FacetNode)if(1!==t.numChildren()||t.children[0]instanceof st.OutputNode){!function e(t){if(t instanceof st.OutputNode&&t.type===Me.MAIN&&1===t.numChildren()){var n=t.children[0];n instanceof er.FacetNode||(n.swapWithParent(),e(t))}}(t.model.component.data.main),ue.flatten(t.children.map((i=t,function e(t){if(!(t instanceof er.FacetNode)){var n=t.clone();if(n instanceof st.OutputNode){var r=a.FACET_SCALE_PREFIX+n.getSource();n.setSource(r),i.model.component.data.outputNodes[r]=n}else(n instanceof $n.AggregateNode||n instanceof ar.StackNode)&&n.addDimensions(i.fields);return ue.flatten(t.children.map(e)).forEach(function(e){return e.parent=n}),[n]}return ue.flatten(t.children.map(e))}))).forEach(function(e){return e.parent=t.model.component.data.main})}else{var e=t.children[0];(e instanceof $n.AggregateNode||e instanceof ar.StackNode)&&e.addDimensions(t.fields),e.swapWithParent(),r(t)}else t.children.forEach(r);var i}function i(e){e instanceof st.OutputNode&&!e.isRequired()&&e.remove(),e.children.forEach(i)}function o(e){var n=[];return e.forEach(function e(t){0===t.numChildren()?n.push(t):t.children.forEach(e)}),n}function h(e){var t=e.children.filter(function(e){return e instanceof tr.ParseNode});if(1<t.length){for(var n={},r=0,i=t;r<i.length;r++)for(var a=(d=i[r]).parse,o=0,s=ue.keys(a);o<s.length;o++){var l=s[o];void 0===n[l]?n[l]=a[l]:n[l]!==a[l]&&delete n[l]}if(0!==ue.keys(n).length)for(var u=new tr.ParseNode(e,n),c=0,f=t;c<f.length;c++){for(var d=f[c],p=0,g=ue.keys(n);p<g.length;p++){var m=g[p];delete d.parse[m]}e.removeChild(d),d.parent=u,0===ue.keys(d.parse).length&&d.remove()}}e.children.forEach(h)}a.FACET_SCALE_PREFIX="scale_",a.mergeParse=h,a.optimizeDataflow=function(t){var e=ue.vals(t.sources);e.forEach(i),o(e=e.filter(function(e){return 0<e.numChildren()})).forEach(n.iterateFromLeaves(n.removeUnusedSubtrees)),o(e=e.filter(function(e){return 0<e.numChildren()})).forEach(n.iterateFromLeaves(n.moveParseUp)),o(e).forEach(n.removeDuplicateTimeUnits),e.forEach(r),e.forEach(h),e.forEach(n.mergeIdenticalTransforms),ue.keys(t.sources).forEach(function(e){0===t.sources[e].numChildren()&&delete t.sources[e]})}});t(or);or.FACET_SCALE_PREFIX,or.mergeParse,or.optimizeDataflow;var sr=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var p=ae.__importStar(de),g=ae.__importStar(ue);function r(e){var c,f,d;gr.isUnitModel(e)?(f=(c=e).specifiedScales,d=c.component.scales,g.keys(d).forEach(function(e){var t=f[e],n=t?t.domain:void 0,r=m(c,e),i=d[e];if(i.domains=r,De.isSelectionDomain(n)&&i.set("domainRaw",{signal:xr.SELECTION_DOMAIN+g.hash(n)},!0),c.component.data.isFaceted){for(var a=c;!gr.isFacetModel(a)&&a.parent;)a=a.parent;var o=a.component.resolve.scale[e];if("shared"===o)for(var s=0,l=r;s<l.length;s++){var u=l[s];et.isDataRefDomain(u)&&(u.data=or.FACET_SCALE_PREFIX+u.data.replace(or.FACET_SCALE_PREFIX,""))}}})):function(l){for(var e=0,t=l.children;e<t.length;e++){var n=t[e];r(n)}var u=l.component.scales;g.keys(u).forEach(function(e){for(var t,n=null,r=0,i=l.children;r<i.length;r++){var a=i[r],o=a.component.scales[e];if(o){t=void 0===t?o.domains:t.concat(o.domains);var s=o.get("domainRaw");n&&s&&n.signal!==s.signal&&p.warn("The same selection must be used to override scale domains in a layered view."),n=s}}u[e].domains=t,n&&u[e].set("domainRaw",n,!0)})}(e)}function m(e,t){var n=e.getScaleComponent(t).get("type"),r=function(e,t,n,r){if("unaggregated"===e){var i=s(t,n),a=i.valid,o=i.reason;if(!a)return void p.warn(o)}else if(void 0===e&&r.useUnaggregatedDomain&&(a=s(t,n).valid))return"unaggregated";return e}(e.scaleDomain(t),e.fieldDef(t),n,e.config.scale);return r!==e.scaleDomain(t)&&(e.specifiedScales[t]=ae.__assign({},e.specifiedScales[t],{domain:r})),"x"===t&&e.channelHasField("x2")?e.channelHasField("x")?i(n,r,e,"x").concat(i(n,r,e,"x2")):i(n,r,e,"x2"):"y"===t&&e.channelHasField("y2")?e.channelHasField("y")?i(n,r,e,"y").concat(i(n,r,e,"y2")):i(n,r,e,"y2"):i(n,r,e,t)}function i(e,t,n,r){var i,a,o=n.fieldDef(r);if(t&&"unaggregated"!==t&&!De.isSelectionDomain(t)){var s=o.type,l=o.timeUnit;return"temporal"===s||l?(i=s,a=l,t.map(function(e){return{signal:"{data: "+ve.valueExpr(e,{timeUnit:a,type:i})+"}"}})):[t]}var u=n.stack;if(u&&r===u.fieldChannel)return"normalize"===u.offset?[[0,1]]:[{data:f=n.requestDataName(Me.MAIN),field:n.vgField(r,{suffix:"start"})},{data:f,field:n.vgField(r,{suffix:"end"})}];var c=_e.isScaleChannel(r)?h(n,r,e):void 0;if("unaggregated"===t){var f=n.requestDataName(Me.MAIN),d=o.field;return[{data:f,field:ve.vgField({field:d,aggregate:"min"})},{data:f,field:ve.vgField({field:d,aggregate:"max"})}]}if(!Se.isBinning(o.bin))return c?[{data:g.isBoolean(c)?n.requestDataName(Me.MAIN):n.requestDataName(Me.RAW),field:n.vgField(r),sort:c}]:[{data:n.requestDataName(Me.MAIN),field:n.vgField(r)}];if(De.isBinScale(e)){var p=n.getName(Se.binToString(o.bin)+"_"+o.field+"_bins");return[{signal:"sequence("+p+".start, "+p+".stop + "+p+".step, "+p+".step)"}]}return De.hasDiscreteDomain(e)?[{data:g.isBoolean(c)?n.requestDataName(Me.MAIN):n.requestDataName(Me.RAW),field:n.vgField(r,ot.binRequiresRange(o,r)?{binSuffix:"range"}:{}),sort:!0!==c&&rt.isSortField(c)?c:{field:n.vgField(r,{}),op:"min"}}]:"x"!==r&&"y"!==r?[{data:n.requestDataName(Me.MAIN),field:n.vgField(r,{})}]:Se.isBinParams(o.bin)&&o.bin.extent?[o.bin.extent]:[{data:f=n.requestDataName(Me.MAIN),field:n.vgField(r,{})},{data:f,field:n.vgField(r,{binSuffix:"end"})}]}function h(e,t,n){if(De.hasDiscreteDomain(n)){var r=e.fieldDef(t),i=r.sort;return rt.isSortArray(i)?{op:"min",field:jn.sortArrayIndexField(r,t),order:"ascending"}:rt.isSortField(i)?ae.__assign({},i,i.field?{field:g.replacePathInField(i.field)}:{}):"descending"===i?{op:"min",field:e.vgField(t),order:"descending"}:!!g.contains(["ascending",void 0],i)||void 0}}function s(e,t){return e.aggregate?ce.SHARED_DOMAIN_OP_INDEX[e.aggregate]?"quantitative"===e.type&&"log"===t?{valid:!1,reason:p.message.unaggregatedDomainWithLogScale(e)}:{valid:!0}:{valid:!1,reason:p.message.unaggregateDomainWithNonSharedDomainOp(e.aggregate)}:{valid:!1,reason:p.message.unaggregateDomainHasNoEffectForRawField(e)}}function n(e){var t=g.unique(e.map(function(e){if(et.isDataRefDomain(e)){e.sort;return ae.__rest(e,["sort"])}return e}),g.hash),n=g.unique(e.map(function(e){if(et.isDataRefDomain(e)){var t=e.sort;return void 0===t||g.isBoolean(t)||("count"===t.op&&delete t.field,"ascending"===t.order&&delete t.order),t}}).filter(function(e){return void 0!==e}),g.hash);if(1===t.length){var r=e[0];if(et.isDataRefDomain(r)&&0<n.length){var i=n[0];return 1<n.length&&(p.warn(p.message.MORE_THAN_ONE_SORT),i=!0),ae.__assign({},r,{sort:i})}return r}var a,o=g.unique(n.map(function(e){return g.isBoolean(e)?e:"count"===e.op?e:(p.warn(p.message.domainSortDropped(e)),!0)}),g.hash);1===o.length?a=o[0]:1<o.length&&(p.warn(p.message.MORE_THAN_ONE_SORT),a=!0);var s=g.unique(e.map(function(e){return et.isDataRefDomain(e)?e.data:null}),function(e){return e});return 1===s.length&&null!==s[0]?r=ae.__assign({data:s[0],fields:t.map(function(e){return e.field})},a?{sort:a}:{}):ae.__assign({fields:t},a?{sort:a}:{})}t.parseScaleDomain=r,t.parseDomainForChannel=m,t.domainSort=h,t.canUseUnaggregatedDomain=s,t.mergeDomains=n,t.getFieldFromDomain=function(e){if(et.isDataRefDomain(e)&&oe.isString(e.field))return e.field;if(et.isDataRefUnionedDomain(e)){for(var t=void 0,n=0,r=e.fields;n<r.length;n++){var i=r[n];if(et.isDataRefDomain(i)&&oe.isString(i.field))if(t){if(t!==i.field)return p.warn("Detected faceted independent scales that union domain of multiple fields from different data sources.  We will use the first field.  The result view size may be incorrect."),t}else t=i.field}return p.warn("Detected faceted independent scales that union domain of identical fields from different source detected.  We will assume that this is the same field from a different fork of the same data source.  However, if this is not case, the result view size maybe incorrect."),t}if(et.isFieldRefUnionDomain(e))return p.warn("Detected faceted independent scales that union domain of multiple fields from the same data source.  We will use the first field.  The result view size may be incorrect."),t=e.fields[0],oe.isString(t)?t:void 0},t.assembleDomain=function(t,e){return n(t.component.scales[e].domains.map(function(e){return et.isDataRefDomain(e)&&(e.data=t.lookupDataSource(e.data)),e}))}});t(sr);sr.parseScaleDomain,sr.parseDomainForChannel,sr.domainSort,sr.canUseUnaggregatedDomain,sr.mergeDomains,sr.getFieldFromDomain,sr.assembleDomain;var lr=n(function(e,t){function r(u){return ue.keys(u.component.scales).reduce(function(e,t){var n=u.component.scales[t];if(n.merged)return e;var r=n.combine(),i=r.domainRaw,a=r.range,o=r.name,s=r.type,l=(r.domainRaw,r.range,ae.__rest(r,["name","type","domainRaw","range"]));return a=c(a,o,u,t),i&&xr.isRawSelectionDomain(i)&&(i=xr.selectionScaleDomain(u,i)),e.push(ae.__assign({name:o,type:s,domain:sr.assembleDomain(u,t)},i?{domainRaw:i}:{},{range:a},l)),e},[])}function c(e,t,n,r){if("x"===r||"y"===r){if(et.isVgRangeStep(e))return{step:{signal:t+"_step"}};if(oe.isArray(e)&&2===e.length){var i=e[0],a=e[1];if(0===i&&et.isSignalRef(a))return[0,{signal:n.getSizeName(a.signal)}];if(et.isSignalRef(i)&&0===a)return[{signal:n.getSizeName(i.signal)},0]}}return e}Object.defineProperty(t,"__esModule",{value:!0}),t.assembleScales=function n(e){return gr.isLayerModel(e)||gr.isConcatModel(e)||gr.isRepeatModel(e)?e.children.reduce(function(e,t){return e.concat(n(t))},r(e)):r(e)},t.assembleScalesForModel=r,t.assembleScaleRange=c});t(lr);lr.assembleScales,lr.assembleScalesForModel,lr.assembleScaleRange;var ur=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(r){function e(e,t){var n=r.call(this,{},{name:e})||this;return n.merged=!1,n.domains=[],n.setWithExplicit("type",t),n}return ae.__extends(e,r),e}(Gn.Split);t.ScaleComponent=n});t(ur);ur.ScaleComponent;var cr=n(function(e,v){Object.defineProperty(v,"__esModule",{value:!0});var y=ae.__importStar(de),p=ae.__importStar(ue);function g(e,t,n,r,i,a,o,s,l,u){for(var c=s||null===r.rangeStep,f=0,d=v.RANGE_PROPERTIES;f<d.length;f++){var p=d[f];if(void 0!==r[p]){var g=De.scaleTypeSupportProperty(t,p),m=De.channelScalePropertyIncompatability(e,p);if(g)if(m)y.warn(m);else switch(p){case"range":return Gn.makeExplicit(r[p]);case"scheme":return Gn.makeExplicit(_(r[p]));case"rangeStep":var h=r[p];if(null!==h){if(!s)return Gn.makeExplicit({step:h});y.warn(y.message.rangeStepDropped(e))}}else y.warn(y.message.scalePropertyNotWorkWithScaleType(t,p,e))}}return Gn.makeImplicit(S(e,t,n,i,a,o,l,u,c,r.domain))}function _(e){if(De.isExtendedScheme(e)){var t={scheme:e.name};return e.count&&(t.count=e.count),e.extent&&(t.extent=e.extent),t}return{scheme:e}}function S(e,t,n,r,i,a,o,s,l,u){switch(e){case _e.X:case _e.Y:if(p.contains(["point","band"],t)&&!l)if(e===_e.X&&"text"===a){if(r.scale.textXRangeStep)return{step:r.scale.textXRangeStep}}else if(r.scale.rangeStep)return{step:r.scale.rangeStep};return e===_e.Y&&De.hasContinuousDomain(t)?[{signal:o},0]:[0,{signal:o}];case _e.SIZE:var c=function(e,t,n){if(t)return 0;switch(e){case"bar":case"tick":return n.scale.minBandSize;case"line":case"trail":case"rule":return n.scale.minStrokeWidth;case"text":return n.scale.minFontSize;case"point":case"square":case"circle":return n.scale.minSize}throw new Error(y.message.incompatibleChannel("size",e))}(a,i,r),f=function(e,t,n){var r=n.scale;switch(e){case"bar":case"tick":return void 0!==n.scale.maxBandSize?n.scale.maxBandSize:b(t,n.scale)-1;case"line":case"trail":case"rule":return n.scale.maxStrokeWidth;case"text":return n.scale.maxFontSize;case"point":case"square":case"circle":if(n.scale.maxSize)return n.scale.maxSize;var i=b(t,r);return(i-2)*(i-2)}throw new Error(y.message.incompatibleChannel("size",e))}(a,s,r);return De.isContinuousToDiscrete(t)?h(c,f,m(t,r,u,e)):[c,f];case _e.SHAPE:return"symbol";case _e.COLOR:case _e.FILL:case _e.STROKE:if("ordinal"===t)return"nominal"===n?"category":"ordinal";if(De.isContinuousToDiscrete(t)){var d=m(t,r,u,e);return r.range&&we.isVgScheme(r.range.ordinal)?ae.__assign({},r.range.ordinal,{count:d}):{scheme:"blues",count:d}}return De.isContinuousToContinuous(t)?["#f7fbff","#0e427f"]:"rect"===a||"geoshape"===a?"heatmap":"ramp";case _e.OPACITY:return[r.scale.minOpacity,r.scale.maxOpacity]}throw new Error("Scale range undefined for channel "+e)}function m(e,t,n,r){switch(e){case"quantile":return t.scale.quantileCount;case"quantize":return t.scale.quantizeCount;case"threshold":return void 0!==n&&oe.isArray(n)?n.length+1:(y.warn(y.message.domainRequiredForThresholdScale(r)),3)}}function h(e,t,n){for(var r=[],i=(t-e)/(n-1),a=0;a<n;a++)r.push(e+a*i);return r}function b(e,t){return 0<e.length?Math.min.apply(null,e):t.rangeStep?t.rangeStep:21}v.RANGE_PROPERTIES=["range","rangeStep","scheme"],v.parseScaleRange=function(e){var f,d;gr.isUnitModel(e)?(d=(f=e).component.scales,_e.SCALE_CHANNELS.forEach(function(e){var t=d[e];if(t){var n=f.getScaleComponent(e),r=f.specifiedScales[e],i=f.fieldDef(e),a="x"===e?"width":"y"===e?"height":void 0,o=a?!!f.component.layoutSize.get(a):void 0,s=n.get("type"),l=p.contains(["point","band"],s)||!!r.rangeStep;a&&f.fit&&!o&&l&&(y.warn(y.message.CANNOT_FIX_RANGE_STEP_WITH_FIT),o=!0);var u=function(e){var t=[],n=e.getScaleComponent("x"),r=n&&n.get("range");r&&et.isVgRangeStep(r)&&oe.isNumber(r.step)&&t.push(r.step);var i=e.getScaleComponent("y"),a=i&&i.get("range");return a&&et.isVgRangeStep(a)&&oe.isNumber(a.step)&&t.push(a.step),t}(f),c=g(e,s,i.type,r,f.config,t.get("zero"),f.mark,o,f.getName(a),u);t.setWithExplicit("range",c)}})):fr.parseNonUnitScaleProperty(e,"range")},v.parseRangeForChannel=g,v.defaultRange=S,v.defaultContinuousToDiscreteCount=m,v.interpolateRange=h});t(cr);cr.RANGE_PROPERTIES,cr.parseScaleRange,cr.parseRangeForChannel,cr.defaultRange,cr.defaultContinuousToDiscreteCount,cr.interpolateRange;var fr=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var g=ae.__importStar(de),l=ae.__importStar(ue),u=ue;function r(e,t){var f,d,p;gr.isUnitModel(e)?(d=t,p=(f=e).component.scales,u.keys(p).forEach(function(e){var t=f.specifiedScales[e],n=p[e],r=f.getScaleComponent(e),i=f.fieldDef(e),a=f.config,o=t[d],s=r.get("type"),l=De.scaleTypeSupportProperty(s,d),u=De.channelScalePropertyIncompatability(e,d);if(void 0!==o&&(l?u&&g.warn(u):g.warn(g.message.scalePropertyNotWorkWithScaleType(s,d,e))),l&&void 0===u)if(void 0!==o)n.copyKeyFromObject(d,t);else{var c=m(d,e,i,r.get("type"),r.get("padding"),r.get("paddingInner"),t.domain,f.markDef,a);void 0!==c&&n.set(d,c,!1)}})):n(e,t)}function m(e,t,n,r,i,a,o,s,l){var u=l.scale;switch(e){case"interpolate":return c(t,r);case"nice":return f(r,t,n);case"padding":return d(t,r,u,n,s,l.bar);case"paddingInner":return p(i,t,u);case"paddingOuter":return h(i,t,r,a,u);case"reverse":return v(r,n.sort);case"zero":return y(t,n,o,s,r)}return u[e]}function n(o,s){for(var l=o.component.scales,e=0,t=o.children;e<t.length;e++){var n=t[e];"range"===s?cr.parseScaleRange(n):r(n,s)}u.keys(l).forEach(function(e){for(var t,n=0,r=o.children;n<r.length;n++){var i=r[n].component.scales[e];if(i){var a=i.getWithExplicit(s);t=Gn.mergeValuesWithExplicit(t,a,s,"scale",Gn.tieBreakByComparing(function(e,t){switch(s){case"range":return e.step&&t.step?e.step-t.step:0}return 0}))}}l[e].setWithExplicit(s,t)})}function c(e,t){if(u.contains([_e.COLOR,_e.FILL,_e.STROKE],e)&&De.isContinuousToContinuous(t))return"hcl"}function f(e,t,n){if(!n.bin&&!l.contains([De.ScaleType.TIME,De.ScaleType.UTC],e))return!!l.contains([_e.X,_e.Y],t)||void 0}function d(e,t,n,r,i,a){if(l.contains([_e.X,_e.Y],e)){if(De.isContinuousToContinuous(t)){if(void 0!==n.continuousPadding)return n.continuousPadding;var o=i.type,s=i.orient;if("bar"===o&&!r.bin&&("vertical"===s&&"x"===e||"horizontal"===s&&"y"===e))return a.continuousBandSize}if(t===De.ScaleType.POINT)return n.pointPadding}}function p(e,t,n){if(void 0===e)return l.contains([_e.X,_e.Y],t)?n.bandPaddingInner:void 0}function h(e,t,n,r,i){if(void 0===e)return l.contains([_e.X,_e.Y],t)&&n===De.ScaleType.BAND?void 0!==i.bandPaddingOuter?i.bandPaddingOuter:r/2:void 0}function v(e,t){if(De.hasContinuousDomain(e)&&"descending"===t)return!0}function y(e,t,n,r,i){if(!!n&&"unaggregated"!==n)return!1;if("size"===e&&"quantitative"===t.type&&!De.isContinuousToDiscrete(i))return!0;if(!t.bin&&l.contains([_e.X,_e.Y],e)){var a=r.orient,o=r.type;return!u.contains(["bar","area","line","trail"],o)||!("horizontal"===a&&"y"===e||"vertical"===a&&"x"===e)}return!1}t.parseScaleProperty=r,t.getDefaultValue=m,t.parseNonUnitScaleProperty=n,t.interpolate=c,t.nice=f,t.padding=d,t.paddingInner=p,t.paddingOuter=h,t.reverse=v,t.zero=y});t(fr);fr.parseScaleProperty,fr.getDefaultValue,fr.parseNonUnitScaleProperty,fr.interpolate,fr.nice,fr.padding,fr.paddingInner,fr.paddingOuter,fr.reverse,fr.zero;var dr=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var c=ae.__importStar(de),f=ae.__importStar(ue);t.scaleType=function(e,t,n,r,i){var a=function(e,t,n,r,i){switch(t.type){case"nominal":case"ordinal":if(_e.isColorChannel(e)||"discrete"===_e.rangeType(e))return"shape"===e&&"ordinal"===t.type&&c.warn(c.message.discreteChannelCannotEncode(e,"ordinal")),"ordinal";if(f.contains(["x","y"],e)){if(f.contains(["rect","bar","rule"],n))return"band";if("bar"===n)return"band"}return"point";case"temporal":return _e.isColorChannel(e)?"sequential":"discrete"===_e.rangeType(e)?(c.warn(c.message.discreteChannelCannotEncode(e,"temporal")),"ordinal"):"time";case"quantitative":if(_e.isColorChannel(e)){if(Se.isBinning(t.bin))return"bin-ordinal";var a=r||{},o=a.domain,s=void 0===o?void 0:o,l=a.range,u=void 0===l?void 0:l;return s&&oe.isArray(s)&&2<s.length&&u&&oe.isArray(u)&&2<u.length?"linear":"sequential"}return"discrete"===_e.rangeType(e)?(c.warn(c.message.discreteChannelCannotEncode(e,"quantitative")),"ordinal"):Se.isBinning(t.bin)&&"x"!==e&&"y"!==e?"bin-linear":"linear";case"geojson":return}throw new Error(c.message.invalidFieldType(t.type))}(t,n,r,e),o=e.type;return _e.isScaleChannel(t)?void 0!==o?De.channelSupportScaleType(t,o)?De.scaleTypeSupportDataType(o,n.type,n.bin)?o:(c.warn(c.message.scaleTypeNotWorkWithFieldDef(o,a)),a):(c.warn(c.message.scaleTypeNotWorkWithChannel(t,o,a)),a):a:null}});t(dr);dr.scaleType;var pr=n(function(e,t){function a(e){var o,s,l,u;gr.isUnitModel(e)?e.component.scales=(s=(o=e).encoding,l=o.config,u=o.mark,_e.SCALE_CHANNELS.reduce(function(e,t){var n,r,i=s[t];if(ve.isFieldDef(i)&&u===ye.GEOSHAPE&&t===_e.SHAPE&&i.type===he.GEOJSON)return e;if(ve.isFieldDef(i)?r=(n=i).scale:ve.hasConditionalFieldDef(i)?(n=i.condition,r=i.condition.scale):t===_e.X?n=ve.getFieldDef(s.x2):t===_e.Y&&(n=ve.getFieldDef(s.y2)),n&&null!==r&&!1!==r){r=r||{};var a=dr.scaleType(r,t,n,u,l.scale);e[t]=new ur.ScaleComponent(o.scaleName(t+"",!0),{value:a,explicit:r.type===a})}return e},{})):e.component.scales=function(s){for(var l=s.component.scales={},u={},i=s.component.resolve,e=function(r){a(r),ue.keys(r.component.scales).forEach(function(e){if(i.scale[e]=i.scale[e]||Hn.defaultScaleResolve(e,s),"shared"===i.scale[e]){var t=u[e],n=r.component.scales[e].getWithExplicit("type");t?De.scaleCompatible(t.value,n.value)?u[e]=Gn.mergeValuesWithExplicit(t,n,"type","scale",c):(i.scale[e]="independent",delete u[e]):u[e]=n}})},t=0,n=s.children;t<n.length;t++){var r=n[t];e(r)}return ue.keys(u).forEach(function(e){var t=s.scaleName(e,!0),n=u[e];l[e]=new ur.ScaleComponent(t,n);for(var r=0,i=s.children;r<i.length;r++){var a=i[r],o=a.component.scales[e];o&&(a.renameScale(o.get("name"),t),o.merged=!0)}}),l}(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.parseScale=function(e){a(e),sr.parseScaleDomain(e);for(var t=0,n=De.NON_TYPE_DOMAIN_RANGE_VEGA_SCALE_PROPERTIES;t<n.length;t++){var r=n[t];fr.parseScaleProperty(e,r)}cr.parseScaleRange(e)},t.parseScaleCore=a;var c=Gn.tieBreakByComparing(function(e,t){return De.scaleTypePrecedence(e)-De.scaleTypePrecedence(t)})});t(pr);pr.parseScale,pr.parseScaleCore;var gr=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var u=ae.__importStar(de),s=function(){function e(){this.nameMap={}}return e.prototype.rename=function(e,t){this.nameMap[e]=t},e.prototype.has=function(e){return void 0!==this.nameMap[e]},e.prototype.get=function(e){for(;this.nameMap[e]&&e!==this.nameMap[e];)e=this.nameMap[e];return e},e}();function i(e){return e&&"unit"===e.type}function c(e){return e&&"facet"===e.type}t.NameMap=s,t.isUnitModel=i,t.isFacetModel=c,t.isRepeatModel=function(e){return e&&"repeat"===e.type},t.isConcatModel=function(e){return e&&"concat"===e.type},t.isLayerModel=function(e){return e&&"layer"===e.type};var n=function(){function e(e,t,n,r,i,a){var o=this;this.children=[],this.correctDataNames=function(e){return e.from&&e.from.data&&(e.from.data=o.lookupDataSource(e.from.data)),e.from&&e.from.facet&&e.from.facet.data&&(e.from.facet.data=o.lookupDataSource(e.from.facet.data)),e},this.parent=t,this.config=r,this.repeater=i,this.name=e.name||n,this.title=oe.isString(e.title)?{text:e.title}:e.title,this.scaleNameMap=t?t.scaleNameMap:new s,this.projectionNameMap=t?t.projectionNameMap:new s,this.layoutSizeNameMap=t?t.layoutSizeNameMap:new s,this.data=e.data,this.description=e.description,this.transforms=Cr.normalizeTransform(e.transform||[]),this.layout=Ie.isUnitSpec(e)||Ie.isLayerSpec(e)?void 0:Le.extractCompositionLayout(e),this.component={data:{sources:t?t.component.data.sources:{},outputNodes:t?t.component.data.outputNodes:{},outputNodeRefCounts:t?t.component.data.outputNodeRefCounts:{},isFaceted:Ie.isFacetSpec(e)||t&&t.component.data.isFaceted&&!e.data},layoutSize:new Gn.Split,layoutHeaders:{row:{},column:{}},mark:null,resolve:ae.__assign({scale:{},axis:{},legend:{}},a||{}),selection:null,scales:null,projection:null,axes:{},legends:{}}}return Object.defineProperty(e.prototype,"width",{get:function(){return this.getSizeSignalRef("width")},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this.getSizeSignalRef("height")},enumerable:!0,configurable:!0}),e.prototype.initSize=function(e){var t=e.width,n=e.height;t&&this.component.layoutSize.set("width",t,!0),n&&this.component.layoutSize.set("height",n,!0)},e.prototype.parse=function(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSize(),this.parseSelection(),this.parseProjection(),this.parseData(),this.parseAxisAndHeader(),this.parseLegend(),this.parseMarkGroup()},e.prototype.parseScale=function(){pr.parseScale(this)},e.prototype.parseProjection=function(){Zn.parseProjection(this)},e.prototype.renameTopLevelLayoutSize=function(){"width"!==this.getName("width")&&this.renameLayoutSize(this.getName("width"),"width"),"height"!==this.getName("height")&&this.renameLayoutSize(this.getName("height"),"height")},e.prototype.parseLegend=function(){Vn.parseLegend(this)},e.prototype.assembleGroupStyle=function(){if("unit"===this.type||"layer"===this.type)return"cell"},e.prototype.assembleLayoutSize=function(){if("unit"===this.type||"layer"===this.type)return{width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height")}},e.prototype.assembleLayout=function(){if(this.layout){var e=this.layout,t=e.align,n=e.bounds,r=e.center,i=e.spacing,a=void 0===i?{}:i;return ae.__assign({padding:oe.isNumber(a)?a:{row:a.row||10,column:a.column||10}},this.assembleDefaultLayout(),t?{align:t}:{},n?{bounds:n}:{},r?{center:r}:{})}},e.prototype.assembleDefaultLayout=function(){return{}},e.prototype.assembleHeaderMarks=function(){for(var e=this.component.layoutHeaders,t=[],n=0,r=zn.HEADER_CHANNELS;n<r.length;n++){e[o=r[n]].title&&t.push(zn.getTitleGroup(this,o))}for(var i=0,a=zn.HEADER_CHANNELS;i<a.length;i++){var o=a[i];t=t.concat(zn.getHeaderGroups(this,o))}return t},e.prototype.assembleAxes=function(){return tt.assembleAxes(this.component.axes,this.config)},e.prototype.assembleLegends=function(){return Xn.assembleLegends(this)},e.prototype.assembleProjections=function(){return Kn.assembleProjections(this)},e.prototype.assembleTitle=function(){var e=this.title||{},t=e.encoding,n=ae.__rest(e,["encoding"]),r=ae.__assign({},Pe.extractTitleConfig(this.config.title).nonMark,n,t?{encode:{update:t}}:{});if(r.text)return ue.contains(["unit","layer"],this.type)||(r.anchor&&"start"!==r.anchor&&u.warn(u.message.cannotSetTitleAnchor(this.type)),r.anchor="start"),0<ue.keys(r).length?r:void 0},e.prototype.assembleGroup=function(e){void 0===e&&(e=[]);var t={};0<(e=e.concat(this.assembleSelectionSignals())).length&&(t.signals=e);var n=this.assembleLayout();n&&(t.layout=n),t.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());var r=!this.parent||c(this.parent)?lr.assembleScales(this):[];0<r.length&&(t.scales=r);var i=this.assembleAxes();0<i.length&&(t.axes=i);var a=this.assembleLegends();return 0<a.length&&(t.legends=a),t},e.prototype.hasDescendantWithFieldOnChannel=function(e){for(var t=0,n=this.children;t<n.length;t++){var r=n[t];if(i(r)){if(r.channelHasField(e))return!0}else if(r.hasDescendantWithFieldOnChannel(e))return!0}return!1},e.prototype.getName=function(e){return ue.varName((this.name?this.name+"_":"")+e)},e.prototype.requestDataName=function(e){var t=this.getName(e),n=this.component.data.outputNodeRefCounts;return n[t]=(n[t]||0)+1,t},e.prototype.getSizeSignalRef=function(e){if(c(this.parent)){var t="width"===e?"x":"y",n=this.component.scales[t];if(n&&!n.merged){var r=n.get("type"),i=n.get("range");if(De.hasDiscreteDomain(r)&&et.isVgRangeStep(i)){var a=n.get("name"),o=sr.assembleDomain(this,t),s=sr.getFieldFromDomain(o);if(s){var l=ve.vgField({aggregate:"distinct",field:s},{expr:"datum"});return{signal:Bn.sizeExpr(a,n,l)}}return u.warn("Unknown field for ${channel}.  Cannot calculate view size."),null}}}return{signal:this.layoutSizeNameMap.get(this.getName(e))}},e.prototype.lookupDataSource=function(e){var t=this.component.data.outputNodes[e];return t?t.getSource():e},e.prototype.getSizeName=function(e){return this.layoutSizeNameMap.get(e)},e.prototype.renameLayoutSize=function(e,t){this.layoutSizeNameMap.rename(e,t)},e.prototype.renameScale=function(e,t){this.scaleNameMap.rename(e,t)},e.prototype.renameProjection=function(e,t){this.projectionNameMap.rename(e,t)},e.prototype.scaleName=function(e,t){return t?this.getName(e):_e.isChannel(e)&&_e.isScaleChannel(e)&&this.component.scales[e]||this.scaleNameMap.has(this.getName(e))?this.scaleNameMap.get(this.getName(e)):void 0},e.prototype.projectionName=function(e){return e?this.getName("projection"):this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection"))?this.projectionNameMap.get(this.getName("projection")):void 0},e.prototype.getScaleComponent=function(e){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale().  Make sure you have called parseScale or use parseUnitModelWithScale().");var t=this.component.scales[e];return t&&!t.merged?t:this.parent?this.parent.getScaleComponent(e):void 0},e.prototype.getSelectionComponent=function(e,t){var n=this.component.selection[e];if(!n&&this.parent&&(n=this.parent.getSelectionComponent(e,t)),!n)throw new Error(u.message.selectionNotFound(t));return n},e}(),r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return ae.__extends(t,e),t.prototype.vgField=function(e,t){void 0===t&&(t={});var n=this.fieldDef(e);if(n)return ve.vgField(n,t)},t.prototype.reduceFieldDef=function(i,e,t){return be.reduce(this.getMapping(),function(e,t,n){var r=ve.getFieldDef(t);return r?i(e,r,n):e},e,t)},t.prototype.forEachFieldDef=function(r,e){be.forEach(this.getMapping(),function(e,t){var n=ve.getFieldDef(e);n&&r(n,t)},e)},t}(t.Model=n);t.ModelWithField=r});t(gr);gr.NameMap,gr.isUnitModel,gr.isFacetModel,gr.isRepeatModel,gr.isConcatModel,gr.isLayerModel,gr.Model,gr.ModelWithField;var mr=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var s=ae.__importStar(de),n={has:function(e){return"interval"===e.type&&"global"===e.resolve&&e.bind&&"scales"===e.bind},parse:function(i,e,a){var o=a.scales=[];a.project.forEach(function(e){var t=e.channel,n=i.getScaleComponent(t),r=n?n.get("type"):void 0;n&&De.hasContinuousDomain(r)&&!De.isBinScale(r)?(n.set("domainRaw",{signal:xr.channelSignalName(a,t,"data")},!0),o.push(t),i.repeater&&i.repeater.row===i.repeater.column&&i.getScaleComponent(t===_e.X?_e.Y:_e.X).set("domainRaw",{signal:xr.channelSignalName(a,t,"data")},!0)):s.warn(s.message.SCALE_BINDINGS_CONTINUOUS)})},topLevelSignals:function(e,n,r){if(!e.parent)return r;var t=n.scales.filter(function(t){return!r.filter(function(e){return e.name===xr.channelSignalName(n,t,"data")}).length});return r.concat(t.map(function(e){return{name:xr.channelSignalName(n,e,"data")}}))},signals:function(e,n,r){return e.parent&&n.scales.forEach(function(t){var e=r.filter(function(e){return e.name===xr.channelSignalName(n,t,"data")})[0];e.push="outer",delete e.value,delete e.update}),r}};t.default=n,t.domain=function(e,t){return"domain("+oe.stringValue(e.scaleName(t))+")"}});t(mr);mr.domain;var hr=n(function(e,_){Object.defineProperty(_,"__esModule",{value:!0});var S=ae.__importDefault(mr);_.BRUSH="_brush",_.SCALE_TRIGGER="_scale_trigger";var t={predicate:"vlInterval",scaleDomain:"vlIntervalDomain",signals:function(e,t){var n=t.name,r=S.default.has(t),i=[],a=[],o=[],s=[];if(t.translate&&!r){var l="!event.item || event.item.mark.name !== "+oe.stringValue(n+_.BRUSH);E(t,function(e,t){var n=t.between[0].filter||(t.between[0].filter=[]);n.indexOf(l)<0&&n.push(l)})}for(var u=0,c=t.project;u<c.length;u++){var f=c[u],d=f.channel;if(d===_e.X||d===_e.Y){var p=b(e,t,d),g=xr.channelSignalName(t,d,"data"),m=xr.channelSignalName(t,d,"visual"),h=oe.stringValue(e.scaleName(d)),v=e.getScaleComponent(d).get("type"),y=De.hasContinuousDomain(v)?"+":"";i.push.apply(i,p),o.push(g),a.push("{encoding: "+oe.stringValue(d)+", field: "+oe.stringValue(f.field)+", extent: "+g+"}"),s.push({scaleName:e.scaleName(d),expr:"(!isArray("+g+") || ("+y+"invert("+h+", "+m+")[0] === "+y+g+"[0] && "+y+"invert("+h+", "+m+")[1] === "+y+g+"[1]))"})}else de.warn("Interval selections only support x and y encoding channels.")}return r||i.push({name:n+_.SCALE_TRIGGER,update:s.map(function(e){return e.expr}).join(" && ")+" ? "+(n+_.SCALE_TRIGGER)+" : {}"}),i.concat({name:n+xr.TUPLE,on:[{events:o.map(function(e){return{signal:e}}),update:o.join(" && ")+" ? {unit: "+xr.unitName(e)+", intervals: ["+a.join(", ")+"]} : null"}]})},modifyExpr:function(e,t){return t.name+xr.TUPLE+", "+("global"===t.resolve?"true":"{unit: "+xr.unitName(e)+"}")},marks:function(e,t,n){var r=t.name,i=xr.positionalProjections(t),a=i.xi,o=i.yi,s="data("+oe.stringValue(t.name+xr.STORE)+")";if(S.default.has(t))return n;var l={x:null!==a?{signal:r+"_x[0]"}:{value:0},y:null!==o?{signal:r+"_y[0]"}:{value:0},x2:null!==a?{signal:r+"_x[1]"}:{field:{group:"width"}},y2:null!==o?{signal:r+"_y[1]"}:{field:{group:"height"}}};if("global"===t.resolve)for(var u=0,c=ue.keys(l);u<c.length;u++){var f=c[u];l[f]=[ae.__assign({test:s+".length && "+s+"[0].unit === "+xr.unitName(e)},l[f]),{value:0}]}var d=t.mark,p=d.fill,g=d.fillOpacity,m=ae.__rest(d,["fill","fillOpacity"]),h=ue.keys(m).reduce(function(e,t){return e[t]=[{test:[null!==a&&r+"_x[0] !== "+r+"_x[1]",null!=o&&r+"_y[0] !== "+r+"_y[1]"].filter(function(e){return e}).join(" && "),value:m[t]},{value:null}],e},{});return[{name:r+_.BRUSH+"_bg",type:"rect",clip:!0,encode:{enter:{fill:{value:p},fillOpacity:{value:g}},update:l}}].concat(n,{name:r+_.BRUSH,type:"rect",clip:!0,encode:{enter:{fill:{value:"transparent"}},update:ae.__assign({},l,h)}})}};function b(e,t,n){var r=xr.channelSignalName(t,n,"visual"),i=xr.channelSignalName(t,n,"data"),a=S.default.has(t),o=e.scaleName(n),s=oe.stringValue(o),l=e.getScaleComponent(n),u=l?l.get("type"):void 0,c=e.getSizeSignalRef(n===_e.X?"width":"height").signal,f=n+"(unit)",d=E(t,function(e,t){return e.concat({events:t.between[0],update:"["+f+", "+f+"]"},{events:t,update:"["+r+"[0], clamp("+f+", 0, "+c+")]"})});return d.push({events:{signal:t.name+_.SCALE_TRIGGER},update:De.hasContinuousDomain(u)&&!De.isBinScale(u)?"[scale("+s+", "+i+"[0]), scale("+s+", "+i+"[1])]":"[0, 0]"}),a?[{name:i,on:[]}]:[{name:r,value:[],on:d},{name:i,on:[{events:{signal:r},update:r+"[0] === "+r+"[1] ? null : invert("+s+", "+r+")"}]}]}function E(e,n){return e.events.reduce(function(e,t){return t.between?n(e,t):(de.warn(t+" is not an ordered event stream for interval selections"),e)},[])}_.default=t});t(hr);hr.BRUSH,hr.SCALE_TRIGGER;var vr=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var c=ae.__importStar(de),n={has:function(e){return"interval"!==e.type&&e.nearest},marks:function(r,e,t){var n=xr.positionalProjections(e),i=n.x,a=n.y,o=r.mark;if(ye.isPathMark(o))return c.warn(c.message.nearestNotSupportForContinuous(o)),t;var s={name:r.getName("voronoi"),type:"path",from:{data:r.getName("marks")},encode:{enter:{fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0}}},transform:[{type:"voronoi",x:{expr:i||!i&&!a?"datum.datum.x || 0":"0"},y:{expr:a||!i&&!a?"datum.datum.y || 0":"0"},size:[r.getSizeSignalRef("width"),r.getSizeSignalRef("height")]}]},l=0,u=!1;return t.forEach(function(e,t){var n=e.name||"";n===r.component.mark[0].name?l=t:0<=n.indexOf("voronoi")&&(u=!0)}),u||t.splice(l+1,0,s),t}};t.default=n});t(vr);var yr=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var l=ae.__importDefault(vr);function n(r,e){var t=e.project,i=l.default.has(e)?"(item().isVoronoi ? datum.datum : datum)":"datum",a=[],n=t.map(function(e){return oe.stringValue(e.channel)}).filter(function(e){return e}).join(", "),o=t.map(function(e){return oe.stringValue(e.field)}).join(", "),s=t.map(function(e){var t=e.channel,n=r.fieldDef(t);return n&&n.bin?(a.push(e.field),"["+ue.accessPathWithDatum(r.vgField(t,{}),i)+", "+ue.accessPathWithDatum(r.vgField(t,{binSuffix:"end"}),i)+"]"):""+ue.accessPathWithDatum(e.field,i)}).join(", ");return[{name:e.name+xr.TUPLE,value:{},on:[{events:e.events,update:"datum && item().mark.marktype !== 'group' ? {unit: "+xr.unitName(r)+", encodings: ["+n+"], fields: ["+o+"], values: ["+s+"]"+(a.length?", "+a.map(function(e){return oe.stringValue("bin_"+e)+": 1"}).join(", "):"")+"} : null",force:!0}]}]}var r={predicate:"vlMulti",scaleDomain:"vlMultiDomain",signals:t.signals=n,modifyExpr:function(e,t){return t.name+xr.TUPLE+", "+("global"===t.resolve?"null":"{unit: "+xr.unitName(e)+"}")}};t.default=r});t(yr);yr.signals;var _r=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n={predicate:"vlSingle",scaleDomain:"vlSingleDomain",signals:yr.signals,topLevelSignals:function(e,t,n){var r=n.filter(function(e){return e.name===t.name}),i="data("+oe.stringValue(t.name+xr.STORE)+")",a=i+"[0].values";return r.length?n:n.concat({name:t.name,update:i+".length && {"+t.project.map(function(e,t){return e.field+": "+a+"["+t+"]"}).join(", ")+"}"})},modifyExpr:function(e,t){return t.name+xr.TUPLE+", "+("global"===t.resolve?"true":"{unit: "+xr.unitName(e)+"}")}};t.default=n});t(_r);var Sr=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var s=ae.__importDefault(vr),n={has:function(e){return"single"===e.type&&"global"===e.resolve&&e.bind&&"scales"!==e.bind},topLevelSignals:function(e,n,r){var i=n.name,t=n.project,a=n.bind,o=s.default.has(n)?"(item().isVoronoi ? datum.datum : datum)":"datum";return t.forEach(function(e){var t=ue.varName(i+"_"+e.field);r.filter(function(e){return e.name===t}).length||r.unshift({name:t,value:"",on:[{events:n.events,update:"datum && item().mark.marktype !== 'group' ? "+ue.accessPathWithDatum(e.field,o)+" : null"}],bind:a[e.field]||a[e.channel]||a})}),r},signals:function(e,t,n){var r=t.name,i=t.project,a=n.filter(function(e){return e.name===r+xr.TUPLE})[0],o=i.map(function(e){return oe.stringValue(e.field)}).join(", "),s=i.map(function(e){return ue.varName(r+"_"+e.field)});return s.length&&(a.update=s.join(" && ")+" ? {fields: ["+o+"], values: ["+s.join(", ")+"]} : null"),delete a.value,delete a.on,n}};t.default=n});t(Sr);var br=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var l=ae.__importStar(de),n={has:function(e){var t=e;return void 0!==t.fields||void 0!==t.encodings},parse:function(r,e,t){var i={},a={};(e.fields||[]).forEach(function(e){return i[e]=null}),(e.encodings||[]).forEach(function(e){var t=r.fieldDef(e);if(t)if(t.timeUnit){var n=r.vgField(e);i[n]=e,a[n]={as:n,field:t.field,timeUnit:t.timeUnit}}else i[t.field]=e;else l.warn(l.message.cannotProjectOnChannelWithoutField(e))});var n=t.project||(t.project=[]);for(var o in i)i.hasOwnProperty(o)&&n.push({field:o,channel:i[o]});var s=t.fields||(t.fields={});n.filter(function(e){return e.channel}).forEach(function(e){return s[e.channel]=e.field}),ue.keys(a).length&&(t.timeUnit=new rr.TimeUnitNode(null,a))}};t.default=n});t(br);var Er=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n={has:function(e){return"multi"===e.type&&e.toggle},signals:function(e,t,n){return n.concat({name:t.name+"_toggle",value:!1,on:[{events:t.events,update:t.toggle}]})},modifyExpr:function(e,t,n){var r=t.name+xr.TUPLE,i=t.name+"_toggle";return i+" ? null : "+r+", "+("global"===t.resolve?i+" ? null : true, ":i+" ? null : {unit: "+xr.unitName(e)+"}, ")+i+" ? "+r+" : null"}};t.default=n});t(Er);var Nr=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var h=ae.__importStar(mr),v="_translate_anchor",y="_translate_delta",n={has:function(e){return"interval"===e.type&&e.translate},signals:function(e,t,n){var r=t.name,i=h.default.has(t),a=r+v,o=xr.positionalProjections(t),s=o.x,l=o.y,u=$e.selector(t.translate,"scope");return i||(u=u.map(function(e){return e.between[0].markname=r+hr.BRUSH,e})),n.push({name:a,value:{},on:[{events:u.map(function(e){return e.between[0]}),update:"{x: x(unit), y: y(unit)"+(null!==s?", extent_x: "+(i?h.domain(e,_e.X):"slice("+xr.channelSignalName(t,"x","visual")+")"):"")+(null!==l?", extent_y: "+(i?h.domain(e,_e.Y):"slice("+xr.channelSignalName(t,"y","visual")+")"):"")+"}"}]},{name:r+y,value:{},on:[{events:u,update:"{x: "+a+".x - x(unit), y: "+a+".y - y(unit)}"}]}),null!==s&&c(e,t,_e.X,"width",n),null!==l&&c(e,t,_e.Y,"height",n),n}};function c(e,t,n,r,i){var a=t.name,o=h.default.has(t),s=i.filter(function(e){return e.name===xr.channelSignalName(t,n,o?"data":"visual")})[0],l=a+v,u=a+y,c=e.getSizeSignalRef(r).signal,f=e.getScaleComponent(n),d=f.get("type"),p=o&&n===_e.X?"-":"",g=l+".extent_"+n,m=(o?"log"===d?"panLog":"pow"===d?"panPow":"panLinear":"panLinear")+"("+g+", "+(""+p+u+"."+n+" / "+(o?""+c:"span("+g+")"))+(o&&"pow"===d?", "+(f.get("exponent")||1):"")+")";s.on.push({events:{signal:u},update:o?m:"clampRange("+m+", 0, "+c+")"})}t.default=n});t(Nr);var Or=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var g=ae.__importStar(mr),m="_zoom_anchor",h="_zoom_delta",n={has:function(e){return"interval"===e.type&&e.zoom},signals:function(e,t,n){var r=t.name,i=g.default.has(t),a=r+h,o=xr.positionalProjections(t),s=o.x,l=o.y,u=oe.stringValue(e.scaleName(_e.X)),c=oe.stringValue(e.scaleName(_e.Y)),f=$e.selector(t.zoom,"scope");return i||(f=f.map(function(e){return e.markname=r+hr.BRUSH,e})),n.push({name:r+m,on:[{events:f,update:i?"{"+[u?"x: invert("+u+", x(unit))":"",c?"y: invert("+c+", y(unit))":""].filter(function(e){return!!e}).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:a,on:[{events:f,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),null!==s&&d(e,t,"x","width",n),null!==l&&d(e,t,"y","height",n),n}};function d(e,t,n,r,i){var a=t.name,o=g.default.has(t),s=i.filter(function(e){return e.name===xr.channelSignalName(t,n,o?"data":"visual")})[0],l=e.getSizeSignalRef(r).signal,u=e.getScaleComponent(n),c=u.get("type"),f=o?g.domain(e,n):s.name,d=a+h,p=(o?"log"===c?"zoomLog":"pow"===c?"zoomPow":"zoomLinear":"zoomLinear")+"("+f+", "+(""+a+m+"."+n)+", "+d+(o&&"pow"===c?", "+(u.get("exponent")||1):"")+")";s.on.push({events:{signal:d},update:o?p:"clampRange("+p+", 0, "+l+")"})}t.default=n});t(Or);var Tr=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=ae.__importDefault(Sr),r=ae.__importDefault(vr),i=ae.__importDefault(br),a=ae.__importDefault(mr),o=ae.__importDefault(Er),s=ae.__importDefault(Nr),l=ae.__importDefault(Or),u={project:i.default,toggle:o.default,scales:a.default,translate:s.default,zoom:l.default,inputs:n.default,nearest:r.default};t.forEachTransform=function(e,t){for(var n in u)u[n].has(e)&&t(u[n])}});t(Tr);Tr.forEachTransform;var xr=n(function(e,u){Object.defineProperty(u,"__esModule",{value:!0});var t=ae.__importDefault(hr),n=ae.__importDefault(yr),r=ae.__importDefault(_r);function i(n,r){return o(n,function(t,e){r=e.marks?e.marks(n,t,r):r,Tr.forEachTransform(t,function(e){e.marks&&(r=e.marks(n,t,r))})}),r}function o(e,t){var n=e.component.selection;for(var r in n)if(n.hasOwnProperty(r)){var i=n[r];t(i,c(i.type))}}function c(e){switch(e){case"single":return r.default;case"multi":return n.default;case"interval":return t.default}return null}function s(e){for(var t=e.parent;t&&!gr.isFacetModel(t);)t=t.parent;return t}u.STORE="_store",u.TUPLE="_tuple",u.MODIFY="_modify",u.SELECTION_DOMAIN="_selection_domain_",u.parseUnitSelection=function(a,o){var s={},l=a.config.selection,e=function(e){if(!o.hasOwnProperty(e))return"continue";var t=o[e],n=l[t.type];for(var r in n)"encodings"===r&&t.fields||"fields"===r&&t.encodings||("mark"===r&&(t[r]=ae.__assign({},n[r],t[r])),void 0!==t[r]&&!0!==t[r]||(t[r]=n[r]||t[r]));e=ue.varName(e);var i=s[e]=ae.__assign({},t,{name:e,events:oe.isString(t.on)?$e.selector(t.on,"scope"):t.on});Tr.forEachTransform(i,function(e){e.parse&&e.parse(a,t,i)})};for(var t in o)e(t);return s},u.assembleUnitSelectionSignals=function(i,a){o(i,function(t,e){var n=t.name,r=e.modifyExpr(i,t);a.push.apply(a,e.signals(i,t)),Tr.forEachTransform(t,function(e){e.signals&&(a=e.signals(i,t,a)),e.modifyExpr&&(r=e.modifyExpr(i,t,r))}),a.push({name:n+u.MODIFY,on:[{events:{signal:n+u.TUPLE},update:"modify("+oe.stringValue(t.name+u.STORE)+", "+r+")"}]})});var e=s(i);if(a.length&&e){var t=oe.stringValue(e.getName("cell"));a.unshift({name:"facet",value:{},on:[{events:$e.selector("mousemove","scope"),update:"isTuple(facet) ? facet : group("+t+").datum"}]})}return a},u.assembleTopLevelSignals=function(n,r){var i=!1;return o(n,function(t,e){e.topLevelSignals&&(r=e.topLevelSignals(n,t,r)),Tr.forEachTransform(t,function(e){e.topLevelSignals&&(r=e.topLevelSignals(n,t,r))}),i=!0}),i&&(r.filter(function(e){return"unit"===e.name}).length||r.unshift({name:"unit",value:{},on:[{events:"mousemove",update:"isTuple(group()) ? group() : unit"}]})),r},u.assembleUnitSelectionData=function(e,n){return o(e,function(t){n.filter(function(e){return e.name===t.name+u.STORE}).length||n.push({name:t.name+u.STORE})}),n},u.assembleUnitSelectionMarks=i,u.assembleLayerSelectionMarks=function(e,t){return e.children.forEach(function(e){gr.isUnitModel(e)&&(t=i(e,t))}),t},u.selectionPredicate=function(o,e,s){var l=[],t=ue.logicalExpr(e,function(e){var t=ue.varName(e),n=o.getSelectionComponent(t,e),r=oe.stringValue(t+u.STORE);if(n.timeUnit){var i=s||o.component.data.raw,a=n.timeUnit.clone();i.parent?a.insertAsParentOf(i):i.parent=a}return"none"!==n.empty&&l.push(r),c(n.type).predicate+"("+r+", datum"+("global"===n.resolve?")":", "+oe.stringValue(n.resolve)+")")});return(l.length?"!("+l.map(function(e){return"length(data("+e+"))"}).join(" || ")+") || ":"")+"("+t+")"},u.isRawSelectionDomain=function(e){return 0<=e.signal.indexOf(u.SELECTION_DOMAIN)},u.selectionScaleDomain=function(e,t){var n=JSON.parse(t.signal.replace(u.SELECTION_DOMAIN,"")),r=ue.varName(n.selection),i=e.component.selection&&e.component.selection[r];return i?(de.warn('Use "bind": "scales" to setup a binding for scales and selections within the same view.'),{signal:"null"}):(i=e.getSelectionComponent(r,n.selection),n.encoding||n.field||(n.field=i.project[0].field,1<i.project.length&&de.warn('A "field" or "encoding" must be specified when using a selection as a scale domain. Using "field": '+oe.stringValue(n.field)+".")),{signal:c(i.type).scaleDomain+"("+oe.stringValue(r+u.STORE)+", "+oe.stringValue(n.encoding||null)+", "+oe.stringValue(n.field||null)+("global"===i.resolve?")":", "+oe.stringValue(i.resolve)+")")})},u.unitName=function(e){var t=oe.stringValue(e.name),n=s(e);return n&&(t+=(n.facet.row?" + '_' + ("+ue.accessPathWithDatum(n.vgField("row"),"facet")+")":"")+(n.facet.column?" + '_' + ("+ue.accessPathWithDatum(n.vgField("column"),"facet")+")":"")),t},u.requiresSelectionId=function(e){var t=!1;return o(e,function(e){t=t||e.project.some(function(e){return e.field===ke.SELECTION_ID})}),t},u.channelSignalName=function(e,t,n){var r=e._signalNames||(e._signalNames={});if(r[t]&&r[t][n])return r[t][n];r[t]=r[t]||{};for(var i=ue.varName(e.name+"_"+("visual"===n?t:e.fields[t])),a=i,o=1;r[a];)a=i+"_"+o++;return r[a]=r[t][n]=a},u.positionalProjections=function(e){var n=null,r=null,i=null,a=null;return e.project.forEach(function(e,t){e.channel===_e.X?(n=e,r=t):e.channel===_e.Y&&(i=e,a=t)}),{x:n,xi:r,y:i,yi:a}}});t(xr);xr.STORE,xr.TUPLE,xr.MODIFY,xr.SELECTION_DOMAIN,xr.parseUnitSelection,xr.assembleUnitSelectionSignals,xr.assembleTopLevelSignals,xr.assembleUnitSelectionData,xr.assembleUnitSelectionMarks,xr.assembleLayerSelectionMarks,xr.selectionPredicate,xr.isRawSelectionDomain,xr.selectionScaleDomain,xr.unitName,xr.requiresSelectionId,xr.channelSignalName,xr.positionalProjections;var Ar=n(function(e,t){function r(e){return e&&e.selection}function c(e){return e&&!!e.field&&void 0!==e.equal}function f(e){return e&&!!e.field&&void 0!==e.lt}function d(e){return e&&!!e.field&&void 0!==e.lte}function p(e){return e&&!!e.field&&void 0!==e.gt}function g(e){return e&&!!e.field&&void 0!==e.gte}function m(e){return!!(e&&e.field&&oe.isArray(e.range)&&2===e.range.length)}function h(e){return e&&!!e.field&&(oe.isArray(e.oneOf)||oe.isArray(e.in))}function v(e){return e&&!!e.field&&void 0!==e.valid}function n(e){return h(e)||c(e)||m(e)||f(e)||p(e)||d(e)||g(e)}function y(e,t){return ve.valueExpr(e,{timeUnit:t,time:!0})}function i(e,t){void 0===t&&(t=!0);var n,r,i=e.field,a=e.timeUnit,o=a?"time("+me.fieldExpr(a,i)+")":ve.vgField(e,{expr:"datum"});if(c(e))return o+"==="+y(e.equal,a);if(f(e))return o+"<"+y(l=e.lt,a);if(p(e))return o+">"+y(s=e.gt,a);if(d(e))return o+"<="+y(l=e.lte,a);if(g(e))return o+">="+y(s=e.gte,a);if(h(e))return"indexof(["+(n=e.oneOf,r=a,n.map(function(e){return y(e,r)})).join(",")+"], "+o+") !== -1";if(v(e))return e.valid?o+"!==null&&!isNaN("+o+")":o+"===null||isNaN("+o+")";if(m(e)){var s=e.range[0],l=e.range[1];if(null!==s&&null!==l&&t)return"inrange("+o+", ["+y(s,a)+", "+y(l,a)+"])";var u=[];return null!==s&&u.push(o+" >= "+y(s,a)),null!==l&&u.push(o+" <= "+y(l,a)),0<u.length?u.join(" && "):"true"}throw new Error("Invalid field predicate: "+JSON.stringify(e))}Object.defineProperty(t,"__esModule",{value:!0}),t.isSelectionPredicate=r,t.isFieldEqualPredicate=c,t.isFieldLTPredicate=f,t.isFieldLTEPredicate=d,t.isFieldGTPredicate=p,t.isFieldGTEPredicate=g,t.isFieldRangePredicate=m,t.isFieldOneOfPredicate=h,t.isFieldValidPredicate=v,t.isFieldPredicate=n,t.expression=function(t,e,n){return ue.logicalExpr(e,function(e){return oe.isString(e)?e:r(e)?xr.selectionPredicate(t,e.selection,n):i(e)})},t.fieldFilterExpression=i,t.normalizePredicate=function(e){return n(e)&&e.timeUnit?ae.__assign({},e,{timeUnit:me.normalizeTimeUnit(e.timeUnit)}):e}});t(Ar);Ar.isSelectionPredicate,Ar.isFieldEqualPredicate,Ar.isFieldLTPredicate,Ar.isFieldLTEPredicate,Ar.isFieldGTPredicate,Ar.isFieldGTEPredicate,Ar.isFieldRangePredicate,Ar.isFieldOneOfPredicate,Ar.isFieldValidPredicate,Ar.isFieldPredicate,Ar.expression,Ar.fieldFilterExpression,Ar.normalizePredicate;var Cr=n(function(e,t){function n(e){return void 0!==e.filter}Object.defineProperty(t,"__esModule",{value:!0}),t.isFilter=n,t.isImputeSequence=function(e){return e&&void 0!==e.start&&void 0!==e.stop},t.isLookup=function(e){return void 0!==e.lookup},t.isSample=function(e){return void 0!==e.sample},t.isWindow=function(e){return void 0!==e.window},t.isFlatten=function(e){return void 0!==e.flatten},t.isCalculate=function(e){return void 0!==e.calculate},t.isBin=function(e){return!!e.bin},t.isImpute=function(e){return void 0!==e.impute},t.isTimeUnit=function(e){return void 0!==e.timeUnit},t.isAggregate=function(e){return void 0!==e.aggregate},t.isStack=function(e){return void 0!==e.stack},t.isFold=function(e){return void 0!==e.fold},t.normalizeTransform=function(e){return e.map(function(e){return n(e)?{filter:le.normalizeLogicalOperand(e.filter,Ar.normalizePredicate)}:e})}});t(Cr);Cr.isFilter,Cr.isImputeSequence,Cr.isLookup,Cr.isSample,Cr.isWindow,Cr.isFlatten,Cr.isCalculate,Cr.isBin,Cr.isImpute,Cr.isTimeUnit,Cr.isAggregate,Cr.isStack,Cr.isFold,Cr.normalizeTransform;var Dr=n(function(e,t){function l(e,t,n){var r;r="as"in e?oe.isString(e.as)?[e.as,e.as+"_end"]:[e.as[0],e.as[1]]:[ve.vgField(e,{forAs:!0}),ve.vgField(e,{binSuffix:"end",forAs:!0})];var i,a,o,s,l=ve.normalizeBin(t,void 0)||{},u=(i=l,a=e.field,Se.binToString(i)+"_"+a),c=(s=u,{signal:(o=n).getName(s+"_bins"),extentSignal:o.getName(s+"_extent")}),f=c.signal,d=c.extentSignal;return{key:u,binComponent:ae.__assign({bin:l,field:e.field,as:r},f?{signal:f}:{},d?{extentSignal:d}:{})}}Object.defineProperty(t,"__esModule",{value:!0});var n=function(r){function s(e,t){var n=r.call(this,e)||this;return n.bins=t,n}return ae.__extends(s,r),s.prototype.clone=function(){return new s(null,ue.duplicate(this.bins))},s.makeFromEncoding=function(e,o){var t=o.reduceFieldDef(function(e,t,n){if(Se.isBinning(t.bin)){var r=l(t,t.bin,o),i=r.key,a=r.binComponent;e[i]=ae.__assign({},a,e[i],function(e,t,n,r){if(ot.binRequiresRange(t,n)){var i=gr.isUnitModel(e)&&(e.axis(n)||e.legend(n))||{},a=ve.vgField(t,{expr:"datum"}),o=ve.vgField(t,{expr:"datum",binSuffix:"end"});return{formulaAs:ve.vgField(t,{binSuffix:"range",forAs:!0}),formula:ot.binFormatExpression(a,o,i.format,r)}}return{}}(o,t,n,o.config))}return e},{});return 0===ue.keys(t).length?null:new s(e,t)},s.makeFromTransform=function(e,t,n){var r,i=l(t,t.bin,n),a=i.key,o=i.binComponent;return new s(e,((r={})[a]=o,r))},s.prototype.merge=function(e){this.bins=ae.__assign({},this.bins,e.bins),e.remove()},s.prototype.producedFields=function(){var t={};return ue.vals(this.bins).forEach(function(e){e.as.forEach(function(e){return t[e]=!0})}),t},s.prototype.dependentFields=function(){var t={};return ue.vals(this.bins).forEach(function(e){t[e.field]=!0}),t},s.prototype.hash=function(){return"Bin "+ue.hash(this.bins)},s.prototype.assemble=function(){return ue.flatten(ue.vals(this.bins).map(function(e){var t=[],n=ae.__assign({type:"bin",field:e.field,as:e.as,signal:e.signal},e.bin);return!e.bin.extent&&e.extentSignal&&(t.push({type:"extent",field:e.field,signal:e.extentSignal}),n.extent={signal:e.extentSignal}),t.push(n),e.formula&&t.push({type:"formula",expr:e.formula,as:e.formulaAs}),t}))},s}(st.TransformNode);t.BinNode=n});t(Dr);Dr.BinNode;var kr=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(i){function e(e,t,n){var r=i.call(this,e)||this;return r.model=t,r.filter=n,r.expr=Ar.expression(r.model,r.filter,r),r._dependentFields=Un.getDependentFields(r.expr),r}return ae.__extends(e,i),e.prototype.clone=function(){return new e(null,this.model,ue.duplicate(this.filter))},e.prototype.dependentFields=function(){return this._dependentFields},e.prototype.assemble=function(){return{type:"filter",expr:this.expr}},e.prototype.hash=function(){return"Filter "+ue.hash(this.filter)},e}(st.TransformNode);t.FilterNode=n});t(kr);kr.FilterNode;var Pr=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(s){function e(e,t){var n=s.call(this,e)||this;n.transform=t;var r=n.transform,i=r.flatten,a=r.as,o=void 0===a?[]:a;return n.transform.as=i.map(function(e,t){return o[t]||e}),n}return ae.__extends(e,s),e.prototype.clone=function(){return new e(this.parent,ue.duplicate(this.transform))},e.prototype.producedFields=function(){var r=this;return this.transform.flatten.reduce(function(e,t,n){return e[r.transform.as[n]]=!0,e},{})},e.prototype.hash=function(){return"FlattenTransform "+ue.hash(this.transform)},e.prototype.assemble=function(){var e=this.transform;return{type:"flatten",fields:e.flatten,as:e.as}},e}(st.TransformNode);t.FlattenTransformNode=n});t(Pr);Pr.FlattenTransformNode;var wr=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(i){function e(e,t){var n=i.call(this,e)||this;n.transform=t;var r=n.transform.as||[void 0,void 0];return n.transform.as=[r[0]||"key",r[1]||"value"],n}return ae.__extends(e,i),e.prototype.clone=function(){return new e(this.parent,ue.duplicate(this.transform))},e.prototype.producedFields=function(){return this.transform.as.reduce(function(e,t){return e[t]=!0,e},{})},e.prototype.hash=function(){return"FoldTransform "+ue.hash(this.transform)},e.prototype.assemble=function(){var e=this.transform;return{type:"fold",fields:e.fold,as:e.as}},e}(st.TransformNode);t.FoldTransformNode=n});t(wr);wr.FoldTransformNode;var Fr=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(a){function o(e,t,n,r){var i=a.call(this,e)||this;return i.fields=t,i.geojson=n,i.signal=r,i}return ae.__extends(o,a),o.prototype.clone=function(){return new o(null,ue.duplicate(this.fields),this.geojson,this.signal)},o.parseAll=function(n,r){var i=0;if([[_e.LONGITUDE,_e.LATITUDE],[_e.LONGITUDE2,_e.LATITUDE2]].forEach(function(e){var t=e.map(function(e){return r.channelHasField(e)?r.fieldDef(e).field:void 0});(t[0]||t[1])&&(n=new o(n,t,null,r.getName("geojson_"+i++)))}),r.channelHasField(_e.SHAPE)){var e=r.fieldDef(_e.SHAPE);e.type===he.GEOJSON&&(n=new o(n,null,e.field,r.getName("geojson_"+i++)))}return n},o.prototype.assemble=function(){return ae.__assign({type:"geojson"},this.fields?{fields:this.fields}:{},this.geojson?{geojson:this.geojson}:{},{signal:this.signal})},o}(st.DataFlowNode);t.GeoJSONNode=n});t(Fr);Fr.GeoJSONNode;var Rr=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(a){function o(e,t,n,r){var i=a.call(this,e)||this;return i.projection=t,i.fields=n,i.as=r,i}return ae.__extends(o,a),o.prototype.clone=function(){return new o(null,this.projection,ue.duplicate(this.fields),ue.duplicate(this.as))},o.parseAll=function(r,i){return i.projectionName()&&[[_e.LONGITUDE,_e.LATITUDE],[_e.LONGITUDE2,_e.LATITUDE2]].forEach(function(e){var t=e.map(function(e){return i.channelHasField(e)?i.fieldDef(e).field:void 0}),n=e[0]===_e.LONGITUDE2?"2":"";(t[0]||t[1])&&(r=new o(r,i.projectionName(),t,[i.getName("x"+n),i.getName("y"+n)]))}),r},o.prototype.assemble=function(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}},o}(st.DataFlowNode);t.GeoPointNode=n});t(Rr);Rr.GeoPointNode;var Ir=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(t){function e(e){return t.call(this,e)||this}return ae.__extends(e,t),e.prototype.clone=function(){return new e(null)},e.prototype.producedFields=function(){var e;return(e={})[ke.SELECTION_ID]=!0,e},e.prototype.assemble=function(){return{type:"identifier",as:ke.SELECTION_ID}},e}(st.DataFlowNode);t.IdentifierNode=n});t(Ir);Ir.IdentifierNode;var Lr=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=ae.__importStar(at);t.area={vgMark:"area",encodeEntry:function(e){return ae.__assign({},n.baseEncodeEntry(e,{size:"ignore",orient:"include"}),n.pointPosition("x",e,"zeroOrMin"),n.pointPosition("y",e,"zeroOrMin"),n.pointPosition2(e,"zeroOrMin","horizontal"===e.markDef.orient?"x2":"y2"),n.defined(e))}}});t(Lr);Lr.area;var Mr=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var s=ae.__importStar(de),d=ae.__importStar(at),p=ae.__importStar(it);function g(e,t,n,r){if(void 0!==e.size)return{value:e.size};var i=ot.getMarkConfig("size",e,r,{skipGeneralMarkConfig:!0});if(void 0!==i)return{value:i};if(n){var a=n.get("type");if("point"!==a&&"band"!==a)return{value:r.bar.continuousBandSize};if(void 0!==r.bar.discreteBandSize)return{value:r.bar.discreteBandSize};if(a!==De.ScaleType.POINT)return p.bandRef(t);var o=n.get("range");if(et.isVgRangeStep(o)&&oe.isNumber(o.step))return{value:o.step-1};s.warn(s.message.BAR_WITH_POINT_SCALE_AND_RANGESTEP_NULL)}return{value:ue.getFirstDefined(r.bar.discreteBandSize,r.scale.rangeStep?r.scale.rangeStep-1:void 0,20)}}t.bar={vgMark:"rect",encodeEntry:function(e){return ae.__assign({},d.baseEncodeEntry(e,{size:"ignore",orient:"ignore"}),function(e){var t=e.config,n=e.encoding,r=e.markDef,i=e.width,a=r.orient,o=n.size,s=n.x,l=n.x2,u=e.scaleName(_e.X),c=e.getScaleComponent(_e.X);{if(ve.isFieldDef(s)&&Se.isBinned(s.bin))return d.binPosition(s,l,_e.X,u,ue.getFirstDefined(r.binSpacing,t.bar.binSpacing),c.get("reverse"));if("horizontal"===a||l)return ae.__assign({},d.pointPosition("x",e,"zeroOrMin"),d.pointPosition2(e,"zeroOrMin","x2"));if(ve.isFieldDef(s)){var f=c.get("type");if(Se.isBinning(s.bin)&&!o&&!De.hasDiscreteDomain(f))return d.binPosition(s,void 0,_e.X,e.scaleName("x"),ue.getFirstDefined(r.binSpacing,t.bar.binSpacing),c.get("reverse"));if(f===De.ScaleType.BAND)return d.bandPosition(s,"x",e)}return d.centeredBandPosition("x",e,ae.__assign({},p.mid(i)),g(r,u,c,t))}}(e),function(e){var t=e.config,n=e.encoding,r=e.height,i=e.markDef,a=i.orient,o=n.size,s=n.y,l=n.y2,u=e.scaleName(_e.Y),c=e.getScaleComponent(_e.Y);{if(ve.isFieldDef(s)&&Se.isBinned(s.bin))return d.binPosition(s,l,_e.Y,u,ue.getFirstDefined(i.binSpacing,t.bar.binSpacing),c.get("reverse"));if("vertical"===a||l)return ae.__assign({},d.pointPosition("y",e,"zeroOrMin"),d.pointPosition2(e,"zeroOrMin","y2"));if(ve.isFieldDef(s)){var f=c.get("type");if(Se.isBinning(s.bin)&&!o&&!De.hasDiscreteDomain(f))return d.binPosition(s,void 0,_e.Y,e.scaleName("y"),ue.getFirstDefined(i.binSpacing,t.bar.binSpacing),c.get("reverse"));if(f===De.ScaleType.BAND)return d.bandPosition(s,"y",e)}return d.centeredBandPosition("y",e,p.mid(r),g(i,u,c,t))}}(e))}}});t(Mr);Mr.bar;var Ur=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=ae.__importStar(at);t.geoshape={vgMark:"shape",encodeEntry:function(e){return ae.__assign({},n.baseEncodeEntry(e,{size:"ignore",orient:"ignore"}))},postEncodingTransform:function(e){var t=e.encoding.shape;return[ae.__assign({type:"geoshape",projection:e.projectionName()},t&&ve.isFieldDef(t)&&t.type===he.GEOJSON?{field:ve.vgField(t,{expr:"datum"})}:{})]}}});t(Ur);Ur.geoshape;var jr=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=ae.__importStar(at),i=ae.__importStar(it);t.line={vgMark:"line",encodeEntry:function(e){var t=e.width,n=e.height;return ae.__assign({},r.baseEncodeEntry(e,{size:"ignore",orient:"ignore"}),r.pointPosition("x",e,i.mid(t)),r.pointPosition("y",e,i.mid(n)),r.nonPosition("size",e,{vgChannel:"strokeWidth"}),r.defined(e))}},t.trail={vgMark:"trail",encodeEntry:function(e){var t=e.width,n=e.height;return ae.__assign({},r.baseEncodeEntry(e,{size:"include",orient:"ignore"}),r.pointPosition("x",e,i.mid(t)),r.pointPosition("y",e,i.mid(n)),r.nonPosition("size",e),r.defined(e))}}});t(jr);jr.line,jr.trail;var zr=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=ae.__importStar(at),s=ae.__importStar(it);function n(e,t){var n=e.config,r=e.markDef,i=e.width,a=e.height;return ae.__assign({},o.baseEncodeEntry(e,{size:"include",orient:"ignore"}),o.pointPosition("x",e,s.mid(i)),o.pointPosition("y",e,s.mid(a)),o.nonPosition("size",e,{defaultValue:ot.getMarkConfig("size",r,n)}),l(e,n,t))}function l(e,t,n){return n?{shape:{value:n}}:o.nonPosition("shape",e,{defaultValue:ot.getMarkConfig("shape",e.markDef,t)})}t.shapeMixins=l,t.point={vgMark:"symbol",encodeEntry:function(e){return n(e)}},t.circle={vgMark:"symbol",encodeEntry:function(e){return n(e,"circle")}},t.square={vgMark:"symbol",encodeEntry:function(e){return n(e,"square")}}});t(zr);zr.shapeMixins,zr.point,zr.circle,zr.square;var Br=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=ae.__importStar(de),s=ae.__importStar(at);function n(e){var t=e.encoding.x,n=e.encoding.x2,r=e.getScaleComponent(_e.X),i=r?r.get("type"):void 0,a=e.scaleName(_e.X);if(ve.isFieldDef(t)&&(Se.isBinning(t.bin)||Se.isBinned(t.bin)))return s.binPosition(t,n,_e.X,a,0,r.get("reverse"));if(ve.isFieldDef(t)&&r&&De.hasDiscreteDomain(i)){if(i===De.ScaleType.BAND)return s.bandPosition(t,"x",e);throw new Error(o.message.scaleTypeNotWorkWithMark(ye.RECT,i))}return ae.__assign({},s.pointPosition("x",e,"zeroOrMax"),s.pointPosition2(e,"zeroOrMin","x2"))}function r(e){var t=e.encoding.y,n=e.encoding.y2,r=e.getScaleComponent(_e.Y),i=r?r.get("type"):void 0,a=e.scaleName(_e.Y);if(ve.isFieldDef(t)&&(Se.isBinning(t.bin)||Se.isBinned(t.bin)))return s.binPosition(t,n,_e.Y,a,0,r.get("reverse"));if(ve.isFieldDef(t)&&r&&De.hasDiscreteDomain(i)){if(i===De.ScaleType.BAND)return s.bandPosition(t,"y",e);throw new Error(o.message.scaleTypeNotWorkWithMark(ye.RECT,i))}return ae.__assign({},s.pointPosition("y",e,"zeroOrMax"),s.pointPosition2(e,"zeroOrMin","y2"))}t.rect={vgMark:"rect",encodeEntry:function(e){return ae.__assign({},s.baseEncodeEntry(e,{size:"ignore",orient:"ignore"}),n(e),r(e))}},t.x=n,t.y=r});t(Br);Br.rect,Br.x,Br.y;var Hr=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var a=ae.__importStar(at),o=ae.__importStar(it);t.rule={vgMark:"rule",encodeEntry:function(e){var t=e.markDef,n=e.width,r=e.height,i=t.orient;return e.encoding.x||e.encoding.y||e.encoding.latitude||e.encoding.longitude?ae.__assign({},a.baseEncodeEntry(e,{size:"ignore",orient:"ignore"}),a.pointPosition("x",e,"horizontal"===i?"zeroOrMin":o.mid(n)),a.pointPosition("y",e,"vertical"===i?"zeroOrMin":o.mid(r)),"vertical"!==i?a.pointPosition2(e,"zeroOrMax","x2"):{},"horizontal"!==i?a.pointPosition2(e,"zeroOrMax","y2"):{},a.nonPosition("size",e,{vgChannel:"strokeWidth",defaultValue:t.size})):{}}}});t(Hr);Hr.rule;var Gr=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var o=ae.__importStar(at),s=ae.__importStar(it);t.text={vgMark:"text",encodeEntry:function(e){var t=e.config,n=(e.encoding,e.width),r=e.height,i=e.markDef,a=ue.getFirstDefined(i.fontSize,i.size,ot.getStyleConfig("fontSize",i,t.style),ot.getStyleConfig("size",i,t.style),t[i.type].fontSize,t[i.type].size);return ae.__assign({},o.baseEncodeEntry(e,{size:"ignore",orient:"ignore"}),o.pointPosition("x",e,s.mid(n)),o.pointPosition("y",e,s.mid(r)),o.text(e),o.nonPosition("size",e,{defaultValue:a,vgChannel:"fontSize"}),o.valueIfDefined("align",function(e,t,n){if(void 0===(e.align||ot.getMarkConfig("align",e,n)))return"center";return}(e.markDef,0,t)))}}});t(Gr);Gr.text;var qr=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var u=ae.__importStar(at),c=ae.__importStar(it);t.tick={vgMark:"rect",encodeEntry:function(e){var t,n=e.config,r=e.markDef,i=e.width,a=e.height,o=r.orient,s="horizontal"===o?"width":"height",l="horizontal"===o?"height":"width";return ae.__assign({},u.baseEncodeEntry(e,{size:"ignore",orient:"ignore"}),u.pointPosition("x",e,c.mid(i),"xc"),u.pointPosition("y",e,c.mid(a),"yc"),u.nonPosition("size",e,{defaultValue:function(e){var t=e.config,n=e.markDef,r=n.orient,i=e.getScaleComponent("horizontal"===r?"x":"y");{if(void 0!==n.size)return n.size;if(void 0!==t.tick.bandSize)return t.tick.bandSize;var a=i?i.get("range"):void 0,o=a&&et.isVgRangeStep(a)?a.step:t.scale.rangeStep;if("number"!=typeof o)throw new Error("Function does not handle non-numeric rangeStep");return o/1.5}}(e),vgChannel:s}),((t={})[l]={value:ue.getFirstDefined(r.thickness,n.tick.thickness)},t))}}});t(qr);qr.tick;var Wr=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var f={area:Lr.area,bar:Mr.bar,circle:zr.circle,geoshape:Ur.geoshape,line:jr.line,point:zr.point,rect:Br.rect,rule:Hr.rule,square:zr.square,text:Gr.text,tick:qr.tick,trail:jr.trail};t.parseMarkGroup=function(e){return ue.contains([ye.LINE,ye.AREA,ye.TRAIL],e.mark)?(n=o((t=e).mark,t.encoding),r=a(t,{fromPrefix:0<n.length?i:""}),0<n.length?[{name:t.getName("pathgroup"),type:"group",from:{facet:{name:i+t.requestDataName(Me.MAIN),data:t.requestDataName(Me.MAIN),groupby:n}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:r}]:r):a(e);var t,n,r};var i="faceted_path_";function d(e){var t=e.encoding,n=e.stack,r=e.mark,i=e.markDef,a=t.order;if(oe.isArray(a)||!ve.isValueDef(a)){if((oe.isArray(a)||ve.isFieldDef(a))&&!n)return ot.sortParams(a,{expr:"datum"});if(ye.isPathMark(r)){var o=t["horizontal"===i.orient?"y":"x"];if(ve.isFieldDef(o)){var s=o.sort;return{field:rt.isSortField(s)?ve.vgField({aggregate:be.isAggregate(e.encoding)?s.op:void 0,field:s.field},{expr:"datum"}):ve.vgField(o,{binSuffix:e.stack&&e.stack.impute?"mid":void 0,expr:"datum"}),order:"descending"}}}else;}}function a(e,t){void 0===t&&(t={fromPrefix:""});var n,r,i,a=e.mark,o=ue.getFirstDefined(e.markDef.clip,(r=(n=e).getScaleComponent("x"),i=n.getScaleComponent("y"),!!(r&&r.get("domainRaw")||i&&i.get("domainRaw")))),s=ot.getStyles(e.markDef),l=e.encoding.key,u=d(e),c=f[a].postEncodingTransform?f[a].postEncodingTransform(e):null;return[ae.__assign({name:e.getName("marks"),type:f[a].vgMark},o?{clip:!0}:{},s?{style:s}:{},l?{key:{field:l.field}}:{},u?{sort:u}:{},{from:{data:t.fromPrefix+e.requestDataName(Me.MAIN)},encode:{update:f[a].encodeEntry(e)}},c?{transform:c}:{})]}function o(i,a){return ue.keys(a).reduce(function(t,e){switch(e){case"x":case"y":case"order":case"href":case"x2":case"y2":case"latitude":case"longitude":case"latitude2":case"longitude2":case"text":case"shape":return t;case"tooltip":case"detail":case"key":var n=a[e];return(oe.isArray(n)||ve.isFieldDef(n))&&(oe.isArray(n)?n:[n]).forEach(function(e){e.aggregate||t.push(ve.vgField(e,{}))}),t;case"size":if("trail"===i)return t;case"color":case"fill":case"stroke":case"opacity":var r=ve.getFieldDef(a[e]);return r&&!r.aggregate&&t.push(ve.vgField(r,{})),t;default:throw new Error("Bug: Channel "+e+" unimplemented for line mark")}},[])}t.getSort=d,t.pathGroupingFields=o});t(Wr);Wr.parseMarkGroup,Wr.getSort,Wr.pathGroupingFields;var Yr=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(r){function p(e,t){var n=r.call(this,e)||this;return n.transform=t,n}return ae.__extends(p,r),p.prototype.clone=function(){return new p(this.parent,ue.duplicate(this.transform))},p.prototype.producedFields=function(){var e;return(e={})[this.transform.impute]=!0,e},p.prototype.processSequence=function(e){var t=e.start,n=void 0===t?0:t,r=e.stop,i=e.step;return{signal:"sequence("+[n,r].concat(i?[i]:[]).join(",")+")"}},p.makeFromTransform=function(e,t){return new p(e,t)},p.makeFromEncoding=function(e,t){var n=t.encoding,r=n.x,i=n.y;if(ve.isFieldDef(r)&&ve.isFieldDef(i)){var a=r.impute?r:i.impute?i:void 0;if(void 0===a)return;var o=r.impute?i:i.impute?r:void 0,s=a.impute,l=s.method,u=s.value,c=s.frame,f=s.keyvals,d=Wr.pathGroupingFields(t.mark,n);return new p(e,ae.__assign({impute:a.field,key:o.field},l?{method:l}:{},void 0!==u?{value:u}:{},c?{frame:c}:{},void 0!==f?{keyvals:f}:{},d.length?{groupby:d}:{}))}return null},p.prototype.hash=function(){return"Impute "+ue.hash(this.transform)},p.prototype.assemble=function(){var e,t=this.transform,n=t.impute,r=t.key,i=t.keyvals,a=t.method,o=t.groupby,s=t.value,l=t.frame,u=void 0===l?[null,null]:l,c=ae.__assign({type:"impute",field:n,key:r},i?{keyvals:Cr.isImputeSequence(i)?this.processSequence(i):i}:{},{method:"value"},o?{groupby:o}:{},{value:null});a&&"value"!==a?e=[ae.__assign({type:"window",as:["imputed_"+n+"_value"],ops:[a],fields:[n],frame:u,ignorePeers:!1},o?{groupby:o}:{}),{type:"formula",expr:"datum."+n+" === null ? datum.imputed_"+n+"_value : datum."+n,as:n}]:e=[{type:"formula",expr:"datum."+n+" === null ? "+s+" : datum."+n,as:n}];return[c].concat(e)},p}(st.TransformNode);t.ImputeNode=n});t(Yr);Yr.ImputeNode;var Vr=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(i){function e(e,t,n){void 0===e&&(e={}),void 0===t&&(t={}),void 0===n&&(n=!1);var r=i.call(this,e,t)||this;return r.explicit=e,r.implicit=t,r.parseNothing=n,r}return ae.__extends(e,i),e.prototype.clone=function(){var e=i.prototype.clone.call(this);return e.parseNothing=this.parseNothing,e},e}(Gn.Split);t.AncestorParse=n});t(Vr);Vr.AncestorParse;var Xr=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=ae.__importStar(de),r=function(i){function u(e,t,n){var r=i.call(this,e)||this;return r.transform=t,r.secondary=n,r}return ae.__extends(u,i),u.make=function(e,t,n,r){var i=t.component.data.sources,a=new nr.SourceNode(n.from.data),o=i[a.hash()];o||(o=i[a.hash()]=a);var s=t.getName("lookup_"+r),l=new st.OutputNode(o,s,"lookup",t.component.data.outputNodeRefCounts);return new u(e,n,(t.component.data.outputNodes[s]=l).getSource())},u.prototype.producedFields=function(){return oe.toSet(this.transform.from.fields||(this.transform.as instanceof Array?this.transform.as:[this.transform.as]))},u.prototype.hash=function(){return"Lookup "+ue.hash({transform:this.transform,secondary:this.secondary})},u.prototype.assemble=function(){var e;if(this.transform.from.fields)e=ae.__assign({values:this.transform.from.fields},this.transform.as?{as:this.transform.as instanceof Array?this.transform.as:[this.transform.as]}:{});else{var t=this.transform.as;oe.isString(t)||(n.warn(n.message.NO_FIELDS_NEEDS_AS),t="_lookup"),e={as:[t]}}return ae.__assign({type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup]},e,this.transform.default?{default:this.transform.default}:{})},u}(st.TransformNode);t.LookupNode=r});t(Xr);Xr.LookupNode;var Kr=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(r){function e(e,t){var n=r.call(this,e)||this;return n.transform=t,n}return ae.__extends(e,r),e.prototype.clone=function(){return new e(this.parent,ue.duplicate(this.transform))},e.prototype.hash=function(){return"SampleTransform "+ue.hash(this.transform)},e.prototype.assemble=function(){return{type:"sample",size:this.transform.sample}},e}(st.TransformNode);t.SampleTransformNode=n});t(Kr);Kr.SampleTransformNode;var Qr=n(function(e,t){function h(i){var a=0;return function t(e,n){e instanceof nr.SourceNode&&(Me.isUrlData(e.data)||(i.push(n),n={name:null,source:n.name,transform:[]}));if(e instanceof tr.ParseNode&&(e.parent instanceof nr.SourceNode&&!n.source?(n.format=ae.__assign({},n.format||{},{parse:e.assembleFormatParse()}),n.transform=n.transform.concat(e.assembleTransforms(!0))):n.transform=n.transform.concat(e.assembleTransforms())),e instanceof er.FacetNode)return n.name||(n.name="data_"+a++),!n.source||0<n.transform.length?(i.push(n),e.data=n.name):e.data=n.source,void e.assemble().forEach(function(e){return i.push(e)});(e instanceof kr.FilterNode||e instanceof jn.CalculateNode||e instanceof Rr.GeoPointNode||e instanceof Fr.GeoJSONNode||e instanceof $n.AggregateNode||e instanceof Xr.LookupNode||e instanceof ei.WindowTransformNode||e instanceof wr.FoldTransformNode||e instanceof Pr.FlattenTransformNode||e instanceof Ir.IdentifierNode||e instanceof Kr.SampleTransformNode)&&n.transform.push(e.assemble()),(e instanceof Dr.BinNode||e instanceof rr.TimeUnitNode||e instanceof Yr.ImputeNode||e instanceof ar.StackNode)&&(n.transform=n.transform.concat(e.assemble())),e instanceof $n.AggregateNode&&(n.name||(n.name="data_"+a++)),e instanceof st.OutputNode&&(n.source&&0===n.transform.length?e.setSource(n.source):e.parent instanceof st.OutputNode?e.setSource(n.name):(n.name||(n.name="data_"+a++),e.setSource(n.name),1===e.numChildren()&&(i.push(n),n={name:null,source:n.name,transform:[]})));switch(e.numChildren()){case 0:e instanceof st.OutputNode&&(!n.source||0<n.transform.length)&&i.push(n);break;case 1:t(e.children[0],n);break;default:n.name||(n.name="data_"+a++);var r=n.name;!n.source||0<n.transform.length?i.push(n):r=n.source,e.children.forEach(function(e){t(e,{name:null,source:r,transform:[]})})}}}Object.defineProperty(t,"__esModule",{value:!0}),t.debug=function e(t){console.log(t.constructor.name+(t.debugName?" ("+t.debugName+")":"")+" -> "+t.children.map(function(e){return e.constructor.name+(e.debugName?" ("+e.debugName+")":"")})),console.log(t),t.children.forEach(e)},t.assembleFacetData=function(t){var e=[],n=h(e);return t.children.forEach(function(e){return n(e,{source:t.name,name:null,transform:[]})}),e},t.assembleRootData=function(e,t){var n=ue.vals(e.sources),r=[],i=h(r),a=0;n.forEach(function(e){e.hasName()||(e.dataName="source_"+a++);var t=e.assemble();i(e,t)}),r.forEach(function(e){0===e.transform.length&&delete e.transform});for(var o=0,s=0;s<r.length;s++)0!==((m=r[s]).transform||[]).length||m.source||r.splice(o++,0,r.splice(s,1)[0]);for(var l=0,u=r;l<u.length;l++)for(var c=0,f=(m=u[l]).transform||[];c<f.length;c++){var d=f[c];"lookup"===d.type&&(d.from=e.outputNodes[d.from].getSource())}for(var p=0,g=r;p<g.length;p++){var m;(m=g[p]).name in t&&(m.values=t[m.name])}return r}});t(Qr);Qr.debug,Qr.assembleFacetData,Qr.assembleRootData;var Jr=n(function(e,t){function n(e){r(e);var t=e.component.layoutSize;t.setWithExplicit("width",i(e,"width")),t.setWithExplicit("height",i(e,"height"))}function r(e){for(var t=0,n=e.children;t<n.length;t++){n[t].parseLayoutSize()}}function i(e,t){for(var n,r="width"===t?"x":"y",i=e.component.resolve,a=0,o=e.children;a<o.length;a++){var s=(f=o[a]).component.layoutSize.getWithExplicit(t),l=i.scale[r];if("independent"===l&&"range-step"===s.value){n=void 0;break}if(n){if("independent"===l&&n.value!==s.value){n=void 0;break}n=Gn.mergeValuesWithExplicit(n,s,t,"")}else n=s}if(n){for(var u=0,c=e.children;u<c.length;u++){var f=c[u];e.renameLayoutSize(f.getName(t),e.getName(t)),f.component.layoutSize.set(t,"merged",!1)}return n}return{explicit:!1,value:void 0}}function a(e,t){var n="width"===t?"x":"y",r=e.config,i=e.getScaleComponent(n);if(i){var a=i.get("type"),o=i.get("range");return De.hasDiscreteDomain(a)&&et.isVgRangeStep(o)?"range-step":r.view[t]}return e.hasProjection?r.view[t]:"width"===t&&"text"===e.mark?r.scale.textXRangeStep:r.scale.rangeStep||De.defaultScaleConfig.rangeStep}Object.defineProperty(t,"__esModule",{value:!0}),t.parseLayerLayoutSize=n,t.parseRepeatLayoutSize=n,t.parseConcatLayoutSize=function(e){r(e);var t=e.component.layoutSize,n=e.isVConcat?"width":"height";t.setWithExplicit(n,i(e,n))},t.parseChildrenLayoutSize=r,t.parseUnitLayoutSize=function(e){var t=e.component.layoutSize;if(!t.explicit.width){var n=a(e,"width");t.set("width",n,!1)}if(!t.explicit.height){var r=a(e,"height");t.set("height",r,!1)}}});t(Jr);Jr.parseLayerLayoutSize,Jr.parseRepeatLayoutSize,Jr.parseConcatLayoutSize,Jr.parseChildrenLayoutSize,Jr.parseUnitLayoutSize;var Zr=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=ae.__importStar(de);function r(e,t){return ve.isRepeatRef(e.field)?e.field.repeat in t?ae.__assign({},e,{field:t[e.field.repeat]}):void n.warn(n.message.noSuchRepeatedValue(e.field.repeat)):e}function i(e,t){if(void 0!==(e=r(e,t))){if(e.sort&&rt.isSortField(e.sort)){var n=r(e.sort,t);e=ae.__assign({},e,n?{sort:n}:{})}return e}}function o(e,t){if(!ve.isFieldDef(e)){if(ve.hasConditionalFieldDef(e)){if(n=i(e.condition,t))return ae.__assign({},e,{condition:n});e.condition;return ae.__rest(e,["condition"])}return e}var n;return(n=i(e,t))?n:ve.isConditionalDef(e)?{condition:e.condition}:void 0}function a(e,t){var n={};for(var r in e)if(e.hasOwnProperty(r)){var i=e[r];if(oe.isArray(i))n[r]=i.map(function(e){return o(e,t)}).filter(function(e){return e});else{var a=o(i,t);a&&(n[r]=a)}}return n}t.replaceRepeaterInFacet=function(e,t){return a(e,t)},t.replaceRepeaterInEncoding=function(e,t){return a(e,t)}});t(Zr);Zr.replaceRepeaterInFacet,Zr.replaceRepeaterInEncoding;var $r=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var d=ae.__importStar(de);function p(e,t,n){return ve.vgField(t,ae.__assign({suffix:"by_"+ve.vgField(e)},n||{}))}t.facetSortFieldName=p;var n=function(s){function f(e,t,n,r,i){var a=s.call(this,e,t,n,i,r,e.resolve)||this;a.type="facet",a.child=pi.buildModel(e.spec,a,a.getName("child"),void 0,r,i,!1),a.children=[a.child];var o=Zr.replaceRepeaterInFacet(e.facet,r);return a.facet=a.initFacet(o),a}return ae.__extends(f,s),f.prototype.initFacet=function(e){return be.reduce(e,function(e,t,n){return ue.contains([_e.ROW,_e.COLUMN],n)?void 0===t.field?d.warn(d.message.emptyFieldDef(t,n)):e[n]=ve.normalize(t,n):d.warn(d.message.incompatibleChannel(n,"facet")),e},{})},f.prototype.channelHasField=function(e){return!!this.facet[e]},f.prototype.fieldDef=function(e){return this.facet[e]},f.prototype.parseData=function(){this.component.data=ti.parseData(this),this.child.parseData()},f.prototype.parseLayoutSize=function(){Jr.parseChildrenLayoutSize(this)},f.prototype.parseSelection=function(){this.child.parseSelection(),this.component.selection=this.child.component.selection},f.prototype.parseMarkGroup=function(){this.child.parseMarkGroup()},f.prototype.parseAxisAndHeader=function(){this.child.parseAxisAndHeader(),this.parseHeader("column"),this.parseHeader("row"),this.mergeChildAxis("x"),this.mergeChildAxis("y")},f.prototype.parseHeader=function(e){if(this.channelHasField(e)){var t=this.facet[e],n=ve.title(t,this.config,{allowDisabling:!0});this.child.component.layoutHeaders[e].title&&(n+=" / "+this.child.component.layoutHeaders[e].title,this.child.component.layoutHeaders[e].title=null),this.component.layoutHeaders[e]={title:n,facetFieldDef:t,header:[this.makeHeaderComponent(e,!0)]}}},f.prototype.makeHeaderComponent=function(e,t){var n="row"===e?"height":"width";return{labels:t,sizeSignal:this.child.component.layoutSize.get(n)?this.child.getSizeSignalRef(n):void 0,axes:[]}},f.prototype.mergeChildAxis=function(e){var t=this.child;if(t.component.axes[e]){var n=this.component,r=n.layoutHeaders,i=n.resolve;if(i.axis[e]=Hn.parseGuideResolve(i,e),"shared"===i.axis[e])for(var a="x"===e?"column":"row",o=r[a],s=0,l=t.component.axes[e];s<l.length;s++){var u=l[s],c=zn.getHeaderType(u.get("orient"));o[c]=o[c]||[this.makeHeaderComponent(a,!1)];var f=tt.assembleAxis(u,"main",this.config,{header:!0});o[c][0].axes.push(f),u.mainExtracted=!0}}},f.prototype.assembleSelectionTopLevelSignals=function(e){return this.child.assembleSelectionTopLevelSignals(e)},f.prototype.assembleSelectionSignals=function(){return this.child.assembleSelectionSignals(),[]},f.prototype.assembleSelectionData=function(e){return this.child.assembleSelectionData(e)},f.prototype.getHeaderLayoutMixins=function(){var o=this,s={};return["row","column"].forEach(function(a){["header","footer"].forEach(function(e){var t=o.component.layoutHeaders[a],n=t[e];if(n&&n[0]){var r="row"===a?"height":"width",i="header"===e?"headerBand":"footerBand";o.child.component.layoutSize.get(r)||(s[i]=s[i]||{},s[i][a]=.5),t.title&&(s.offset=s.offset||{},s.offset["row"===a?"rowTitle":"columnTitle"]=10)}})}),s},f.prototype.assembleDefaultLayout=function(){var e=this.channelHasField("column")?this.columnDistinctSignal():1;return ae.__assign({},this.getHeaderLayoutMixins(),{columns:e,bounds:"full",align:"all"})},f.prototype.assembleLayoutSignals=function(){return this.child.assembleLayoutSignals()},f.prototype.columnDistinctSignal=function(){if(!(this.parent&&this.parent instanceof f))return{signal:"length(data('"+this.getName("column_domain")+"'))"}},f.prototype.assembleGroup=function(e){return this.parent&&this.parent instanceof f?ae.__assign({},this.channelHasField("column")?{encode:{update:{columns:{field:ve.vgField(this.facet.column,{prefix:"distinct"})}}}}:{},s.prototype.assembleGroup.call(this,e)):s.prototype.assembleGroup.call(this,e)},f.prototype.getCardinalityAggregateForChild=function(){var e=[],t=[],n=[];if(this.child instanceof f){if(this.child.channelHasField("column")){var r=ve.vgField(this.child.facet.column);e.push(r),t.push("distinct"),n.push("distinct_"+r)}}else for(var i=0,a=["x","y"];i<a.length;i++){var o=a[i],s=this.child.component.scales[o];if(s&&!s.merged){var l=s.get("type"),u=s.get("range");if(De.hasDiscreteDomain(l)&&et.isVgRangeStep(u)){var c=sr.assembleDomain(this.child,o);(r=sr.getFieldFromDomain(c))?(e.push(r),t.push("distinct"),n.push("distinct_"+r)):d.warn("Unknown field for ${channel}.  Cannot calculate view size.")}}}return{fields:e,ops:t,as:n}},f.prototype.assembleFacet=function(){var o=this,e=this.component.data.facetRoot,t=e.name,n=e.data,r=this.facet,s=r.row,l=r.column,i=this.getCardinalityAggregateForChild(),u=i.fields,c=i.ops,f=i.as,d=[];["row","column"].forEach(function(e){var t=o.facet[e];if(t){d.push(ve.vgField(t));var n=t.sort;if(rt.isSortField(n)){var r=n.field,i=n.op,a=p(t,n);s&&l?(u.push(a),c.push("max")):(u.push(r),c.push(i)),f.push(a)}else if(oe.isArray(n)){a=jn.sortArrayIndexField(t,e);u.push(a),c.push("max"),f.push(a)}}});var a=!!s&&!!l;return ae.__assign({name:t,data:n,groupby:d},a||u.length?{aggregate:ae.__assign({},a?{cross:a}:{},u.length?{fields:u,ops:c,as:f}:{})}:{})},f.prototype.headerSortFields=function(e){var t=this.facet[e];return t?rt.isSortField(t.sort)?[p(t,t.sort,{expr:"datum"})]:oe.isArray(t.sort)?[jn.sortArrayIndexField(t,e,{expr:"datum"})]:[ve.vgField(t,{expr:"datum"})]:[]},f.prototype.headerSortOrder=function(e){var t=this.facet[e];if(t){var n=t.sort;return[(rt.isSortField(n)?n.order:!oe.isArray(n)&&n)||"ascending"]}return[]},f.prototype.assembleMarks=function(){var e=this.child,t=this.component.data.facetRoot,n=Qr.assembleFacetData(t),r=e.assembleLayoutSize(),i=e.assembleTitle(),a=e.assembleGroupStyle();return[ae.__assign({name:this.getName("cell"),type:"group"},i?{title:i}:{},a?{style:a}:{},{from:{facet:this.assembleFacet()},sort:{field:this.headerSortFields("row").concat(this.headerSortFields("column")),order:this.headerSortOrder("row").concat(this.headerSortOrder("column"))}},0<n.length?{data:n}:{},r?{encode:{update:r}}:{},e.assembleGroup())]},f.prototype.getMapping=function(){return this.facet},f}(gr.ModelWithField);t.FacetModel=n});t($r);$r.facetSortFieldName,$r.FacetModel;var ei=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(r){function c(e,t){var n=r.call(this,e)||this;return n.transform=t,n}return ae.__extends(c,r),c.makeFromFacet=function(e,t){var n=t.row,r=t.column;if(n&&r){for(var i=null,a=0,o=[n,r];a<o.length;a++){var s=o[a];if(rt.isSortField(s.sort)){var l=s.sort,u=l.field;e=i=new c(e,{window:[{op:l.op,field:u,as:$r.facetSortFieldName(s,s.sort,{forAs:!0})}],groupby:[ve.vgField(s)],frame:[null,null]})}}return i}return null},c.prototype.clone=function(){return new c(this.parent,ue.duplicate(this.transform))},c.prototype.producedFields=function(){var t=this,n={};return this.transform.window.forEach(function(e){n[t.getDefaultName(e)]=!0}),n},c.prototype.getDefaultName=function(e){return e.as||ve.vgField(e)},c.prototype.hash=function(){return"WindowTransform "+ue.hash(this.transform)},c.prototype.assemble=function(){for(var e=[],t=[],n=[],r=[],i=0,a=this.transform.window;i<a.length;i++){var o=a[i];t.push(o.op),n.push(this.getDefaultName(o)),r.push(void 0===o.param?null:o.param),e.push(void 0===o.field?null:o.field)}var s=this.transform.frame,l=this.transform.groupby,u=[],c=[];if(void 0!==this.transform.sort)for(var f=0,d=this.transform.sort;f<d.length;f++){var p=d[f];u.push(p.field),c.push(p.order||"ascending")}var g={field:u,order:c},m=this.transform.ignorePeers,h={type:"window",params:r,as:n,ops:t,fields:e,sort:g};return void 0!==m&&(h.ignorePeers=m),void 0!==l&&(h.groupby=l),void 0!==s&&(h.frame=s),h},c}(st.TransformNode);t.WindowTransformNode=n});t(ei);ei.WindowTransformNode;var ti=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var c=ae.__importStar(de);function g(o,s,l){var u=0;return s.transforms.forEach(function(e){var t,n=void 0;if(Cr.isCalculate(e))t=o=new jn.CalculateNode(o,e),n="derived";else if(Cr.isFilter(e))t=o=tr.ParseNode.makeImplicitFromFilterTransform(o,e,l)||o,o=new kr.FilterNode(o,s,e.filter);else if(Cr.isBin(e))t=o=Dr.BinNode.makeFromTransform(o,e,s),n="number";else if(Cr.isTimeUnit(e))t=o=rr.TimeUnitNode.makeFromTransform(o,e),n="date";else if(Cr.isAggregate(e))t=o=$n.AggregateNode.makeFromTransform(o,e),n="number",xr.requiresSelectionId(s)&&(o=new Ir.IdentifierNode(o));else if(Cr.isLookup(e))t=o=Xr.LookupNode.make(o,s,e,u++),n="derived";else if(Cr.isWindow(e))t=o=new ei.WindowTransformNode(o,e),n="number";else if(Cr.isStack(e))t=o=ar.StackNode.makeFromTransform(o,e),n="derived";else if(Cr.isFold(e))t=o=new wr.FoldTransformNode(o,e),n="derived";else if(Cr.isFlatten(e))t=o=new Pr.FlattenTransformNode(o,e),n="derived";else if(Cr.isSample(e))o=new Kr.SampleTransformNode(o,e);else{if(!Cr.isImpute(e))return void c.warn(c.message.invalidTransformIgnored(e));t=o=Yr.ImputeNode.makeFromTransform(o,e),n="derived"}if(t&&void 0!==n)for(var r=0,i=ue.keys(t.producedFields());r<i.length;r++){var a=i[r];l.set(a,n,!1)}}),o}t.parseTransformArray=g,t.parseData=function(e){var t=function(e,t){if(e.data||!e.parent){var n=new nr.SourceNode(e.data),r=n.hash();return r in t?t[r]:t[r]=n}return e.parent.component.data.facetRoot?e.parent.component.data.facetRoot:e.parent.component.data.main}(e,e.component.data.sources),n=e.component.data,r=n.outputNodes,i=n.outputNodeRefCounts,a=e.parent?e.parent.component.data.ancestorParse.clone():new Vr.AncestorParse;e.data&&e.data.format&&null===e.data.format.parse&&(a.parseNothing=!0),t=tr.ParseNode.makeExplicit(t,e,a)||t,xr.requiresSelectionId(e)&&(gr.isUnitModel(e)||gr.isLayerModel(e))&&(t=new Ir.IdentifierNode(t));var o=e.parent&&gr.isLayerModel(e.parent);(gr.isUnitModel(e)||gr.isFacetModel(e))&&o&&(t=Dr.BinNode.makeFromEncoding(t,e)||t),0<e.transforms.length&&(t=g(t,e,a)),t=tr.ParseNode.makeImplicitFromEncoding(t,e,a)||t,gr.isUnitModel(e)&&(t=Fr.GeoJSONNode.parseAll(t,e),t=Rr.GeoPointNode.parseAll(t,e)),(gr.isUnitModel(e)||gr.isFacetModel(e))&&(o||(t=Dr.BinNode.makeFromEncoding(t,e)||t),t=rr.TimeUnitNode.makeFromEncoding(t,e)||t,t=jn.CalculateNode.parseAllForSortIndex(t,e));var s=e.getName(Me.RAW),l=new st.OutputNode(t,s,Me.RAW,i);if(t=r[s]=l,gr.isUnitModel(e)){var u=$n.AggregateNode.makeFromEncoding(t,e);u&&(t=u,xr.requiresSelectionId(e)&&(t=new Ir.IdentifierNode(t))),t=Yr.ImputeNode.makeFromEncoding(t,e)||t,t=ar.StackNode.makeFromEncoding(t,e)||t}var c=e.getName(Me.MAIN),f=new st.OutputNode(t,c,Me.MAIN,i);t=r[c]=f;var d=null;if(gr.isFacetModel(e)){var p=e.getName("facet");t=jn.CalculateNode.parseAllForSortIndex(t,e),t=ei.WindowTransformNode.makeFromFacet(t,e.facet)||t,d=new er.FacetNode(t,e,p,f.getSource()),t=r[p]=d}return ae.__assign({},e.component.data,{outputNodes:r,outputNodeRefCounts:i,raw:l,main:f,facetRoot:d,ancestorParse:a})}});t(ti);ti.parseTransformArray,ti.parseData;var ni=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(o){function e(e,t,n,r,i,a){return o.call(this,e,t,n,r,i,a)||this}return ae.__extends(e,o),e.prototype.parseData=function(){this.component.data=ti.parseData(this),this.children.forEach(function(e){e.parseData()})},e.prototype.parseSelection=function(){var n=this;this.component.selection={};for(var e=function(t){t.parseSelection(),ue.keys(t.component.selection).forEach(function(e){n.component.selection[e]=t.component.selection[e]})},t=0,r=this.children;t<r.length;t++){e(r[t])}},e.prototype.parseMarkGroup=function(){for(var e=0,t=this.children;e<t.length;e++){t[e].parseMarkGroup()}},e.prototype.parseAxisAndHeader=function(){for(var e=0,t=this.children;e<t.length;e++){t[e].parseAxisAndHeader()}},e.prototype.assembleSelectionTopLevelSignals=function(e){return this.children.reduce(function(e,t){return t.assembleSelectionTopLevelSignals(e)},e)},e.prototype.assembleSelectionSignals=function(){return this.children.forEach(function(e){return e.assembleSelectionSignals()}),[]},e.prototype.assembleLayoutSignals=function(){return this.children.reduce(function(e,t){return e.concat(t.assembleLayoutSignals())},Bn.assembleLayoutSignals(this))},e.prototype.assembleSelectionData=function(e){return this.children.reduce(function(e,t){return t.assembleSelectionData(e)},e)},e.prototype.assembleMarks=function(){return this.children.map(function(e){var t=e.assembleTitle(),n=e.assembleGroupStyle(),r=e.assembleLayoutSize();return ae.__assign({type:"group",name:e.getName("group")},t?{title:t}:{},n?{style:n}:{},r?{encode:{update:r}}:{},e.assembleGroup())})},e}(gr.Model);t.BaseConcatModel=n});t(ni);ni.BaseConcatModel;var ri=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var s=ae.__importStar(de),n=function(o){function e(e,t,n,r,i){var a=o.call(this,e,t,n,i,r,e.resolve)||this;return a.type="concat",e.resolve&&e.resolve.axis&&("shared"===e.resolve.axis.x||"shared"===e.resolve.axis.y)&&s.warn(s.message.CONCAT_CANNOT_SHARE_AXIS),a.isVConcat=Ie.isVConcatSpec(e),a.children=(Ie.isVConcatSpec(e)?e.vconcat:e.hconcat).map(function(e,t){return pi.buildModel(e,a,a.getName("concat_"+t),void 0,r,i,!1)}),a}return ae.__extends(e,o),e.prototype.parseLayoutSize=function(){Jr.parseConcatLayoutSize(this)},e.prototype.parseAxisGroup=function(){return null},e.prototype.assembleDefaultLayout=function(){return ae.__assign({},this.isVConcat?{columns:1}:{},{bounds:"full",align:"each"})},e}(ni.BaseConcatModel);t.ConcatModel=n});t(ri);ri.ConcatModel;var ii=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(i){function e(e,t,n){void 0===e&&(e={}),void 0===t&&(t={}),void 0===n&&(n=!1);var r=i.call(this)||this;return r.explicit=e,r.implicit=t,r.mainExtracted=n,r}return ae.__extends(e,i),e.prototype.clone=function(){return new e(ue.duplicate(this.explicit),ue.duplicate(this.implicit),this.mainExtracted)},e.prototype.hasAxisPart=function(e){return"axis"===e||("grid"===e||"title"===e?!!this.get(e):!(!1===(t=this.get(e))||null===t));var t},e}(Gn.Split);t.AxisComponent=n});t(ii);ii.AxisComponent;var ai=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.getAxisConfig=function(e,t,n,r,i){void 0===r&&(r="");for(var a=0,o=("band"===i?["axisBand"]:[]).concat(["x"===n?"axisX":"axisY","axis"+r.substr(0,1).toUpperCase()+r.substr(1),"axis"]);a<o.length;a++){var s=o[a];if(t[s]&&void 0!==t[s][e])return t[s][e]}}});t(ai);ai.getAxisConfig;var oi=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.labels=function(e,t,n,r){var i=e.fieldDef(t)||("x"===t?e.fieldDef("x2"):"y"===t?e.fieldDef("y2"):void 0),a=e.axis(t),o=e.config,s={};if(ve.isTimeFieldDef(i)){var l=e.getScaleComponent(t).get("type")===De.ScaleType.UTC,u=ot.timeFormatExpression("datum.value",i.timeUnit,a.format,o.axis.shortTimeLabels,null,l);u&&(s.text={signal:u})}return s=ae.__assign({},s,n),0===ue.keys(s).length?void 0:s}});t(oi);oi.labels;var si=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=ae.__importStar(de);function a(e){switch(e){case _e.X:return"bottom";case _e.Y:return"left"}throw new Error(n.message.INVALID_CHANNEL_FOR_AXIS)}t.grid=function(e,t){return!De.hasDiscreteDomain(e)&&!Se.isBinning(t.bin)},t.gridScale=function(e,t){var n="x"===t?"y":"x";if(e.getScaleComponent(n))return e.scaleName(n)},t.labelAngle=function(e,t,n,r){if(void 0!==t.labelAngle)return(t.labelAngle%360+360)%360;var i=ai.getAxisConfig("labelAngle",e.config,n,a(n),e.getScaleComponent(n).get("type"));return void 0!==i?(i%360+360)%360:n===_e.X&&ue.contains([he.NOMINAL,he.ORDINAL],r.type)?270:void 0},t.labelBaseline=function(e,t){if(void 0!==e)return"top"===t||"bottom"===t?e<=45||315<=e?"top"===t?"bottom":"top":135<=e&&e<=225?"top"===t?"top":"bottom":"middle":e<=45||315<=e||135<=e&&e<=225?"middle":45<=e&&e<=135?"left"===t?"top":"bottom":"left"===t?"bottom":"top"},t.labelAlign=function(e,t){if(void 0!==e)return e=(e%360+360)%360,"top"===t||"bottom"===t?e%180==0?"center":0<e&&e<180?"top"===t?"right":"left":"top"===t?"left":"right":(e+90)%180==0?"center":90<=e&&e<270?"left"===t?"left":"right":"left"===t?"right":"left"},t.labelFlush=function(e,t,n){return void 0!==n.labelFlush?n.labelFlush:!("x"!==t||!ue.contains(["quantitative","temporal"],e.type))||void 0},t.labelOverlap=function(e,t,n,r){return void 0!==t.labelOverlap?t.labelOverlap:"nominal"!==e.type?"log"!==r||"greedy":void 0},t.orient=a,t.tickCount=function(e,t,n,r,i,a){if(!De.hasDiscreteDomain(n)&&"log"!==n&&!ue.contains(["month","hours","day","quarter"],t.timeUnit))return a.tickStep?{signal:"(domain('"+i+"')[1] - domain('"+i+"')[0]) / "+a.tickStep+" + 1"}:Se.isBinning(t.bin)?{signal:"ceil("+r.signal+"/20)"}:{signal:"ceil("+r.signal+"/40)"}},t.values=function(e,t,n,r){var i=e.values;if(i)return ve.valueArray(n,i);if(n.type===he.QUANTITATIVE){if(Se.isBinning(n.bin)){var a=t.scaleDomain(r);if(a&&"unaggregated"!==a&&!De.isSelectionDomain(a))return i;var o=t.getName(Se.binToString(n.bin)+"_"+n.field+"_bins");return{signal:"sequence("+o+".start, "+o+".stop + "+o+".step, "+o+".step)"}}if(e.tickStep){var s=t.scaleName(r),l=e.tickStep;return{signal:"sequence(domain('"+s+"')[0], domain('"+s+"')[1] + "+l+", "+l+")"}}}}});t(si);si.grid,si.gridScale,si.labelAngle,si.labelBaseline,si.labelAlign,si.labelFlush,si.labelOverlap,si.orient,si.tickCount,si.values;var li=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var u=ae.__importStar(oi),d=ae.__importStar(si);t.parseUnitAxis=function(n){return _e.POSITION_SCALE_CHANNELS.reduce(function(e,t){return n.component.scales[t]&&n.axis(t)&&(e[t]=[function(i,a){var o=a.axis(i),s=new ii.AxisComponent;fe.VG_AXIS_PROPERTIES.forEach(function(e){var t=function(e,t,n,r){var i=r.fieldDef(n),a=d.labelAngle(r,t,n,i);switch(e){case"scale":return r.scaleName(n);case"gridScale":return d.gridScale(r,n);case"format":return ot.numberFormat(i,t.format,r.config);case"grid":if(Se.isBinned(r.fieldDef(n).bin))return!1;var o=r.getScaleComponent(n).get("type");return ue.getFirstDefined(t.grid,d.grid(o,i));case"labelAlign":return ue.getFirstDefined(t.labelAlign,d.labelAlign(a,d.orient(n)));case"labelAngle":return a;case"labelBaseline":return ue.getFirstDefined(t.labelBaseline,d.labelBaseline(a,d.orient(n)));case"labelFlush":return d.labelFlush(i,n,t);case"labelOverlap":var o=r.getScaleComponent(n).get("type");return d.labelOverlap(i,t,n,o);case"orient":return ue.getFirstDefined(t.orient,d.orient(n));case"tickCount":var o=r.getScaleComponent(n).get("type"),s=r.scaleName(n),l="x"===n?"width":"y"===n?"height":void 0,u=l?r.getSizeSignalRef(l):void 0;return ue.getFirstDefined(t.tickCount,d.tickCount(n,i,o,u,s,t));case"title":var c="x"===n?"x2":"y2",f=r.fieldDef(c);return ue.getFirstDefined(t.title,p(r,n),ot.mergeTitleFieldDefs([ve.toFieldDefBase(i)],f?[ve.toFieldDefBase(f)]:[]));case"values":return d.values(t,r,i,n)}return fe.isAxisProperty(e)?t[e]:void 0}(e,o,i,a);if(void 0!==t){var n=function(e,t,n,r,i){switch(t){case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(e===p(r,i))return!0}return e===n[t]}(t,e,o,a,i),r=ai.getAxisConfig(e,a.config,i,s.get("orient"),a.getScaleComponent(i).get("type"));n||void 0===r?s.set(e,t,n):"grid"===e&&r&&s.set(e,r,!1)}});var l=o.encoding||{},e=fe.AXIS_PARTS.reduce(function(e,t){if(!s.hasAxisPart(t))return e;var n=ot.guideEncodeEntry(l[t]||{},a),r="labels"===t?u.labels(a,i,n,s.get("orient")):n;return void 0!==r&&0<ue.keys(r).length&&(e[t]={update:r}),e},{});return 0<ue.keys(e).length&&s.set("encode",e,!!o.encoding||void 0!==o.labelAngle),s}(t,n)]),e},{})};var E={bottom:"top",top:"bottom",left:"right",right:"left"};function N(e,t){if(!e)return t.map(function(e){return e.clone()});if(e.length===t.length){for(var n=e.length,r=0;r<n;r++){var i=e[r],a=t[r];if(!!i!=!!a)return;if(i&&a){var o=i.getWithExplicit("orient"),s=a.getWithExplicit("orient");if(o.explicit&&s.explicit&&o.value!==s.value)return;e[r]=l(i,a)}}return e}}function l(t,r){for(var e=function(n){var e=Gn.mergeValuesWithExplicit(t.getWithExplicit(n),r.getWithExplicit(n),n,"axis",function(e,t){switch(n){case"title":return ot.mergeTitleComponent(e,t);case"gridScale":return{explicit:e.explicit,value:ue.getFirstDefined(e.value,t.value)}}return Gn.defaultTieBreaker(e,t,n,"axis")});t.setWithExplicit(n,e)},n=0,i=fe.VG_AXIS_PROPERTIES;n<i.length;n++){e(i[n])}return t}function p(e,t){var n="x"===t?"x2":"y2",r=e.fieldDef(t),i=e.fieldDef(n),a=r?r.title:void 0,o=i?i.title:void 0;return a&&o?ot.mergeTitle(a,o):a||(o||(void 0!==a?a:void 0!==o?o:void 0))}t.parseLayerAxis=function(e){for(var t=e.component,n=t.axes,r=t.resolve,i={top:0,bottom:0,right:0,left:0},a=0,o=e.children;a<o.length;a++){(g=o[a]).parseAxisAndHeader();for(var s=0,l=ue.keys(g.component.axes);s<l.length;s++){var u=l[s];r.axis[u]=Hn.parseGuideResolve(e.component.resolve,u),"shared"===r.axis[u]&&(n[u]=N(n[u],g.component.axes[u]),n[u]||(r.axis[u]="independent",delete n[u]))}}for(var c=0,f=[_e.X,_e.Y];c<f.length;c++){u=f[c];for(var d=0,p=e.children;d<p.length;d++){var g;if((g=p[d]).component.axes[u]){if("independent"===r.axis[u]){n[u]=(n[u]||[]).concat(g.component.axes[u]);for(var m=0,h=g.component.axes[u];m<h.length;m++){var v=h[m],y=v.getWithExplicit("orient"),_=y.value,S=y.explicit;if(0<i[_]&&!S){var b=E[_];i[_]>i[b]&&v.set("orient",b,!1)}i[_]++}}delete g.component.axes[u]}}}}});t(li);li.parseUnitAxis,li.parseLayerAxis;var ui=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var d=ae.__importStar(de);t.normalizeMarkDef=function(e,t,n){var r,i,a,o,s=ye.isMarkDef(e)?ae.__assign({},e):{type:e},l=s.orient||ot.getMarkConfig("orient",s,n);return s.orient=function(e,t,n){switch(e){case ye.POINT:case ye.CIRCLE:case ye.SQUARE:case ye.TEXT:case ye.RECT:return}var r=t.x,i=t.y,a=t.x2,o=t.y2;switch(e){case ye.BAR:if(ve.isFieldDef(r)&&Se.isBinned(r.bin))return"vertical";if(ve.isFieldDef(i)&&Se.isBinned(i.bin))return"horizontal";if(o||a){if(n)return n;if(!a&&ve.isFieldDef(r)&&r.type===he.QUANTITATIVE&&!Se.isBinning(r.bin))return"horizontal";if(!o&&ve.isFieldDef(i)&&i.type===he.QUANTITATIVE&&!Se.isBinning(i.bin))return"vertical"}case ye.RULE:if(a&&o)return;case ye.AREA:if(o)return ve.isFieldDef(i)&&Se.isBinned(i.bin)?"horizontal":"vertical";if(a)return ve.isFieldDef(r)&&Se.isBinned(r.bin)?"vertical":"horizontal";if(e===ye.RULE){if(t.x&&!t.y)return"vertical";if(t.y&&!t.x)return"horizontal"}case ye.LINE:case ye.TICK:var s=ve.isFieldDef(t.x)&&ve.isContinuous(t.x),l=ve.isFieldDef(t.y)&&ve.isContinuous(t.y);if(s&&!l)return"tick"!==e?"horizontal":"vertical";if(!s&&l)return"tick"!==e?"vertical":"horizontal";if(s&&l){var u=t.x,c=t.y,f=u.type===he.TEMPORAL,d=c.type===he.TEMPORAL;return f&&!d?"tick"!==e?"vertical":"horizontal":!f&&d?"tick"!==e?"horizontal":"vertical":!u.aggregate&&c.aggregate?"tick"!==e?"vertical":"horizontal":u.aggregate&&!c.aggregate?"tick"!==e?"horizontal":"vertical":n||"vertical"}return n||void 0}return"vertical"}(s.type,t,l),void 0!==l&&l!==s.orient&&d.warn(d.message.orientOverridden(s.orient,l)),void 0===ue.getFirstDefined(s.opacity,ot.getMarkConfig("opacity",s,n))&&(s.opacity=function(e,t){if(ue.contains([ye.POINT,ye.TICK,ye.CIRCLE,ye.SQUARE],e)&&!be.isAggregate(t))return.7}(s.type,t)),void 0===s.filled&&(s.filled=(r=s,i=n,a=ot.getMarkConfig("filled",r,i),o=r.type,ue.getFirstDefined(a,o!==ye.POINT&&o!==ye.LINE&&o!==ye.RULE))),void 0===(s.cursor||ot.getMarkConfig("cursor",s,n))&&(s.cursor=(u=s,c=t,f=n,c.href||u.href||ot.getMarkConfig("href",u,f)?"pointer":u.cursor)),s;var u,c,f}});t(ui);ui.normalizeMarkDef;var ci=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=ae.__importStar(be),f=be,r=function(c){function e(e,t,n,r,i,a,o){void 0===r&&(r={});var s=c.call(this,e,t,n,a,i,void 0)||this;s.fit=o,s.type="unit",s.specifiedScales={},s.specifiedAxes={},s.specifiedLegends={},s.specifiedProjection={},s.selection={},s.children=[],s.initSize(ae.__assign({},r,e.width?{width:e.width}:{},e.height?{height:e.height}:{}));var l=ye.isMarkDef(e.mark)?e.mark.type:e.mark,u=s.encoding=f.normalizeEncoding(Zr.replaceRepeaterInEncoding(e.encoding||{},i),l);return s.markDef=ui.normalizeMarkDef(e.mark,u,a),s.stack=Fe.stack(l,u,s.config.stack),s.specifiedScales=s.initScales(l,u),s.specifiedAxes=s.initAxes(u),s.specifiedLegends=s.initLegend(u),s.specifiedProjection=e.projection,s.selection=e.selection,s}return ae.__extends(e,c),Object.defineProperty(e.prototype,"hasProjection",{get:function(){var t=this.encoding,e=this.mark===ye.GEOSHAPE,n=t&&_e.GEOPOSITION_CHANNELS.some(function(e){return ve.isFieldDef(t[e])});return e||n},enumerable:!0,configurable:!0}),e.prototype.scaleDomain=function(e){var t=this.specifiedScales[e];return t?t.domain:void 0},e.prototype.axis=function(e){return this.specifiedAxes[e]},e.prototype.legend=function(e){return this.specifiedLegends[e]},e.prototype.initScales=function(e,a){return _e.SCALE_CHANNELS.reduce(function(e,t){var n,r,i=a[t];return ve.isFieldDef(i)?r=(n=i).scale:ve.hasConditionalFieldDef(i)?(n=i.condition,r=i.condition.scale):"x"===t?n=ve.getFieldDef(a.x2):"y"===t&&(n=ve.getFieldDef(a.y2)),n&&(e[t]=r||{}),e},{})},e.prototype.initAxes=function(i){return[_e.X,_e.Y].reduce(function(e,t){var n=i[t];if(ve.isFieldDef(n)||t===_e.X&&ve.isFieldDef(i.x2)||t===_e.Y&&ve.isFieldDef(i.y2)){var r=ve.isFieldDef(n)?n.axis:null;null!==r&&!1!==r&&(e[t]=ae.__assign({},r))}return e},{})},e.prototype.initLegend=function(i){return _e.NONPOSITION_SCALE_CHANNELS.reduce(function(e,t){var n=i[t];if(n){var r=ve.isFieldDef(n)?n.legend:ve.hasConditionalFieldDef(n)?n.condition.legend:null;null!==r&&!1!==r&&(e[t]=ae.__assign({},r))}return e},{})},e.prototype.parseData=function(){this.component.data=ti.parseData(this)},e.prototype.parseLayoutSize=function(){Jr.parseUnitLayoutSize(this)},e.prototype.parseSelection=function(){this.component.selection=xr.parseUnitSelection(this,this.selection)},e.prototype.parseMarkGroup=function(){this.component.mark=Wr.parseMarkGroup(this)},e.prototype.parseAxisAndHeader=function(){this.component.axes=li.parseUnitAxis(this)},e.prototype.assembleSelectionTopLevelSignals=function(e){return xr.assembleTopLevelSignals(this,e)},e.prototype.assembleSelectionSignals=function(){return xr.assembleUnitSelectionSignals(this,[])},e.prototype.assembleSelectionData=function(e){return xr.assembleUnitSelectionData(this,e)},e.prototype.assembleLayout=function(){return null},e.prototype.assembleLayoutSignals=function(){return Bn.assembleLayoutSignals(this)},e.prototype.assembleMarks=function(){var e=this.component.mark||[];return this.parent&&gr.isLayerModel(this.parent)||(e=xr.assembleUnitSelectionMarks(this,e)),e.map(this.correctDataNames)},e.prototype.assembleLayoutSize=function(){return{width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height")}},e.prototype.getMapping=function(){return this.encoding},e.prototype.toSpec=function(e,t){var n,r=ue.duplicate(this.encoding);return n={mark:this.markDef,encoding:r},e||(n.config=ue.duplicate(this.config)),t||(n.data=ue.duplicate(this.data)),n},Object.defineProperty(e.prototype,"mark",{get:function(){return this.markDef.type},enumerable:!0,configurable:!0}),e.prototype.channelHasField=function(e){return n.channelHasField(this.encoding,e)},e.prototype.fieldDef=function(e){var t=this.encoding[e];return ve.getFieldDef(t)},e}(gr.ModelWithField);t.UnitModel=r});t(ci);ci.UnitModel;var fi=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var f=ae.__importStar(de),n=function(u){function c(e,t,n,r,i,a,o){var s=u.call(this,e,t,n,a,i,e.resolve)||this;s.type="layer";var l=ae.__assign({},r,e.width?{width:e.width}:{},e.height?{height:e.height}:{});return s.initSize(l),s.children=e.layer.map(function(e,t){if(Ie.isLayerSpec(e))return new c(e,s,s.getName("layer_"+t),l,i,a,o);if(Ie.isUnitSpec(e))return new ci.UnitModel(e,s,s.getName("layer_"+t),l,i,a,o);throw new Error(f.message.INVALID_SPEC)}),s}return ae.__extends(c,u),c.prototype.parseData=function(){this.component.data=ti.parseData(this);for(var e=0,t=this.children;e<t.length;e++){t[e].parseData()}},c.prototype.parseLayoutSize=function(){Jr.parseLayerLayoutSize(this)},c.prototype.parseSelection=function(){var n=this;this.component.selection={};for(var e=function(t){t.parseSelection(),ue.keys(t.component.selection).forEach(function(e){n.component.selection[e]=t.component.selection[e]})},t=0,r=this.children;t<r.length;t++){e(r[t])}},c.prototype.parseMarkGroup=function(){for(var e=0,t=this.children;e<t.length;e++){t[e].parseMarkGroup()}},c.prototype.parseAxisAndHeader=function(){li.parseLayerAxis(this)},c.prototype.assembleSelectionTopLevelSignals=function(e){return this.children.reduce(function(e,t){return t.assembleSelectionTopLevelSignals(e)},e)},c.prototype.assembleSelectionSignals=function(){return this.children.reduce(function(e,t){return e.concat(t.assembleSelectionSignals())},[])},c.prototype.assembleLayoutSignals=function(){return this.children.reduce(function(e,t){return e.concat(t.assembleLayoutSignals())},Bn.assembleLayoutSignals(this))},c.prototype.assembleSelectionData=function(e){return this.children.reduce(function(e,t){return t.assembleSelectionData(e)},e)},c.prototype.assembleTitle=function(){var e=u.prototype.assembleTitle.call(this);if(e)return e;for(var t=0,n=this.children;t<n.length;t++){if(e=n[t].assembleTitle())return e}},c.prototype.assembleLayout=function(){return null},c.prototype.assembleMarks=function(){return xr.assembleLayerSelectionMarks(this,ue.flatten(this.children.map(function(e){return e.assembleMarks()})))},c.prototype.assembleLegends=function(){return this.children.reduce(function(e,t){return e.concat(t.assembleLegends())},Xn.assembleLegends(this))},c}(gr.Model);t.LayerModel=n});t(fi);fi.LayerModel;var di=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var s=ae.__importStar(de),n=function(o){function e(e,t,n,r,i){var a=o.call(this,e,t,n,i,r,e.resolve)||this;return a.type="repeat",e.resolve&&e.resolve.axis&&("shared"===e.resolve.axis.x||"shared"===e.resolve.axis.y)&&s.warn(s.message.REPEAT_CANNOT_SHARE_AXIS),a.repeat=e.repeat,a.children=a._initChildren(e,a.repeat,r,i),a}return ae.__extends(e,o),e.prototype._initChildren=function(e,t,n,r){for(var i=[],a=t.row||[n?n.row:null],o=t.column||[n?n.column:null],s=0,l=a;s<l.length;s++)for(var u=l[s],c=0,f=o;c<f.length;c++){var d=f[c],p=(u?"_"+u:"")+(d?"_"+d:""),g={row:u,column:d};i.push(pi.buildModel(e.spec,this,this.getName("child"+p),void 0,g,r,!1))}return i},e.prototype.parseLayoutSize=function(){Jr.parseRepeatLayoutSize(this)},e.prototype.assembleDefaultLayout=function(){return{columns:this.repeat&&this.repeat.column?this.repeat.column.length:1,bounds:"full",align:"all"}},e}(ni.BaseConcatModel);t.RepeatModel=n});t(di);di.RepeatModel;var pi=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var s=ae.__importStar(de);t.buildModel=function(e,t,n,r,i,a,o){if(Ie.isFacetSpec(e))return new $r.FacetModel(e,t,n,i,a);if(Ie.isLayerSpec(e))return new fi.LayerModel(e,t,n,r,i,a,o);if(Ie.isUnitSpec(e))return new ci.UnitModel(e,t,n,r,i,a,o);if(Ie.isRepeatSpec(e))return new di.RepeatModel(e,t,n,i,a);if(Ie.isConcatSpec(e))return new ri.ConcatModel(e,t,n,i,a);throw new Error(s.message.INVALID_SPEC)}});t(pi);pi.buildModel;var gi=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var u=ae.__importStar(ve),c=ae.__importStar(de);t.compile=function(e,t){void 0===t&&(t={}),t.logger&&c.set(t.logger),t.fieldTitle&&u.setTitleFormatter(t.fieldTitle);try{var n=we.initConfig(ue.mergeDeep({},t.config,e.config)),r=Ie.normalize(e,n),i=Le.normalizeAutoSize(e.autosize,n.autosize,Ie.isLayerSpec(r)||Ie.isUnitSpec(r)),a=pi.buildModel(r,null,"",void 0,void 0,n,"fit"===i.type);return a.parse(),or.optimizeDataflow(a.component.data),function(e,t){var n=e.config?we.stripAndRedirectConfig(e.config):void 0,r=[].concat(e.assembleSelectionData([]),Qr.assembleRootData(e.component.data,t.datasets||{}));delete t.datasets;var i=e.assembleProjections(),a=e.assembleTitle(),o=e.assembleGroupStyle(),s=e.assembleLayoutSignals();return s=s.filter(function(e){return"width"!==e.name&&"height"!==e.name||void 0===e.value||(t[e.name]=+e.value,!1)}),{spec:ae.__assign({$schema:"https://vega.github.io/schema/vega/v4.json"},e.description?{description:e.description}:{},t,a?{title:a}:{},o?{style:o}:{},{data:r},0<i.length?{projections:i}:{},e.assembleGroup(s.concat(e.assembleSelectionTopLevelSignals([]))),n?{config:n}:{})}}(a,(o=e,s=n,l=i,ae.__assign({autosize:1===ue.keys(l).length&&l.type?l.type:l},Le.extractTopLevelProperties(s),Le.extractTopLevelProperties(o))))}finally{t.logger&&c.reset(),t.fieldTitle&&u.resetTitleFormatter()}var o,s,l}});t(gi);gi.compile;var mi=n(function(e,u){Object.defineProperty(u,"__esModule",{value:!0});var c=ye;u.DEFAULT_REQUIRED_CHANNEL_MAP={text:["text"],line:["x","y"],trail:["x","y"],area:["x","y"]},u.DEFAULT_SUPPORTED_CHANNEL_TYPE={bar:oe.toSet(["row","column","x","y","size","color","fill","stroke","detail"]),line:oe.toSet(["row","column","x","y","color","fill","stroke","color","detail"]),trail:oe.toSet(["row","column","x","y","color","fill","stroke","color","detail","size"]),area:oe.toSet(["row","column","x","y","color","fill","stroke","detail"]),tick:oe.toSet(["row","column","x","y","color","fill","stroke","detail"]),circle:oe.toSet(["row","column","x","y","color","fill","stroke","size","detail"]),square:oe.toSet(["row","column","x","y","color","fill","stroke","size","detail"]),point:oe.toSet(["row","column","x","y","color","fill","stroke","size","detail","shape"]),geoshape:oe.toSet(["row","column","color","fill","stroke","detail","shape"]),text:oe.toSet(["row","column","size","color","fill","stroke","text"])},u.getEncodingMappingError=function(e,t,n){void 0===t&&(t=u.DEFAULT_REQUIRED_CHANNEL_MAP),void 0===n&&(n=u.DEFAULT_SUPPORTED_CHANNEL_TYPE);var r=ye.isMarkDef(e.mark)?e.mark.type:e.mark,i=e.encoding,a=t[r],o=n[r];for(var s in a)if(!(a[s]in i))return'Missing encoding channel "'+a[s]+'" for mark "'+r+'"';for(var l in i)if(!o[l])return'Encoding channel "'+l+'" is not supported by mark type "'+r+'"';return r!==c.BAR||i.x||i.y?null:"Missing both x and y for bar"}});t(mi);mi.DEFAULT_REQUIRED_CHANNEL_MAP,mi.DEFAULT_SUPPORTED_CHANNEL_TYPE,mi.getEncodingMappingError;var hi="vega-lite",vi='Jeffrey Heer, Dominik Moritz, Kanit "Ham" Wongsuphasawat',yi="3.0.0-rc3",_i=["Kanit Wongsuphasawat <kanitw@gmail.com> (http://kanitw.yellowpigz.com)","Dominik Moritz <domoritz@cs.washington.edu> (https://www.domoritz.de)","Jeffrey Heer <jheer@uw.edu> (http://jheer.org)"],Si="https://vega.github.io/vega-lite/",bi="Vega-Lite is a concise high-level language for interactive visualization.",Ei="build/vega-lite.js",Ni="build/vega-lite.min.js",Oi="build/vega-lite.min.js",Ti="build/src/index",xi="build/src/index.d.ts",Ai={vl2png:"./bin/vl2png",vl2svg:"./bin/vl2svg",vl2vg:"./bin/vl2vg"},Ci={test:"test"},Di={prebuild:"mkdir -p build/src",build:"npm run build:only","build:only":"tsc && rollup -c",postbuild:"uglifyjs build/vega-lite.js -cm --source-map content=build/vega-lite.js.map,filename=build/vega-lite.min.js.map -o build/vega-lite.min.js && npm run schema","build:examples":"npm run build:only","postbuild:examples":"npm run data && TZ=America/Los_Angeles scripts/build-examples.sh","build:examples-full":"npm run build:only","postbuild:examples-full":"TZ=America/Los_Angeles scripts/build-examples.sh 1","build:example":"TZ=America/Los_Angeles scripts/build-example.sh","build:toc":"bundle exec jekyll build -q && scripts/generate-toc","build:site":"tsc -p site && webpack --config site/webpack.config.js","build:versions":"scripts/update-version.sh",clean:"rm -rf build && rm -f examples/compiled/*.png && find site/examples ! -name 'index.md' -type f -delete",data:"rsync -r node_modules/vega-datasets/data/* data",deploy:"scripts/deploy.sh","deploy:gh":"scripts/deploy-gh.sh","deploy:schema":"scripts/deploy-schema.sh",preschema:"npm run prebuild",schema:"node --stack-size=1400 ./node_modules/.bin/ts-json-schema-generator --path tsconfig.json --type TopLevelSpec > build/vega-lite-schema.json && npm run renameschema && cp build/vega-lite-schema.json _data/",renameschema:"scripts/rename-schema.sh",presite:"npm run prebuild && npm run data && npm run build:site && npm run build:toc && npm run build:versions && scripts/create-example-pages",site:"bundle exec jekyll serve --incremental",format:"tslint -p . --fix -e 'package.json' && prettier --write '{src,test,test-runtime}/**/*.ts'",lint:"tslint -p . -e 'package.json' && prettier --list-different '{src,test,test-runtime}/**/*.ts'",test:"jest test/ && npm run lint && npm run schema && jest examples/ && npm run test:runtime","test:inspect":"node --inspect-brk ./node_modules/.bin/jest --runInBand test","test:runtime":'TZ=America/Los_Angeles TS_NODE_COMPILER_OPTIONS=\'{"module":"commonjs"}\' wdio wdio.conf.js',"test:runtime:generate":"rm -Rf test-runtime/resources && VL_GENERATE_TESTS=true npm run test:runtime","watch:build":"npm run build:only && concurrently --kill-others -n Typescript,Rollup 'tsc -w' 'rollup -c -w'","watch:site":"concurrently --kill-others -n Typescript,Webpack 'tsc -p site --watch' 'webpack --config site/webpack.config.js --mode development --watch'","watch:test":"jest --watch"},ki={type:"git",url:"https://github.com/vega/vega-lite.git"},Pi="BSD-3-Clause",wi={url:"https://github.com/vega/vega-lite/issues"},Fi={"@babel/core":"^7.0.0-beta.55","@types/chai":"^4.1.4","@types/d3":"^5.0.0","@types/highlight.js":"^9.12.3","@types/jest":"^23.3.1","@types/json-stable-stringify":"^1.0.32","@types/mkdirp":"^0.5.2","@types/node":"^10.5.5","@types/webdriverio":"^4.10.3",ajv:"^6.5.2",chai:"^4.1.2",cheerio:"^1.0.0-rc.2",chromedriver:"^2.41.0",codecov:"^3.0.4",concurrently:"^3.6.1",d3:"^5.5.0","highlight.js":"^9.12.0",jest:"^23.4.2","json-stable-stringify":"^1.0.1",mkdirp:"^0.5.1",prettier:"^1.14.0",rollup:"^0.63.5","rollup-plugin-commonjs":"^9.1.4","rollup-plugin-json":"^3.0.0","rollup-plugin-node-resolve":"^3.3.0","rollup-plugin-sourcemaps":"^0.4.2","source-map-support":"^0.5.6","svg2png-many":"^0.0.7","ts-jest":"^23.1.0","ts-json-schema-generator":"^0.32.0","ts-node":"^7.0.0",tslint:"5.11.0","tslint-config-prettier":"^1.14.0","tslint-eslint-rules":"^5.3.1",typescript:"^3.0.1","uglify-js":"^3.4.6",vega:"^4.2.0","vega-datasets":"^1.19.0","vega-embed":"^3.18.2","vega-tooltip":"^0.12.0","wdio-chromedriver-service":"^0.1.3","wdio-dot-reporter":"0.0.9","wdio-mocha-framework":"^0.5.13","wdio-static-server-service":"^1.0.1",webdriverio:"^4.13.1",webpack:"^4.16.4","webpack-cli":"^3.1.0","yaml-front-matter":"^4.0.0"},Ri={"json-stringify-pretty-compact":"^1.2.0",tslib:"^1.9.3","vega-event-selector":"^2.0.0","vega-typings":"^0.3.38","vega-util":"^1.7.0",yargs:"^12.0.1"},Ii={testURL:"http://localhost/",transform:{"^.+\\.tsx?$":"ts-jest"},testRegex:"(/__tests__/.*|(\\.|/)(test|spec))\\.(jsx?|tsx?)$",moduleFileExtensions:["ts","tsx","js","jsx","json","node"],testPathIgnorePatterns:["node_modules","test-runtime","<rootDir>/build","_site","src"],coverageDirectory:"./coverage/",collectCoverage:!1},Li={name:hi,author:vi,version:yi,collaborators:_i,homepage:Si,description:bi,main:Ei,unpkg:Ni,jsdelivr:Oi,module:Ti,types:xi,bin:Ai,directories:Ci,scripts:Di,repository:ki,license:Pi,bugs:wi,devDependencies:Fi,dependencies:Ri,jest:Ii},Mi=Object.freeze({name:hi,author:vi,version:yi,collaborators:_i,homepage:Si,description:bi,main:Ei,unpkg:Ni,jsdelivr:Oi,module:Ti,types:xi,bin:Ai,directories:Ci,scripts:Di,repository:ki,license:Pi,bugs:wi,devDependencies:Fi,dependencies:Ri,jest:Ii,default:Li}),Ui=Mi&&Li||Mi,ji=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=ae.__importStar(ce);t.aggregate=n;var r=ae.__importStar(fe);t.axis=r;var i=ae.__importStar(Se);t.bin=i;var a=ae.__importStar(_e);t.channel=a;var o=ae.__importStar(xe);t.compositeMark=o,t.compile=gi.compile;var s=ae.__importStar(we);t.config=s;var l=ae.__importStar(Me);t.data=l;var u=ae.__importStar(pe);t.datetime=u;var c=ae.__importStar(be);t.encoding=c;var f=ae.__importStar(ge);t.facet=f;var d=ae.__importStar(ve);t.fieldDef=d;var p=ae.__importStar(nt);t.header=p;var g=ae.__importStar(Ce);t.legend=g;var m=ae.__importStar(ye);t.mark=m;var h=ae.__importStar(De);t.scale=h;var v=ae.__importStar(rt);t.sort=v;var y=ae.__importStar(Ie);t.spec=y;var _=ae.__importStar(Fe);t.stack=_;var S=ae.__importStar(me);t.timeUnit=S;var b=ae.__importStar(Cr);t.transform=b;var E=ae.__importStar(he);t.type=E;var N=ae.__importStar(ue);t.util=N;var O=ae.__importStar(mi);t.validate=O;var T=ae.__importDefault(Ui).default.version;t.version=T}),zi=t(ji),Bi=ji.aggregate,Hi=ji.axis,Gi=ji.bin,qi=ji.channel,Wi=ji.compositeMark,Yi=ji.compile,Vi=ji.config,Xi=ji.data,Ki=ji.datetime,Qi=ji.encoding,Ji=ji.facet,Zi=ji.fieldDef,$i=ji.header,ea=ji.legend,ta=ji.mark,na=ji.scale,ra=ji.sort,ia=ji.spec,aa=ji.stack,oa=ji.timeUnit,sa=ji.transform,la=ji.type,ua=ji.util,ca=ji.validate,fa=ji.version;e.default=zi,e.aggregate=Bi,e.axis=Hi,e.bin=Gi,e.channel=qi,e.compositeMark=Wi,e.compile=Yi,e.config=Vi,e.data=Xi,e.datetime=Ki,e.encoding=Qi,e.facet=Ji,e.fieldDef=Zi,e.header=$i,e.legend=ea,e.mark=ta,e.scale=na,e.sort=ra,e.spec=ia,e.stack=aa,e.timeUnit=oa,e.transform=sa,e.type=la,e.util=ua,e.validate=ca,e.version=fa,Object.defineProperty(e,"__esModule",{value:!0})});