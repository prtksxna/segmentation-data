{"version":3,"file":"geoshape.js","sourceRoot":"","sources":["../../../../src/compile/mark/geoshape.ts"],"names":[],"mappings":";;;AACA,uDAAmC;AAEnC,2CAAmD;AACnD,mCAAmC;AAItB,QAAA,QAAQ,GAAiB;IACpC,MAAM,EAAE,OAAO;IACf,WAAW,EAAE,UAAC,KAAgB;QAC5B,4BACK,MAAM,CAAC,eAAe,CAAC,KAAK,EAAE,EAAC,IAAI,EAAE,QAAQ,EAAE,MAAM,EAAE,QAAQ,EAAC,CAAC,EACpE;IACJ,CAAC;IACD,qBAAqB,EAAE,UAAC,KAAgB;QAC/B,IAAA,yBAAQ,CAAU;QACzB,IAAM,QAAQ,GAAG,QAAQ,CAAC,KAAK,CAAC;QAEhC,IAAM,SAAS,sBACb,IAAI,EAAE,UAAU,EAChB,UAAU,EAAE,KAAK,CAAC,cAAc,EAAE,IAE/B,CAAC,QAAQ,IAAI,qBAAU,CAAC,QAAQ,CAAC,IAAI,QAAQ,CAAC,IAAI,KAAK,cAAO;YAC/D,CAAC,CAAC,EAAC,KAAK,EAAE,kBAAO,CAAC,QAAQ,EAAE,EAAC,IAAI,EAAE,OAAO,EAAC,CAAC,EAAC;YAC7C,CAAC,CAAC,EAAE,CAAC,CACR,CAAC;QACF,OAAO,CAAC,SAAS,CAAC,CAAC;IACrB,CAAC;CACF,CAAC","sourcesContent":["import {UnitModel} from '../unit';\nimport * as mixins from './mixins';\n\nimport {isFieldDef, vgField} from '../../fielddef';\nimport {GEOJSON} from '../../type';\nimport {VgGeoShapeTransform, VgPostEncodingTransform} from '../../vega.schema';\nimport {MarkCompiler} from './base';\n\nexport const geoshape: MarkCompiler = {\n  vgMark: 'shape',\n  encodeEntry: (model: UnitModel) => {\n    return {\n      ...mixins.baseEncodeEntry(model, {size: 'ignore', orient: 'ignore'})\n    };\n  },\n  postEncodingTransform: (model: UnitModel): VgPostEncodingTransform[] => {\n    const {encoding} = model;\n    const shapeDef = encoding.shape;\n\n    const transform: VgGeoShapeTransform = {\n      type: 'geoshape',\n      projection: model.projectionName(),\n      // as: 'shape',\n      ...(shapeDef && isFieldDef(shapeDef) && shapeDef.type === GEOJSON\n        ? {field: vgField(shapeDef, {expr: 'datum'})}\n        : {})\n    };\n    return [transform];\n  }\n};\n"]}